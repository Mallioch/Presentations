window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.Gimme=function(){var n=function(){function n(n){Array.prototype.push.apply(this,n)}function t(i,r){if(i&&i instanceof n)return i;var u=!i&&[]||(r||typeof i=="string")&&t.query(i,r)||i instanceof Array&&i||[i];return new n(u)}function i(n,t){var i;for(i in t)t.hasOwnProperty(i)&&(n.prototype[i]=t[i])}return i(n,{length:Array.prototype.length,entities:function(){return Array.prototype.slice.apply(this)},sort:function(n){return Array.prototype.sort.call(this,n),this},reverse:function(){return Array.prototype.reverse.call(this),this},push:function(){return Array.prototype.push.apply(this,arguments),this},pop:function(){var t=Array.prototype.pop.call(this);return new n([t])},shift:function(){var t=Array.prototype.shift.call(this);return new n([t])},unshift:function(){return Array.prototype.unshift.apply(this,arguments),this},slice:function(){return new n(Array.prototype.slice.apply(this,arguments))},splice:function(){return new n(Array.prototype.splice.apply(this,arguments))},concat:function(t){return new n(Array.prototype.concat.apply(this.entities(),t.entities&&t.entities()||arguments))}}),t.Helper={get_guid:function(){var n=0;return function(t){if(!t)return"";if(t===window)return"win";if(t===document)return"doc";if(t.uniqueID)return t.uniqueID;var i="__$gimme$_guid__";return typeof t[i]=="undefined"&&(t[i]=i+n++),t[i]}}()},t.Browser=function(){var n=navigator.userAgent.toLowerCase(),t=typeof ActiveXObject!="undefined"||typeof MSPointerEvent!="undefined"||n.indexOf("trident")!==-1;return{is_ie:t,is_opera:typeof window.opera!="undefined",is_khtml:n.indexOf("khtml")!==-1,is_gecko:n.indexOf("khtml")===-1&&!t&&n.indexOf("gecko")!==-1,is_in_quirks_mode:document.compatMode==="BackCompat"}}(),t.undefined={}._$gimme$_undefined,t.ext=n.prototype,t}();return n.ext.select=function(t){return n(t,this[0])},typeof g=="undefined"&&(window.g=n),n.Internals=new function(){function n(n){return function(t,i,r){this[n](t,i,r)}}return{addEventListener:n("addEventListener"),removeEventListener:n("removeEventListener"),attachEvent:n("attachEvent"),detachEvent:n("detachEvent"),parseJSON:function(n){return JSON.parse(n)}}},n.query=function(){return function(){function b(n,t,i){return r[t](n,i)}function k(n,t){var r=[],u=t.length,i;do i=h(n,t[--u]||t),i&&r.push(i);while(u);return r}function h(n,t){if(n===document||!t)return t;for(var i=t;(i=i.parentNode)&&i!==n;);return i===n&&t||null}function d(n,t){var i=n.document||document;return h(n,i.getElementById(t))}function c(n,t){var i,f,r,e;if(t=t||document,n.id)return a([d(t,n.id)],n);if(delete n.id,i=t.getElementsByTagName(n.tag||"*"),(!n.classes||n.classes.length<1)&&(!n.attributes||n.attributes.length<1)&&(!n.pseudos||n.pseudos.length<1))return l(i);for(f=[],e=i.length,r=0;r<e;r++)u(n,i[r])&&f.push(i[r]);return f}function u(n,t){if(!t)return!1;for(var u=n.propNames,f=u.length,i=0;i<f;i++)if(!r[u[i]](t,n[u[i]]))return!1;return!0}function l(n){for(var i=[],r=n.length,t=0;t<r;t++)i[t]=n[t];return i}function a(n,t){for(var r=[],f=n.length,i=0;i<f;i++)n[i]&&n[i].nodeType===1&&u(t,n[i])&&r.push(n[i]);return r}function y(n,t){return v(n,t)!==-1}function p(n){var r;t.inc();for(var u=t.name,f=[],e=n.length,i=0;i<e;i++)r=n[i],r[u]!==t.t&&(r[u]=t.t,f.push(r));return f}function e(n){this.name=n,this.f=0,this.t=1,this.inc=function(){this.f=(this.t+=2)-1}}function g(n){this.parse=function(t){var u,i,f,o=n.preprocessInput,r,e;for(t=o&&o(t)||t,n.reset(),r=0,e=t.length;r<e;){if(u=t.charAt(r),i=i||n[u]||n["default"],i){if(f=i(t.substring(r,e)),!f)throw'No valid match found for "'+i.name+'" rule';r+=f}else throw'No suitable rule found to handle character "'+u+'"';i=null}return n.finish()}}function w(t,i){var w=i,r,u,h,o,a,y,v;if(i=i||document,n.inc(),typeof t!="string")return k(i||document,t);u=[];try{u=l(i.querySelectorAll(t))}catch(d){for(h=s.parse(t),a=h.length,o=0;o<a;o++){var f=h[o],p=f.length,e=p%2-1;for(r=e===0?c(f[e],i):[i||document];f[++e];)y=f[e++],v=f[e],v.root=i,r=b(r,y,v);u=a>1?u.concat(r):r}}return u}var t,i,n,r,o,s,v=function(){function n(n,t){return n.indexOf(t)}function t(n,t){for(var r=n.length,i=0;i<r;i++)if(n[i]===t)return i;return-1}return typeof Array.prototype.indexOf!="undefined"?n:t}(),f=function(){function n(n,t){return n.getAttribute(t)}function t(n,t){switch(t.toLowerCase()){case"class":return n.className||null;case"id":return n.id||null;case"href":case"src":if(typeof n.getAttribute!="undefined")return n.getAttribute(t,2)}return n.attributes&&n.attributes[t]&&n.attributes[t].nodeValue||n.getAttribute(t)}return function(){var i=document.createElement("div"),r;return i.innerHTML='<a href="#test">test<\/a>',r=i.firstChild,r.getAttribute("href")==="#test"?n:t}()}();return t=new e("__$gimme$_unique__"),i=new e("__$gimme$_genSib__"),n=new e("__$gimme$_nth__"),r={id:function(n,t){return n.id===t},tag:function(n,t){return n.tagName===t||t==="*"},classes:function(n,t){var i=n.className,u,r;if(typeof i!="string"&&(i=f(n,"class")),!i)return!1;for(u=" "+i+" ",r=t.length;r--;)if(u.indexOf(" "+t[r]+" ")===-1)return!1;return!0},attributes:function(){var n={},t={parse:function(t){var i=t.match(/^\[([\w-_]+)?(\=|\^=|\$=|\*=|\|=|~=|!=)?(.*)\]$/);return n[t]={name:i&&i[1],delim:i&&i[2],val:i&&i[3].replace(/^['"]|["']$/g,"")}},"=":function(n,t){return n===t},"^=":function(n,t){return n.indexOf(t)===0},"$=":function(n,t){var i=n.lastIndexOf(t);return i!==-1&&i+t.length===n.length},"*=":function(n,t){return n.indexOf(t)!==-1},"|=":function(n,t){return n===t||n.indexOf(t+"-")===0},"~=":function(n,t){return n===t||y(n.split(" "),t)},"!=":function(n,t){return n!==t},unknown:function(){return!1}};return function(i,r){for(var e=r.length,u,o;e--;){if(u=n[r[e]]||t.parse(r[e]),o=f(i,u.name),!o)return!1;if(u.delim&&!t[u.delim||"unknown"](o,u.val))return!1}return!0}}(),pseudos:function(){function r(n){var t=n+"Sibling";return function(n){for(var i=n[t];i&&i.nodeType!==1;)i=i[t];return!i}}var i={},t={parse:function(n){var t=n.match(/([\w-_]+)\b(\((((-?\d*)n)?([+-]?\d+)?|.*)\))?/),r={name:t&&t[1],param:{wholeValue:t&&t[3],a:t&&t[5]||0,b:t&&t[6]||0}};return r.param.wholeValue==="even"?(r.param.a=2,r.param.b=0):r.param.wholeValue==="odd"&&(r.param.a=2,r.param.b=1),i[n]=r},"first-child":r("previous"),"last-child":r("next"),"only-child":function(n){return t["first-child"](n)&&t["last-child"](n)},"nth-child":function(t,i){var h=n.t*1e4,u=n.name,r=t.parentNode,e=0,f;if(r){if(r[u+":parent"]!==n.t){r[u+":parent"]=n.t;for(var e=0,o=r.children||r.childNodes,s=-1,c=o.length;++s<c;)o[s].nodeType===1&&(e++,o[s][u]=h+e)}return f=t[u]-h-i.param.b,!i.param.a&&i.param.b?f===0:i.param.a*f>=0&&f%(i.param.a||1)==0}return!1},contains:function(n,t){return(n.textContent||n.innerText||n.innerHTML).indexOf(t.param.wholeValue)!==-1},not:function(){return!1}};return function(n,r){for(var u=r.length,f;u--;)if(f=i[r[u]]||t.parse(r[u]),!t[f.name](n,f))return!1;return!0}}()," ":function(n,t){for(var r=[],f=n.length,u,i=0;i<f;i++)if(u=c(t,n[i]),r=r.concat(u),t.id&&u.length===1)break;return p(r)},">":function(n,t){for(var r=[],u=n.length,i=0;i<u;i++)r=r.concat(a(n[i].childNodes,t));return r},"+":function(n,t){for(var f=[],o=n.length,e,i,r=0;r<o;r++){for(e=n[r],i=e.nextSibling;i&&i.nodeType!==1;)i=i.nextSibling;u(t,i)&&f.push(i)}return f},"~":function(n,t){var s,r;i.inc();for(var e=i.name,o=[],h=n.length,f=0;f<h;f++)for(s=n[f],r=s.nextSibling;r&&r[e]!==i.t;)r.nodeType===1&&(r[e]=i.t,u(t,r)&&o.push(r)),r=r.nextSibling;return o}},o=new function(){function i(){this.propNames=[]}var r,t,n;return i.prototype.propNames=[],i.prototype.storePropertyValue=function(n,t){this[n]=t,this.propNames[n]||(this.propNames.push(n),this.propNames[n]=!0)},i.prototype.storeArrayValue=function(n,t){this[n]||(this[n]=[]),this[n].push(t),this.propNames[n]||(this.propNames.push(n),this.propNames[n]=!0)},{preprocessInput:function(n){return n.replace(/\s*([ >+~,])\s*/g,"$1")},reset:function(){r=[],t=[],n=new i},finish:function(){return n&&n.propNames.length>0&&t.push(n),t.length>0&&r.push(t),r},"default":function(t){var r=t.match(/(\w+|\*)/),i;return r?(i=r[0].toUpperCase(),n.storePropertyValue("tag",i),i.length):null},"#":function(t){var i=t.match(/#([_\-\w]+)/),r;return i?(r=i[1],n.storePropertyValue("id",r),i[0].length):null},".":function(t){var i=t.match(/\.([_\-\w\d]+)/),r;if(i)return r=i[1],n.storeArrayValue("classes",r),i[0].length},"[":function(t){var r=t.match(/(\[.*"\]|.*?\])/),i;return r?(i=r[0],n.storeArrayValue("attributes",i),i.length):null},":":function(t){var r=t.match(/:[\w-_]+\b(\(.*\))?/),i;return r?(i=r[0],n.storeArrayValue("pseudos",i),i.length):null}," ":function(){return t.push(n," "),n=new i,1},">":function(){return n.propNames.length>0&&t.push(n),t.push(">"),n=new i,1},"~":function(){return t.push(n,"~"),n=new i,1},"+":function(){return t.push(n,"+"),n=new i,1},",":function(){return t.push(n),r.push(t),t=[],n=new i,1}}},s=new g(o),w.Internal={unique:p,index_of:v,contains:y,has_class:r.classes,get_attr:f},w}()}(),n.Helper.index_of=n.query.Internal.index_of,n.Helper.contains=n.query.Internal.contains,n.Helper.unique=n.query.Internal.unique,n.Helper.has_class=n.query.Internal.has_class,n.Helper.get_attr=n.query.Internal.get_attr,n.Effects={Animation:function(n){function s(n){for(var h=e(n),r=t.length,o,s;r--;){s={};for(o in u)s[o]=i[o][r]+u[o][r]*h;f(t[r],s,n)}}var t=n.elements||[],o=n.duration||1,i=n.from||{},r=n.to||{},u={},f,e;(function(){var f,n,s,e={},o={},h={};for(n in i)for(e[n]=[],o[n]=[],h[n]=[],f=t.length;f--;)s=t[f],e[n][f]=typeof i[n]=="function"?i[n](s,n):i[n],o[n][f]=typeof r[n]=="function"?r[n](s,n):r[n],h[n][f]=o[n][f]-e[n][f];i=e,r=o,u=h})(),f=n.animate,e=n.easing||function(n){return n},this.startTime=n.startTime||0,this.duration=o,this.add_element=function(n){t.push(n)},this.remove_element=function(n){for(var i=t.length;i--;)if(t[i]===n){t.splice(i,1);break}},this.tick=s},Storyboard:function(n){function u(){f||(f=!0,e=(new Date).getTime(),h=setInterval(rt,1))}function v(){t=0,i=1,u()}function y(){s(),l&&l(t)}function s(){clearInterval(h),f=!1}function p(){u()}function w(){i=1,u()}function b(){i=-1,u()}function k(){i*=-1,u()}function d(n){t=n,a()}function g(){return f}function nt(){return i}function tt(){return r}function it(){return o}function rt(){var n=(new Date).getTime();t+=(n-e)/o*i,e=n,t=t<0?0:t>1?1:t,a(),(i===-1&&t===0||i===1&&t===1)&&(s(),c&&c(t))}function a(){for(var u=r.length,n;u--;)n=(o*t-r[u].startTime)/r[u].duration,n=i===-1&&n<0?0:i===1&&n>1?1:n,n>=0&&n<=1&&r[u].tick(n)}var h,e,t=0,i=1,f=!1,r=n.animations,o=n.duration||0,c=n.completed,l=n.aborted;this.begin=v,this.abort=y,this.pause=s,this.resume=p,this.forward=w,this.backward=b,this.reverse=k,this.seek=d,this.is_running=g,this.get_direction=nt,this.get_animations=tt,this.get_duration=it},Easing:{Back:new function(){function n(n,t,i,r){return t=.5,i=0,r=.5,Math.pow(1-n,i)*r*Math.sin(2*Math.PI*n*t)*-1+n}function t(){}function i(){}this.ease_in=n,this.ease_out=t,this.ease_in_out=i},Bounce:new function(){function t(n,t,i){return t=t||1.5,i=i||4,Math.abs(Math.pow(n,t)*Math.cos(Math.PI*n*i))}function i(t,i,r){return 1-n.Effects.Easing.Bounce.ease_in(1-t,i,r)}function r(t,i,r){var u=0,f=n.Effects.Easing.Bounce.ease_in;return t>.5&&(f=n.Effects.Easing.Bounce.ease_out,t-=.5,u=1/2),f(t,i,r)-u}this.ease_in=t,this.ease_out=i,this.ease_in_out=r},Elastic:new function(){function n(){}function t(n,t,i){return t=t||3.5,i=i||5,1-Math.pow(1-n,t)*Math.cos(2*Math.PI*n*i)}function i(){}this.ease_in=n,this.ease_out=t,this.ease_in_out=i},Exponential:new function(){function n(n,t){return Math.pow(n,t)}function t(n,t){return Math.pow(n,1/t)}function i(i,r){return i<=.5?n(i*2,r)*.5:t((i-.5)*2,r)*.5+.5}this.ease_in=n,this.ease_out=t,this.ease_in_out=i}},Enums:{Directions:{vertically:1,horizontally:2,both:3},Speeds:{quickly:500,slowly:1e3}},RunningAnimations:function(){var t={};return{add:function(n,i){t[n]=i},remove:function(n){delete t[n]},get:function(i){return t[i]||new n.Effects.Storyboard({animations:[]})},contains:function(n){return!!t[n]}}}()},n.Effects.Storyboard.create=function(t,i,r,u,f,e,o,s){f=Math.floor(f)||n.Effects.Enums.Speeds[f]||n.Effects.Enums.Speeds.quickly;var h=new n.Effects.Storyboard({duration:f,completed:function(){o&&o.call(this),n.Effects.RunningAnimations.remove(e),h=null},aborted:function(){n.Effects.RunningAnimations.remove(e),h=null},animations:[new n.Effects.Animation({from:i,to:r,duration:f,animate:u,easing:s,elements:t})]});return e&&n.Effects.RunningAnimations.add(e,h),h},function(){var t=0,i={};n.Effects.Animation.requestAnimationFrame=function(){function u(n,t){return function(){i[t]&&n((new Date).getTime()),delete i[t]}}function e(n,f){var e=i[++t]=u(n,t);return r(e,f),t}function o(r){var e=i[++t]=u(r,t);return n.setTimeout(e,f),t}var f=16,n=window,r=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame;return r?e:o}(),n.Effects.Animation.cancelAnimationFrame=function(n){delete i[n]}}(),n.Ajax=new function(){function i(n,i){t(n,i,!0)}function r(n,i){t(n,i,!1)}function u(){if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){throw new Error("Error invoking XMLHTTP");}else throw new Error("XMLHttp is not supported");}function t(t,i,r){var f=u();f.onreadystatechange=function(){if(f.readyState===4){var t=f.responseText;r&&t&&(t=n.Internals.parseJSON(t)),i.call(f,t,f.status),f=null,i=null}},f.open("GET",t,!0),f.send("")}this.request_json=i,this.request_ahah=r},n.Screen=new function(){function t(){return typeof window.innerWidth!="undefined"?{width:window.innerWidth,height:window.innerHeight}:typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0?{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}:{width:document.getElementsByTagName("body")[0].clientWidth,height:document.getElementsByTagName("body")[0].clientHeight}}function i(n){var t,i;return n=n||window.event,t={x:0,y:0},typeof n.pageX!="undefined"?(t.x=n.pageX,t.y=n.pageY):(i=this.get_scroll_pos(),t.x=n.clientX+i.x,t.y=n.clientY+i.y),t}function r(){return n(window).get_scroll_pos()}this.get_viewport_size=t,this.get_mouse_pos=i,this.get_scroll_pos=r},n.Util=new function(){function t(){return n(arguments,!1)}function i(){return n(arguments,!0)}function n(n,t){function u(){i.apply(this,Array.prototype.slice.call(n,2)),t||(i=null)}var i=n[0],r=n[1];return t===!0?window.setInterval(u,r):window.setTimeout(u,r)}this.set_timeout=t,this.set_interval=i},n.Style=new function(){function f(i){var u=i.scrollTop&&i!==document.documentElement&&i!==document.body&&i.tagName!=="TEXTAREA"&&i.tagName!=="INPUT"?-1:0,r={x:i.scrollLeft*u,y:i.scrollTop*u},f;return n.Browser.is_ie&&t(i,"position")==="static"?(f=i.style.position,i.style.position="relative",r.x+=i.offsetLeft,r.y+=i.offsetTop,i.style.position=f):(r.x+=i.offsetLeft,r.y+=i.offsetTop),r}function a(i){var r={x:0,y:0},u;if(i.getBoundingClientRect){var s=i.getBoundingClientRect(),h=o(),c=n(window).get_scroll_pos();r.x=s.left-h.x+c.x,r.y=s.top-h.y+c.y}else while(i!==null)u=f(i),r.x+=u.x,r.y+=u.y,i=i.offsetParent,i&&!e()&&(r.x+=parseFloat(t(i,"borderLeftWidth"))||0,r.y+=parseFloat(t(i,"borderTopWidth"))||0);return r}function e(){var n,t;return typeof arguments.callee.constantValue=="undefined"&&(n=document.createElement("div"),n.style.cssText="position:absolute;visibility:hidden;top:0;left:0;border:1px solid #000;",t=document.createElement("div"),n.appendChild(t),document.body.appendChild(n),arguments.callee.constantValue=t.offsetTop===1,document.body.removeChild(n),n=t=null),arguments.callee.constantValue}function o(){var i,r;if(typeof arguments.callee.constantValue=="undefined"){var t=document.body,u=t.style.position,f=t.style.margin,e=t.style.border;t.style.position="static",t.style.margin="0",t.style.border="1px solid transparent",i=t.getBoundingClientRect(),r=n(window).get_scroll_pos(),arguments.callee.constantValue={x:i.left+r.x,y:i.top+r.y},t.style.position=u,t.style.margin=f,t.style.border=e,document.documentElement.className=document.documentElement.className}return arguments.callee.constantValue}function t(n,t){var r="",u,e,f;return n.currentStyle&&(t==="right"||t==="bottom")?r=i(t,"auto","auto",n)+"px":(u=document.defaultView&&document.defaultView.getComputedStyle&&document.defaultView.getComputedStyle(n,null)||n.currentStyle,u&&(r=u[t]||"",e=r.match(/px$/),e||(f=r.match(/(em|ex|%|in|cm|mm|pt|pc|small|medium|large|thin|thick|auto)$/),f&&(r=i(t,r,f[0],n)+"px")))),r}function i(i,r,u,f){var s,h,a,o,c,v,y,p,l,e,w;if(r){if(u==="px")return parseFloat(r);if(r==="auto")switch(i){case"top":case"left":return 0;case"bottom":case"right":if(s={bottom:["top","offsetTop","height","offsetHeight"],right:["left","offsetLeft","width","offsetWidth"]},h=n(f),h.get_style("position")==="relative")return a=s[i][0],-parseInt(h.get_style(a));for(o=f.parentNode;o!==document&&n(o).get_style("position")==="static";)o=o.parentNode;return c=s[i][2],v=o===document?n.Screen.get_viewport_size()[c]:parseInt(n(o).get_style(c)),y=s[i][1],p=s[i][3],v-f[y]-f[p];case"height":return f.clientHeight||f.offsetHeight&&f.offsetHeight-parseFloat(t(f,"borderTopWidth"))-parseFloat(t(f,"borderBottomWidth"))||0;case"width":return f.clientWidth||f.offsetWidth&&f.offsetWidth-parseFloat(t(f,"borderLeftWidth"))-parseFloat(t(f,"borderRightWidth"))||0;default:return 0}else{switch(i){case"borderLeftWidth":case"borderRightWidth":case"borderTopWidth":case"borderBottomWidth":return i=i.replace("Width","Style"),l=t(f,i),l==="none"?0:parseFloat(l)}f=f||document.body,e=document.createElement("div"),e.style.visbility="hidden",e.style.position="absolute",e.style.lineHeight="0",u==="%"?(f=f.parentNode,i==="height"||i==="top"?e.style.height=r:(i==="width"||i==="left")&&(e.style.width=r)):(e.style.borderStyle="solid",e.style.borderBottomWidth="0",e.style.borderTopWidth=r);try{f.appendChild(e)}catch(b){f=f.parentNode,f.appendChild(e)}return f.offsetWidth,f.offsetHeight,w=e.offsetHeight||e.offsetWidth,f.removeChild(e),w}}else return 0}function v(n,t){var i=c(n,t);return i.camelizedName||n}function y(n,t){var i=c(n,t);return i.nonCamelizedName||n}function c(n,t){var i,e,f,o,s;if(t=t||document.body||document.createElement("div"),i=r[n],!i){for(i={},e=u.length;e--;)if(f=u[e],o=l(f+n),t.style[o]!==undefined){s=(f&&"-"||"")+f.toLowerCase()+n,i.camelizedName=o,i.nonCamelizedName=s;break}r[n]=i}return i}function l(n){return n.replace(/-(\w)/g,function(n,t){return t.toUpperCase()})}var s,h,r,u;this.get_relative_pos=f,this.get_absolute_pos=a,this.offset_includes_borders=e,this.get_bounding_client_rect_offsets=o,s=function(){function t(n,t){n.style.opacity=t}function i(n,t){t*=100;var i;try{i=n.filters.item("DXImageTransform.Microsoft.Alpha"),t<100?(i.Opacity=t,i.enabled||(i.enabled=!0)):i.enabled=!1}catch(r){t<100&&(n.style.filter=(n.currentStyle||n.runtimeStyle).filter+" progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")")}}var n=document.createElement("div");return typeof n.style.opacity!="undefined"&&t||typeof n.style.filter!="undefined"&&i||function(){}}(),this.set_opacity=s,h=function(){function i(n){return parseFloat(n.style.opacity)||t(n,"opacity")}function r(n){var t=n.filters["DXIMageTransform.Microsoft.Alpha"];return t?t.Opacity/100:1}var n=document.createElement("div");return typeof n.style.opacity!="undefined"&&i||typeof n.style.filter!="undefined"&&r||function(){}}(),this.get_opacity=h,this.get_rendered_style=t,this.normalize_style=i,r={},u=["O-","ms-","Moz-","webkit-",""],this.get_camelized_style_name=v,this.get_css_style_name=y,this.camelize=l},n.Events=new function(){var r=n.Helper,i=null,t=null;this.capture_mouse=function(r,u){return n.Events.release_mouse(),i=r,u!==!1&&(u=!0),r.setCapture!==undefined?r.setCapture(u):(t=function(r){var e=r.target,f=document.createEvent("MouseEvents"),o,s;f.initMouseEvent(r.type,r.bubbles,r.cancelable,window,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget),f.__defineGetter__&&(o=n.Screen.get_scroll_pos(),f.__defineGetter__("pageX",function(){return this.clientX+o.x}),f.__defineGetter__("pageY",function(){return this.clientY+o.y})),document.removeEventListener(r.type,t,!0),f.captureTarget=e,s=i,u||n(i).has(e)&&(s=e),s.dispatchEvent(f),t!==null&&document.addEventListener(r.type,t,!0),delete f.captureTarget,r.stopPropagation()},document.addEventListener("mouseover",t,!0),document.addEventListener("mouseout",t,!0),document.addEventListener("mousemove",t,!0),document.addEventListener("mouseup",t,!0),document.addEventListener("mousedown",t,!0),document.addEventListener("click",t,!0),document.addEventListener("dblclick",t,!0)),this},this.release_mouse=function(){return i!==null&&(i.releaseCapture!==undefined?i.releaseCapture():(document.removeEventListener("mouseover",t,!0),document.removeEventListener("mouseout",t,!0),document.removeEventListener("mousemove",t,!0),document.removeEventListener("mouseup",t,!0),document.removeEventListener("mousedown",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("dblclick",t,!0)),i=t=null),this},this.get_capture_target=function(n){return n.captureTarget||n.srcElement||n.target},this.Pseudo=new function(){function t(n,t,i){this.pseudoName=n,this.getNativeName=t,this.getProxiedHandler=i}function v(n,t,i){if(n===t)return!1;for(var r=0;t&&t!=n;)r++,t=t.parentNode;return i=i||r,t===n&&i===r}function h(n){var i=r.get_guid(n),t=f[i];return t||(t=f[i]=function(t){var i=t.relatedTarget;i&&this!==i&&!v(this,i)&&n.call(this,t)}),t}function y(t){if(!n.Browser.is_gecko)return t;var u=r.get_guid(t),i=f[u];return i||(i=f[u]=function(n){n.wheelDelta=-40*n.detail,t.call(this,n),n.wheelDelta=null}),i}function s(t){if(!n.Browser.is_ie)return t;var o=r.get_guid(t),u=f[o];return u||(u=f[o]=function(u){var s,f,h,c,o;if(u.pointerType===u.MSPOINTER_TYPE_TOUCH||u.pointerType==="touch"){/pointerup$/.test(u.type.toLowerCase())||/pointercancel$/.test(u.type.toLowerCase())?delete e[u.pointerId]:(s=n.Screen.get_mouse_pos(u),e[u.pointerId]={_$targetId:r.get_guid(u.target),identifier:u.pointerId,pageX:s.x,pageY:s.y}),h=[],c=[];for(f in e)e.hasOwnProperty(f)&&e[f]&&(o=e[f],h.push(o),o._$targetId===r.get_guid(u.target)&&c.push(o));u.touches=h,u.targetTouches=c,u.type===i.touchstart&&(u.preventDefault=p),t.call(this,u),u.touches=u.targetTouches=null}}),u}function p(){return u[this.pointerId]=!0,document.addEventListener(i.touchend,c,!0),document.addEventListener("click",l,!0),MSPointerEvent.prototype.preventDefault.call(this)}function c(n){o=n.pointerId,u[o]&&(u[o]=!1)}function l(n){var t,r=0;for(t in u)t=parseInt(t),u[t]===!1&&delete u[t]||r++,t===o&&(n.stopPropagation()||n.preventDefault());r===0&&(document.removeEventListener(i.touchend,c,!0),document.removeEventListener("click",l,!0))}function a(){}var o=null,u={},f={},e={},i={touchstart:navigator.pointerEnabled?"pointerdown":"MSPointerDown",touchend:navigator.pointerEnabled?"pointerup":"MSPointerUp",touchmove:navigator.pointerEnabled?"pointermove":"MSPointerMove",touchcancel:navigator.pointerEnabled?"pointercancel":"MSPointerCancel"};return t.prototype.add=function(n,t,i){n.add_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,n),i,!0)},t.prototype.remove=function(n,t,i){n.remove_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,n),i,!0)},{mouseenter:new t("mouseenter",function(){return"mouseover"},function(n){return h(n)}),mouseleave:new t("mouseleave",function(){return"mouseout"},function(n){return h(n)}),mousewheel:new t("mousewheel",function(t){return n.Browser.is_gecko?"DOMMouseScroll":t},function(n){return y(n)}),touchstart:new t("touchstart",function(t){return n.Browser.is_ie?i[t]:t},function(t){return n(document).add_event("touchend",a,!0).add_event("touchcancel",a,!0),s(t)}),touchend:new t("touchend",function(t){return n.Browser.is_ie?i[t]:t},function(n){return s(n)}),touchmove:new t("touchmove",function(t){return n.Browser.is_ie?i[t]:t},function(n){return s(n)}),touchcancel:new t("touchcancel",function(t){return n.Browser.is_ie?i[t]:t},function(n){return s(n)})}}},function(){var u=n.Helper,e=n.Internals,i,t,o={},f={},r={load:!1,unload:!1,focus:!1,blur:!1,beforeunload:!1,stop:!1,beforeprint:!1,afterprint:!1,propertychange:!1,filterchange:!1,readystatechange:!1,losecapture:!1};n.ext.add_event=function(){function s(t,i,r,u){return!u&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].add(this,i,r):this.for_each(function(n){e.addEventListener.call(n,t,i,r)}),this}function h(s,h,c,l){function a(i,r){t=t||1,r.eventPhase=t,r.target=r.srcElement,r.currentTarget=i;var u=n.Screen.get_mouse_pos(r);r.pageX=u.x,r.pageY=u.y;switch(r.type){case"keyup":case"keydown":case"keypress":i.type!=="file"&&(r.keyCode===186?r.keyCode=59:r.keyCode===187?r.keyCode=61:r.keyCode===189?r.keyCode=109:null),r.which=r.keyCode,r.charCode=r.keyCode;break;case"mousedown":case"mouseup":case"click":case"dblclick":case"contextmenu":r.which=[1,1,3,r.button,2][r.button];break;case"mouseover":r.relatedTarget=r.fromElement;break;case"mouseout":r.relatedTarget=r.toElement}return r.preventDefault=function(){r.returnValue=!1},r.stopPropagation=function(){r.cancelBubble=!0},r}function v(n,t,i){var u=r[n],f;return u===!1?!1:(u||(u=r[n]={}),f=u[t],f||(f=u[t]=[]),f.push(i),!0)}function y(n,t){var r=f[n],i;r||(r=f[n]={}),i=r[t],i||(i=r[t]={handlerCount:0,remainingHandlers:0}),i.handlerCount++,i.remainingHandlers=i.handlerCount}function p(n,f){for(var a=[],c=n,o,e,h,v,l;c;)a.push(c),c=c.parentNode;while(o=a.pop())if(e=u.get_guid(o),r[s][e])for(i||(i=o),v=r[s][e].length,h=0;h<v;h++)f.cancelBubble||(o===f.target&&(f.eventPhase=t=2),l=r[s],l[e]&&l[e][h]&&l[e][h].call(o,f));return i}return!l&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[s]?n.Events.Pseudo[s].add(this,h,c):this.for_each(function(n){var w=u.get_guid(n),k=u.get_guid(h)+(c||!1).toString(),b="{"+w+" / "+s+" / "+k+"}",l;c&&(c=v(s,w,h)),l=o[b],l||(l=function(u){var e=f[s][w];e.remainingHandlers--,u=a(n,u),r[s]&&t===1&&(i=p(n,u)),t=n===u.target?2:3,u.eventPhase=t,c||u.cancelBubble||h.call(n,u),(!i||u.cancelBubble||n==i&&e.remainingHandlers===0)&&(t=1,i=undefined,e.remainingHandlers=e.handlerCount),u.eventPhase=u.target=u.currentTarget=u.relatedTarget=u.which=u.preventDefault=u.stopPropagation=u.pageX=u.pageY=undefined},o[b]=l,e.attachEvent.call(n,"on"+s,l),y(s,w)),b=null,l=null}),this}return document.addEventListener?s:document.attachEvent?h:function(){}}(),n.ext.remove_event=function(){function t(t,i,r,u){return!u&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].remove(this,i,r):this.for_each(function(n){e.removeEventListener.call(n,t,i,r)}),this}function i(t,i,s,h){function c(t,i,u){var e=r[t],f,o;e&&(f=e[i],f&&(o=n(f).index_of(u),o!==-1&&f.splice(o,1),f.length===0&&delete e[i]))}function l(n,t){var i=f[n]&&f[n][t];i&&(i.handlerCount>0&&i.handlerCount--,i.remainingHandlers=i.handlerCount)}return!h&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].remove(this,i,s):this.for_each(function(n){var f=u.get_guid(n),a=u.get_guid(i)+(s||!1).toString(),h="{"+f+" / "+t+" / "+a+"}",r;s&&c(t,f,i),r=o[h],r&&(e.detachEvent.call(n,"on"+t,r),delete o[h],l(t,f)),h=null,r=null}),this}return document.addEventListener?t:document.attachEvent?i:function(){}}()}(),function(){var t=n.Helper;n.ext.add_class=function(i){var r=i.split(/\s+/);return this.for_each(function(i){n(r).for_each(function(n){t.has_class(i,[n])||(i.className===""?i.className=n:i.className+=" "+n)})}),this}}(),n.ext.remove_class=function(n){return this.swap_class(n,"$1")},n.ext.swap_class=function(t,i){i!=="$1"&&(i=" "+i+" ");var r=t.split(/\s+/);return this.for_each(function(t){var u=t.className;n(r).for_each(function(n){var t=new RegExp("(^| )"+n+"( |$)");u=u.replace(t,i)}),t.className=u.replace(/^\s+|\s+$/g,"")}),this},function(){var t=n.Helper;n.ext.has_class=function(n,i){var r=this[i||0];return r&&t.has_class(r,[n])||!1}}(),n.ext.get_html=function(n){var t=this[n||0];return t&&t.innerHTML||""},n.ext.set_html=function(n){return this.for_each(function(t){t.innerHTML=n}),this},n.ext.get_val=function(n){var t=this[n||0];return t&&t.value||""},n.ext.set_val=function(n){return this.for_each(function(t){typeof t.value!="undefined"&&(t.value=n)}),this},function(){var t=n.Helper.get_attr;n.ext.get_attr=function(n,i){var r=this[i||0];return r&&t(r,n)||""}}(),n.ext.set_attr=function(n,t){return this.for_each(function(i){i.tagName.toUpperCase()==="INPUT"&&n==="checked"?(i[n]=t,i.defaultChecked=t):n.toUpperCase()==="CLASS"?i.className=t:i.setAttribute(n,t)}),this},function(){var t=n.Style.get_rendered_style,i=n.Style.get_opacity,r=n.Style.get_camelized_style_name;n.ext.get_style=function(n,u){var f=this[u||0];return f?n==="opacity"?i(f):t(f,r(n)):""}}(),function(){var t=n.Style.set_opacity,i=n.Style.get_camelized_style_name;n.ext.set_style=function(n){return this.for_each(function(r){var e,u,f;for(e in n){u=n[e],f=i(e);switch(f){case"height":case"maxHeight":case"minHeight":case"width":case"maxWidth":case"minWidth":case"top":case"right":case"bottom":case"left":case"marginTop":case"marginRight":case"marginBottom":case"marginLeft":case"paddingTop":case"paddingRight":case"paddingBottom":case"paddingLeft":r.style[f]=typeof u=="number"?(u||0)+"px":u;break;case"opacity":t(r,u);break;default:r.style[f]=u}}}),this}}(),n.ext.get_native_prop=function(n,t){var i=this[t||0];return i?i[n]:""},n.ext.parent=function(t){var i=this[t||0];return n(i&&i.parentNode)},n.ext.element=function(n){return this[n||0]},n.ext.get_ancestor=function(t,i){for(var r=this[i||0],u=t;u-->0;)if(r)r=r.parentNode;else break;return n(r)},n.ext.get_sibling=function(t,i){var f=this[i||0],r=f;if(t!==0)for(var e=t>0?"nextSibling":"previousSibling",o=Math.abs(t),u=0;u<o;){if(r=r[e],!r)break;r.nodeType===1&&u++}return n(r)},n.ext.for_each=function(){function n(n,t){return this.entities().forEach(n,t),this}function t(n,t){for(var r=this.entities(),u=r.length,i=0;i<u;i++)n.call(t,r[i],i,r);return this}return typeof Array.prototype.forEach!="undefined"?n:t}(),n.ext.iterate=function(t){for(var u=this.length,r,i=0;i<u;i++)r=n(this[i]),t.call(r,i);return t=null,this},n.ext.filter=function(t){for(var r=n(),i=this.length;i--;)t(this[i])&&r.unshift(this[i]);return r},n.ext.map=function(){function t(t,i){return n(this.entities().map(t,i))}function i(t,i){for(var r=n(),u=this.length;u--;)r.unshift(t.call(i,this[u]));return r}return typeof Array.prototype.map!="undefined"?t:i}(),function(){var t=n.Helper;n.ext.contains=function(n){return t.contains(this.entities(),n)}}(),function(){var t=n.Helper;n.ext.index_of=function(n){return t.index_of(this.entities(),n)}}(),n.ext.select=function(t){return n(t,this[0])},n.ext.has=function(t,i){var r=this[i||0];return n(t,r).length>0},function(){var t=n.Helper;n.ext.unique=function(){return n(t.unique(this.entities()))}}(),function(){var t=n.Style.get_rendered_style;n.ext.get_style_pos=function(n){var i=this[n||0];return{x:parseFloat(t(i,"left")),y:parseFloat(t(i,"top"))}}}(),function(){var t=n.Style.get_absolute_pos;n.ext.get_absolute_pos=function(n){var i=this[n||0];return i&&t(i)||{x:0,y:0}}}(),function(){var t=n.Style.get_relative_pos;n.ext.get_relative_pos=function(n){var i=this[n||0];return i&&t(i)||{x:0,y:0}}}(),function(){n.ext.get_scroll_pos=function(t){var r=this[t||0],i={x:0,y:0};return r===window?typeof window.pageYOffset!="undefined"?(i.x=window.pageXOffset,i.y=window.pageYOffset):n.Browser.is_in_quirks_mode||typeof document.documentElement.scrollTop=="undefined"?typeof document.body.scrollTop!="undefined"&&(i.x=document.body.scrollLeft,i.y=document.body.scrollTop):(i.x=document.documentElement.scrollLeft,i.y=document.documentElement.scrollTop):(i.x=r.scrollLeft,i.y=r.scrollTop),i}}(),n.ext.animate=function(t,i,r,u,f){function l(n,t,i){switch(n){case"+":return t+i;case"-":return t-i;case"*":return t*i;case"/":return t/i;default:return i}}function s(t,i){var r=n(t).get_style(i)+"",u=parseFloat(r);return e.units[i]=r.replace(u,""),u}function a(n,i){var e=s(n,i),r=t[i]+"",u=r.match(/^[+\-*\/]/),f=u&&u[0]||"noOp";return r=Number(r.replace(f,"")),l(f,e,r)}var e={units:{},ops:{}},h={},o,c;for(o in t)e[o]=s,h[o]=a;return c=n.Effects.Storyboard.create(this,e,h,function(t,i){var f=n(t),r,u;for(r in i)r!=="units"&&(u={},u[r]=i[r]+e.units[r],f.set_style(u))},i,r,u,f),c.begin(),this},n.ext.bounce=function(t,i,r,u,f){function e(t){return n(t).get_style_pos().y}t===null&&(t=e);var o=n.Effects.Storyboard.create(this,{top:t},{top:i},function(n,t){n.style.top=Math.ceil(t.top)+"px"},r,u,f,n.Effects.Easing.Bounce.ease_out);return o.begin(),this},function(){function t(t,i,r,u,f){this.set_style({zoom:1}),t===null&&(t=function(t,i){return Number(n(t).get_style(i))});var e=n.Effects.Storyboard.create(this,{opacity:t},{opacity:i},function(t,i){n(t).set_style({opacity:i.opacity})},r,u,f,null);return e.begin(),this}n.ext.fade_to=t,n.ext.fade_in=function(n,i,r,u){return t.call(this,0,1,n,i,r,u)},n.ext.fade_out=function(n,i,r,u){return t.call(this,1,0,n,i,r,u)}}(),n.ext.slide=function(t,i,r,u,f,e){function o(t,i){i=i==="left"?"x":"y";var r=t.__pos;return r||(r=t.__pos=n(t).get_style_pos()),i==="y"&&(t.__pos=n.undefined),r[i]}t===null&&(t={x:o,y:o});var s=Math.round,h=n.Effects.Easing.Exponential.ease_in_out,c=n.Effects.Storyboard.create(this,{left:t.x,top:t.y},{left:i.x,top:i.y},function(n,t){n.style.top=s(t.top)+"px",n.style.left=s(t.left)+"px"},r,u,f,e||function(n){return h(n,4)});return c.begin(),this},n.ext.scroll_to=function(t,i,r,u){var f=n.Screen.get_scroll_pos(),e=n(this[0]).get_absolute_pos(),o=Math.round,s=n.Effects.Easing.Exponential.ease_out,h=n.Effects.Storyboard.create([window],{scrollX:f.x,scrollY:f.y},{scrollX:e.x,scrollY:e.y},function(n,t){n.scrollTo(o(t.scrollX),o(t.scrollY))},t,i,r,u||function(n){return s(n,4)});return h.begin(),this},n.ext.veil=function(t,i,r,u,f){function l(t,i){var r=parseInt(n(t).get_style(i),10);return t[h]=t[h]||{},t[h][i]=r}var e=n.Effects.Enums.Directions,h,o,s,c;return t=Math.floor(t)||e[t]||e.vertically,h="_$gimme$_veil",o={},s={},(t&e.vertically)===e.vertically&&(s.height=s.paddingTop=s.paddingBottom=l,o.height=o.paddingTop=o.paddingBottom=0),(t&e.horizontally)===e.horizontally&&(s.width=s.paddingLeft=s.paddingRight=l,o.width=o.paddingLeft=o.paddingRight=0),c=n.Effects.Storyboard.create(this.filter(function(t){var i=t.style.display||n(t).get_style("display");return i!=="none"}),s,o,function(n,i){var r=n.style;(t&e.vertically)===e.vertically&&(r.height=i.height+"px",r.paddingTop=i.paddingTop+"px",r.paddingBottom=i.paddingBottom+"px"),(t&e.horizontally)===e.horizontally&&(r.width=i.width+"px",r.paddingRight=i.paddingRight+"px",r.paddingLeft=i.paddingLeft+"px")},i,r,u,f||function(t){return n.Effects.Easing.Exponential.ease_in_out(t,4)}),c.get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(n){n.style.overflow="hidden"}}),new n.Effects.Animation({startTime:c.get_duration(),elements:this,animate:function(n){n.style.display="none"}})),c.begin(),this},n.ext.unveil=function(t,i,r,u,f){function c(t,i){var r=t._$gimme$_veil;return r||(r=r||function(){var i=t.cloneNode(!0),r,u,f;return i.style.cssText="position:absolute;top:0;left:0;visibility:hidden;margin:0;padding:0;border:0;height:;width:;",i.style.display="block",t.parentNode.appendChild(i),i=n(i),r=parseInt(n(t).get_style("height"),10)||parseInt(i.get_style("height"),10),u=parseInt(n(t).get_style("width"),10)||parseInt(i.get_style("width"),10),i[0].style.padding=t.style.padding,f={height:r,width:u,paddingTop:parseInt(i.get_style("paddingTop"),10),paddingBottom:parseInt(i.get_style("paddingBottom"),10),paddingRight:parseInt(i.get_style("paddingRight"),10),paddingLeft:parseInt(i.get_style("paddingLeft"),10)},t.parentNode.removeChild(i[0]),t.style.overflow="hidden",f}()),r[i]}var e=n.Effects.Enums.Directions,o,s,h;return t=Math.floor(t)||e[t]||e.vertically,e=n.Effects.Enums.Directions,t=Math.floor(t)||e[t]||e.vertically,o={},s={},(t&e.vertically)===e.vertically&&(s.height=s.paddingTop=s.paddingBottom=0,o.height=o.paddingTop=o.paddingBottom=c),(t&e.horizontally)===e.horizontally&&(s.width=s.paddingLeft=s.paddingRight=0,o.width=o.paddingLeft=o.paddingRight=c),h=n.Effects.Storyboard.create(this.filter(function(t){var i=t.style.display||n(t).get_style("display");return i==="none"||i===null}),s,o,function(n,i){(t&e.vertically)===e.vertically&&(n.style.height=i.height+"px",n.style.paddingTop=i.paddingTop+"px",n.style.paddingBottom=i.paddingBottom+"px"),(t&e.horizontally)===e.horizontally&&(n.style.width=i.width+"px",n.style.paddingRight=i.paddingRight+"px",n.style.paddingLeft=i.paddingLeft+"px")},i,r,u,f||function(t){return n.Effects.Easing.Exponential.ease_in_out(t,4)}),h.get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(n){n.style.overflow="hidden",n.style.display="block"}}),new n.Effects.Animation({startTime:h.get_duration(),elements:this,animate:function(n){n.style.overflow=""}})),h.begin(),this},n.toString=function(){return"Gimme v2.7.0 (Edmund) :: Friday, September 14, 2012 3:02:22 PM"},n.Internals.parseJSON=function(n){var t=window.JSON&&window.JSON.parse||(n="("+n+")")&&eval;return t(n)},n}(),window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.initMapCode=function(){function i(n,t){this.x=n,this.y=t}function v(n,t,i,r){this.latitude=parseFloat(n),this.longitude=parseFloat(t),ct.isValid(r)&&(this.altitude=parseFloat(i),this.altitudeReference=r)}function ut(n,t,i){this.center=n,this.width=t,this.height=i}function uu(t){function r(){var t=f.getWidth(),i=f.getHeight();(t!==e||i!==o)&&(e=t,o=i,n.invoke(f,"resize",{width:t,height:i}))}var f=this,i,e,o,h=y(t),s=y(window);this.getWidth=function(){return t.offsetWidth},this.getHeight=function(){return t.offsetHeight},this.startMonitoring=function(){i||(i=window.setInterval(r,1e3)),s.add_event("resize",r)},this.stopMonitoring=function(){u.useOnResize&&t.onresize===r&&(t.onresize=null),i&&(window.clearInterval(i),i=null),s.remove_event("resize",r)},this.poll=function(){e=null,o=null,r()}}function ur(r,f){function hr(){function p(){var i=e.getImageryId(),n="dark",t=y("~.InfoboxExtension",s);switch(i){case"Aerial":case"EnhancedBirdseye":case"NativeBirdseye":v.add_class(n),t.add_class(n);break;default:v.remove_class(n),t.remove_class(n)}}var o,a,d,i,r,h;if(f=f||{},s=k(),s.className="MicrosoftMap",u.allowFocus&&(l=k("button","position:fixed;width:1px;height:1px;left:0;top:0;padding:0;font-size:0;line-height:0;border:0;background:transparent;",s),l.tabIndex=-1,u.useXHR&&y(l).set_style({display:"none"})),ht=yi(),bt=yi(),ft.appendChild(s),t.versionNotSupported===!0){i=k("div","position:absolute; width:100%; top:50%; text-align:center"),r=k("div","background: #f8f7f5; padding:10px; color: #000;"),r.innerHTML=rr.getString("L_VersionNotSupportedMessage_Text"),i.appendChild(r),e.getRootElement().appendChild(i);return}if(t.killSwitchEngaged===!0){i=k("img","position:absolute; height:100%; margin:auto"),i.src=t.killSwitchImageUrl,e.getRootElement().appendChild(i);return}if(kt=y(document),gt=y(ht),v=y(s),ti=f.restrictKeyboardListeningToMapContainer?y(ft):kt,f.theme&&(ut=f.theme,ut._attachToMap&&ut._attachToMap(e,f)),f.showHotRegions===!0&&(t.onDemandRoadUriFormat&&(t.roadUriFormat=t.onDemandRoadUriFormat),t.onDemandAerialWithLabelsUriFormat&&(t.aerialWithLabelsUriFormat=t.onDemandAerialWithLabelsUriFormat)),n.invoke(ur,"mapcreationstart",{map:e,options:f}),si=f.credentials,c.authenticate(f.credentials),typeof st!="undefined"&&st.authenticate(e.getCredentials),g=new uu(s),n.addHandler(g,"resize",ar),wi(f.width,f.height),t.ddCoreStylesDownloaded||ut&&!u.useXHR||(fi.downloadStyles(t.cssPath+"mapcontrol.css"),t.ddCoreStylesDownloaded=!0),o=ru(f),o.mapTypeId=o.mapTypeId||dt.auto||dt.road,o.animate=!1,e.setView(o),ui&&e.focus(),v.add_event("mousedown",e.focus).add_event("touchstart",e.focus),t.allowBirdseye===!1&&(f.disableBirdseye=!0),b.dispatch(function(){if(c){var n={showDashboard:f.showDashboard,showMapTypeSelector:f.showMapTypeSelector,showDualMapTypeSelector:f.showDualMapTypeSelector,disableBirdseye:f.disableBirdseye,showBreadcrumb:f.showBreadcrumb,showScalebar:f.showScalebar,scalebarPosition:f.scalebarPosition||"bottomRight",showLogo:f.showLogo,logoPosition:f.logoPosition||"bottomLeft",clickable:f.enableClickableLogo,enableSearch:f.enableSearchLogo,showCopyright:f.showCopyright,copyrightPosition:f.copyrightPosition||"bottomRight",copyrightStacked:f.copyrightStacked||!1};c.showOverlays(n)}}),f.showHotRegions===!0&&(b.dispatch(function(){c&&c.showHotRegions(f.disableLabels)}),f.showVenueMapsExplorer===!0&&b.dispatch(function(){c&&c.showVenueMapsExplorer()})),t.disableAnalytics||f.disableAnalytics||(a=new bu(e),e.addComponent("analyticsProxy",a),!t.frontdoorLogUrl&&t.biciLoggingService&&e.getCredentials(function(n){a.enable({sessionKey:n})})),f.fixedMapPosition===!0&&(oi=!1),d=n.addHandler(e,"imagerychanged",p),p(),u.useXHR&&t.message&&(i=k("div","position:absolute; width:100%; top:50%; text-Align:center"),r=k("div","background: #f8f7f5; padding:10px; color: #000;"),r.innerHTML=t.message,i.appendChild(r),e.getRootElement().appendChild(i)),t.updateAvailable===!0,t&&t.allowOrdnanceSurvey&&t.logOSServiceUriFormat){function w(){e.getCredentials(function(n){fi.getObjectAsyncWithNoJsonso(t.logOSServiceUriFormat.replace(/{credentials}/,n),function(){})})}if(e.getImageryId()==="OrdnanceSurvey")b.dispatch(w);else{function nt(){e.getImageryId()==="OrdnanceSurvey"&&(h&&(n.removeHandler(h),h=null),b.dispatch(w))}h=n.addHandler(e,"imagerychanged",nt)}}}function cr(t){for(var i=w.length;i--;)w[i][1]=n.addHandler(t,w[i][0],function(){var t=w[i][0];return function(i){n.invoke(e,t,i)}}());y(s).add_event("mouseenter",function(t){n.invoke(e,"mouseover",new vi(e,ni.map,e,"mouseover",t.clientX,t.clientX,0,!1,t))}),y(s).add_event("mouseleave",function(t){n.invoke(e,"mouseout",new vi(e,ni.map,e,"mouseout",t.clientX,t.clientX,0,!1,t))})}function ai(){for(var t,i=w.length;i--;)t=w[i][1],t&&n.removeHandler(t),w[i][1]=null;y(s).remove_event("mouseenter",function(t){n.invoke(e,"mouseover",new vi(e,ni.map,e,"mouseover",t.clientX,t.clientX,0,!1,t))}),y(s).remove_event("mouseleave",function(t){n.invoke(e,"mouseout",new vi(e,ni.map,e,"mouseout",t.clientX,t.clientX,0,!1,t))})}function yi(){return k("div","z-index:0;position:absolute;left:50%;top:50%;"+u.safariRenderHack,s)}function wi(n,t){n>0&&t>0?(g.stopMonitoring(),at=!1,s.style.cssText=sr.replace("{width}",n).replace("{height}",t),bi(n,t)):(s.style.cssText=or,at=!0,g.startMonitoring(),g.poll())}function bi(t,i){t=Math.round(Math.max(1,t)),i=Math.round(Math.max(1,i)),(t!==vt||i!==pt)&&(vt=t,pt=i,lr(t,i),n.invoke(e,"resize"))}function lr(n,t){setTimeout(function(){var i=y(s);t<100||n<240?i.add_class("miniscule"):(n>=240&&n<320?i.remove_class("medium large").add_class("verySmall"):n>=320&&n<600?i.remove_class("verySmall large").add_class("medium"):i.remove_class("verySmall medium").add_class("large"),i.remove_class("miniscule"))},1)}function ar(n){at&&bi(n.width,n.height)}function d(){var n,t;wt&&(n=v.get_absolute_pos(),et=n.x,ot=n.y,t=gt.get_absolute_pos(),nt=t.x,tt=t.y,wt=!1,oi&&b.dispatch(nr))}function nr(){wt=!0}function tr(n){for(var t in p)if(p.hasOwnProperty(t)&&p[t].getMode()===n)return p[t];return null}function vr(t){if(o!=t){var i=o,r=tr(i),u=tr(t),f="MapTypeId_";t.activating&&t.activating(e,{credentials:si}),i&&i.deactivating&&i.deactivating(),ai(),o=t,rt=null,r&&v.remove_class(f+r.getMapTypeId()),i&&i.deactivated&&i.deactivated(),u&&v.add_class(f+u.getMapTypeId()),cr(t),t.activated&&t.activated(),n.invoke(e,"modechanged"),n.invoke(e,"imagerychanged"),n.invoke(e,"copyrightchanged")}}function ii(n){var t,i;return pi!==e?!1:(t=n.target,t&&(i=t.tagName,i==="INPUT"&&(t.type==="text"||t.type==="search")||i==="TEXTAREA"||i==="SELECT"))?!1:!0}function ri(t,i){if(n.hasHandler(e,t)){var r=new yr(t,i.keyCode,i.altKey,i.ctrlKey,i.shiftKey,i.charCode);r.originalEvent=i,n.invoke(e,t,r)}}function ir(n){ii(n)&&ri("keydown",n)}function fr(n){ii(n)&&ri("keyup",n)}function er(n){ii(n)&&ri("keypress",n)}var w;PRF.start("mapobj");var e=this,c=new kr(this),ft=r,s,at=!0,ui=window.top==window.self,vt,pt,et,ot,nt,tt,g,ei="z-index:0;overflow:hidden;direction: ltr !important;background-color:"+(f&&f.backgroundColor?yt.clone(f.backgroundColor).toHex()+";":"#F4F2EE;");var or=ei+(y.Browser.is_in_quirks_mode?"position:absolute;top:0;left:0;width:100%;height:100%":"position:absolute;left:0;top:0;right:0;bottom:0"),sr=ei+"position:relative;width:{width}px;height:{height}px",oi=!0,wt=!0,ht,bt,ct={min:t.minMercatorZoom,max:t.maxMercatorZoom},rt=null,l,kt,gt,v,ti,o=null,si,p=[],lt=null,ut=null,a={width:null,height:null,disableUserInput:!1,disableKeyboardInput:!1,disableMouseInput:!1,disableTouchInput:!1,disableZooming:!1,disablePanning:!1,labelOverlay:it.visible,useInertia:!0,inertiaIntensity:-1,tileBuffer:0,showBackground:null,pinFocusBehavior:pr.highlight},hi=new gi,li={};this.addComponent=function(t,i){li[t]=i,n.invoke(e,"componentadded",{componentName:t,component:i})},this.getComponent=function(n){return li[n]},this.getCredentials=function(n){c?c.getCredentials(n):typeof n=="function"&&n(null)},this.getWidth=function(){return vt},this.getHeight=function(){return pt},this.getPageX=function(){return d(),et},this.getPageY=function(){return d(),ot},this.getViewportX=function(){return d(),nt},this.getViewportY=function(){return d(),tt},this.getTheme=function(){return ut},this.focus=function(){a.disableUserInput||a.disableKeyboardInput||(l&&(l.offsetWidth>0||l.offsetHeight>0)&&ui?l.focus():window.focus(),pi!==e&&(pi&&pi.blur(),l&&ti.add_event("keydown",ir).add_event("keypress",er).add_event("keyup",fr),pi=e,n.invoke(e,"focus")))},this.blur=function(){if(l){try{l.blur()}catch(t){}ti.remove_event("keydown",ir).remove_event("keypress",er).remove_event("keyup",fr)}pi===e&&(n.invoke(e,"blur"),pi=null)},this.getRootElement=function(){return s},this.getModeLayer=function(){return ht},this.getUserLayer=function(){return bt},this.updateMapPosition=nr,this.dispose=function(){if(e){n.invoke(e,"ondispose",null),c.dispose(),e.blur(),e.entities.clear(),o&&o.deactivating&&o.deactivating(),ai(),o&&o.deactivated&&o.deactivated(),o=null,p.length=0,g.stopMonitoring(),g=null,v.remove_event("mousedown",e.focus).remove_event("touchstart",e.focus),ft.removeChild(s),s=null,ft=null,ht=null,bt=null,kt=null,gt=null,v=null,c=null;for(var t=di.length;t--;)di[t]===e&&di.splice(t,1);e=null}},this.setView=function(t){var i,r,u;e.setOptions(t),t.mapTypeId&&(i=p[t.mapTypeId],i!==lt&&(this.entities=hi,r=o,u=null,r&&(u=r.getCenter()),i.activating(),lt=i,vr(i.getMode()),i.activated(),n.invoke(e,"maptypechanged"),t.center||t.bounds||!u||r===o||(t.center=u,t.animate==null&&(t.animate=!1)))),o.setView(t)},this.setOptions=function(t){var i,r=!1;for(i in t)a[i]!==h&&t[i]!==h&&a[i]!==t[i]&&(a[i]=t[i],r=!0);r&&(a.width!==h&&a.height!==h&&wi(a.width,a.height),n.invoke(e,"optionschanged"))},this.getOptions=function(){return ru(a)},this.getCenter=function(){return o.getCenter()},this.getZoom=function(){return o.getZoom()},this.getZoomRange=function(){return rt||(rt={min:Math.max(t.minMercatorZoom,o.getInternalMinZoom(),ct.min),max:Math.min(t.maxMercatorZoom,o.getInternalMaxZoom(),ct.max)}),rt},this.restrictZoom=function(n,i){if(n>i)throw"min zoom cannot be greater than max zoom";ct.min=n||t.minMercatorZoom,ct.max=i||t.maxMercatorZoom,rt=null},this.getHeading=function(){return o.getHeading()},this.getRequestedHeading=function(){return o.getRequestedHeading()},this.getBounds=function(){return o&&o.getBounds()},this.getMetersPerPixel=function(){return o.getMetersPerPixel()},this.getTargetCenter=function(){return o.getTargetCenter()},this.getTargetZoom=function(){return o.getTargetZoom()},this.getTargetHeading=function(){return o.getTargetHeading()},this.getTargetBounds=function(){return o.getTargetBounds()},this.getTargetMetersPerPixel=function(){return o.getTargetMetersPerPixel()},this.tryLocationToPixel=function(n,t,i){var r,u,f,e,s;if(!o.tryLocationToViewport)return null;if(r=o.tryLocationToViewport(n,i),r&&t){u=0,f=0;switch(t){case ci.page:d(),u=nt,f=tt;break;case ci.control:d(),u=nt-et,f=tt-ot}if(u||f)if(ki(r))for(s=r.length;s--;)e=r[s],e&&(e.x+=u,e.y+=f);else r.x+=u,r.y+=f}return r},this.tryPixelToLocation=function(n,t,r){var s,u,f,e;if(!o.tryViewportToLocation)return null;if(s=n,t){u=0,f=0;switch(t){case ci.page:d(),u=nt,f=tt;break;case ci.control:d(),u=nt-et,f=tt-ot}if(u||f)if(ki(n))for(e=n.length,s=new Array(e);e--;)s[e]=new i(n[e].x-u,n[e].y-f);else s=new i(n.x-u,n.y-f)}return o.tryViewportToLocation(s,r)},this.isDownloadingTiles=function(){return o&&o.isDownloadingTiles?o.isDownloadingTiles():!1},this.getTileDownloadMetrics=function(){return o&&o.getTileDownloadMetrics?o.getTileDownloadMetrics():0},this.getImageryId=function(){return o&&o.getImageryId?o.getImageryId():""},this.isMercator=function(){return o.isMercator?o.isMercator():!1},this.isRotationEnabled=function(){return o.isRotationEnabled()},this.getCopyrights=function(n){return o&&o.getCopyrights&&o.getCopyrights(n),[]},this.getMode=function(){return o.getPublicApi?o.getPublicApi():{}},this.setMapType=function(n){this.setView({mapTypeId:n})},this.getMapTypeId=function(){return lt?lt.getMapTypeId():""},this.registerMapType=function(n){var t=n.getMapTypeId();if(p[t])throw"InvalidOperation: already registered";p.push(n),p[t]=n},this.entities=hi,w=[["viewchangestart",null],["viewchange",null],["viewchangeend",null],["targetviewchanged",null],["imagerychanged",null],["copyrightchanged",null],["tiledownloadcomplete",null],["click",null],["dblclick",null],["rightclick",null],["mousedown",null],["mouseup",null],["mousemove",null],["mousewheel",null]],hr(),di.push(e),PRF.end("MapObject instantiated","mapobj")}function oi(n,t){var i=n,r=t;this.getMapTypeId=function(){return i},this.getMode=function(){return r},this.activating=function(){},this.activated=function(){}}function vi(n,t,i,r,u,f,e,o,s){var h=n;this.pageX=u,this.pageY=f,this.eventName=r,this.targetType=t,this.target=i,this.wheelDelta=e,this.isTouchEvent=o,this.originalEvent=s,this.isPrimary=s.which===1,this.isSecondary=s.which===3,this.getX=function(){return this.pageX-h.getViewportX()},this.getY=function(){return this.pageY-h.getViewportY()}}function yr(n,t,i,r,u,f){this.eventName=n,this.keyCode=t,this.charCode=f,this.altKey=i,this.ctrlKey=r,this.shiftKey=u,this.originalEvent={}}function yt(n,t,i,r){this.a=n,this.r=t,this.g=i,this.b=r}function gi(t){function s(t){t.collection||(t.collection=r),n.invoke(r,"entitychanged",t)}function h(t){n.invoke(r,"entityadded",t)}function c(t){n.invoke(r,"entityremoved",t)}function e(t,i){var e=f.length;if(!t[u])for(t[u]=[];e--;)t[u].push(n.addHandler(t,f[e][0],f[e][1]));n.invoke(r,"entityadded",{collection:r,entity:t,index:i})}function o(t){if(t){for(var i=f.length;i--;)n.removeHandler(t[u][i]);delete t[u],n.invoke(r,"entityremoved",{collection:r,entity:t})}}var r=this,u="_ech"+ai.getNext(),f=[["entityadded",h],["entityremoved",c],["entitychanged",s]],i;this._eventsHandlers=f,i=[],this.get=function(n){return i[n]},this.getLength=function(){return i.length},this.push=function(n){i.push(n),e(n,i.length)},this.insert=function(n,t){i.splice(t,0,n),e(n,t)},this.pop=function(){var n=i.pop();return o(n),n},this.removeAt=function(n){var t=i[n];return i.splice(n,1),o(t),t},this.remove=function(n){for(var r=null,t=i.length;t--;)if(i[t]===n){r=this.removeAt(t);break}return r},this.clear=function(){while(i.length>0)this.pop()},this.indexOf=function(n){for(var t=i.length;t--;)if(i[t]===n)break;return t},this.setOptions(t)}function fu(n,t){this._location=n,this.setOptions(t,!1)}function d(n,t){d.baseConstructor.call(this,n,t),this.setOptions(t)}function nr(n,i){this._location=n,i&&typeof i.useTransform3d=="boolean"&&(this._useTransform3d=i.useTransform3d),this._icon=t.pushpinImageUrl,this.setOptions(i)}function tr(n,t){this._locations=n,this.setOptions(t)}function ir(n,t){this._locations=n,this.setOptions(t)}function ar(t){var u=this,f=!0,e=0,o=1,s={},c=er.high,l=wr.auto,a=!0,i=1e4,v,r;this.setOptions=function(t){if(t){var r=!1;typeof t.visible=="boolean"&&(f=t.visible,r=!0),typeof t.reproject=="boolean"&&(a=t.reproject,r=!0),si(t.tileDownloadPriority)&&(c=t.tileDownloadPriority,r=!0),si(t.zIndex)&&(e=t.zIndex,r=!0),si(t.opacity)&&(o=t.opacity,r=!0),t.animationDisplay&&(l=t.animationDisplay,r=!0),t.downloadTimeout!==h&&(i=t.downloadTimeout,(typeof i!="number"||i<=0)&&(i=1e4),r=!0),r&&n.invoke(u,"entitychanged",{entity:u})}},v=typeof ft!="undefined"?ft:{mercator:{}};for(r in v)t[r]instanceof br&&(s[r]=t[r]);this.getVisible=function(){return f},this.getZIndex=function(){return e},this.getOpacity=function(){return o},this.getAnimation=function(){return l},this.getReproject=function(){return a},this.getDownloadTimeout=function(){return i},this.getTileSource=function(n){return s[n]},this.getTileDownloadPriority=function(){return c},this.setOptions(t)}function br(n){var u=t.defaultTileSize,f=t.defaultTileSize,i,r;isFinite(n.width)&&(u=n.width),isFinite(n.height)&&(f=n.height),typeof n.uriConstructor=="string"?(i=n.uriConstructor,r=n.uriConstructor):(typeof n.uriConstructor=="function"&&(i=n.uriConstructor),typeof n.uriFormat=="string"&&(r=n.uriFormat)),this.getWidth=function(){return u},this.getHeight=function(){return f},this.getUriConstructor=function(){return i},this.getUriFormat=function(){return r}}function kr(n){this._map=n,this.dispose=function(){this._map=null}}function bu(t){function l(){f=n.addHandler(r,"ondispose",h),g.load(e,{callback:function(){o.Analytics&&o.Analytics.AnalyticsManager&&r&&(s=!0,u=new o.Analytics.AnalyticsManager(r))}})}function i(n,t){u?u[n].apply(u,t):!s&&r&&g.add(e,c,n,t)}function h(){i("dispose",arguments),u=r=null,n.removeHandler(f),f=null}var c=this,e="Microsoft.Maps.Analytics",r=t,f=null,u=null,s=!1;this.logClientAction=function(){i("logClientAction",arguments)},this.beginBatchedAction=function(){i("beginBatchedAction",arguments)},this.logBatchedEvent=function(){i("logBatchedEvent",arguments)},this.computeTotalDuration=function(){i("computeTotalDuration",arguments)},this.endBatchedAction=function(){i("endBatchedAction",arguments)},this.addPreProcessor=function(){i("addPreProcessor",arguments)},this.removePreProcessor=function(){i("removePreProcessor",arguments)},this.registerAction=function(){i("registerAction",arguments)},this.registerChildActions=function(){i("registerChildActions",arguments)},this.enable=function(){i("enable",arguments)},this.dispose=h,l()}function r(n,t,i){this.x=n,this.y=t,this.z=i}function pt(n,t){this.width=n,this.height=t}function lt(n,t,i,r){this.x=n,this.y=t,this.width=i,this.height=r}function wt(n,t,i,r,u,f){this.m11=n,this.m12=t,this.m21=i,this.m22=r,this.offsetX=u,this.offsetY=f}function e(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.m11=n,this.m12=t,this.m13=i,this.m14=r,this.m21=u,this.m22=f,this.m23=e,this.m24=o,this.m31=s,this.m32=h,this.m33=c,this.m34=l,this.offsetX=a,this.offsetY=v,this.offsetZ=y,this.m44=p}function ei(n,t,i,r){this.a=n,this.b=t,this.c=i,this.d=r}function ti(n,t){this.x=n,this.y=t}function rt(n,t,i){this.levelOfDetail=n,this.x=t,this.y=i}function f(n,u,o,s,l,a,y,p,w,b){function tt(){var l,h,b,p;if(!ni){ft=s===0&&et===-90&&a===0,st=ft||ct<=ot,at=st&&ft?f.simpleGround:ei.fromNormal(rt,it.getUpVector(rt));var n=f.simpleWorldToFrustumNoZ,i=1/g,u=g*1e3;if(ut=it.getNadirMatrix(rt),ft||(ut=e.multiply(ut,e.rotationZ(-pt),e.rotationX(-(et+90)),e.rotationZ(-lt))),st)ft?(n.m22=n.m11=i,n.m33=i*-.001,n.offsetX=ut.offsetX*i,n.offsetY=ut.offsetY*i):n=e.multiply(ut,e.scaling(i,i,1/u));else{var y=Math.pow(2,wt)*g,o=1/ct,w=o/y;u=Math.min(o*.99,u),l=o-u,h=o+u,n=e.multiply(ut,e.translation(bt),e.translation(0,0,o),new e(w,0,0,0,0,w,0,0,0,0,h/(h-l),1,0,0,l*h/(l-h),0),e.scaling(y/g,y/g,1)),b=n.transform(rt),n.multiplyBy(e.translation(r.multiply(b,-1)))}ft?ht=n.clone():(vt=n.invert().projectOnPlane(at),ht=vt.invert()),ft?(k=ht.clone(),k.m11*=d,k.m22*=d,k.m33*=d,k.offsetX*=d,k.offsetY*=d,p=g/d,nt=ut.clone(),nt.m11*=p,nt.m22*=p,nt.m33*=u/d,nt.offsetX*=-1,nt.offsetY*=-1):(k=e.multiply(ht,e.scaling(d)),nt=k.invert()),yt=it.toLocation(rt),kt=f.widthToMercatorZoom(g,it,rt),dt=it.unitsToMeters(rt,g)/t.zoomOriginWidth,gt=!st||Math.abs(et+90)>ot||it!==c,ni=!0}}var ti=this;var it=n,rt=u,g=o,pt=s||0,et=l===h?-90:l,lt=a||0,ct=y||0,wt=p||0,bt=w||new r(0,0,0),ft,st,at,ut,ht,vt,k,nt,yt,kt,dt,gt,d=b||t.zoomOriginWidth,ni=!1;this.getCrs=function(){return it},this.getLookAt=function(){return rt},this.getWidth=function(){return g},this.getHeading=function(){return pt},this.getPitch=function(){return et},this.getRoll=function(){return lt},this.getDistanceInverse=function(){return ct},this.getZoomDelta=function(){return wt},this.getPerspectiveOrigin=function(){return bt},this.getZoomOriginWidth=function(){return d},this.getGroundPlane=function(){return tt(),this.getGroundPlane=function(){return at},at},this.getWorldToViewport=function(){return tt(),this.getWorldToViewport=function(){return k},k},this.getViewportToWorld=function(){return tt(),this.getViewportToWorld=function(){return nt},nt},this.getWorldToFrustum=function(){return tt(),this.getWorldToFrustum=function(){return ht},ht},this.getFrustumToWorld=function(){return tt(),this.getFrustumToWorld=function(){return vt},vt},this.getCenter=function(){return tt(),this.getCenter=function(){return yt},yt},this.getMercatorZoom=function(){return tt(),this.getMercatorZoom=function(){return kt},kt},this.getMetersPerPixel=function(){return tt(),this.getMetersPerPixel=function(){return dt},dt},this.getNeedsElevation=function(){return tt(),this.getNeedsElevation=function(){return gt},gt},this.getAlignedCamera=function(n,t,r,u){var s,l;tt();var v=g/Math.pow(2,n),o,h=null,c=0,a=null;return t?(o=t,st||(a=e.multiply(ut,e.translation(bt)),h=a.transform(o),c=n+wt)):o=rt,s=pt,u&&(s=s+u),c=0,l=new f(it,o,v,s,et,lt,ct,c,h,d),r&&(o=l.getViewportToWorld().transform(new i(-r.x,-r.y)),st||(h=a.transform(o)),l=new f(it,o,v,s,et,lt,ct,c,h,d)),l}}function yi(n){var u=this,f=n,e=2,i=p+"count",t=[{}],r;t[0][i]=0,this.get=function(n,i){for(var r,f=t.length,e=!0;f--;){if(r=t[f][n],r!==h)return i&&!e&&u.insert(n,r),r;e=!1}},this.insert=function(n,o){var a,s,l,c,v;if(a=!1,s=t[t.length-1],s[n]===h){if(s[i]<f)s[i]++;else if(s={},s[i]=0,t.push(s),t.length>e&&(l=t.shift(),r))for(c in l)c!==i&&l.hasOwnProperty(c)&&(v=l[c],v!==u.get(c)&&r(v))}else a=!0;return s[n]=o,a},this.useDisposer=function(n){r=n}}function et(n,t,i,r,u){this.nativeCamera=n,this.maxLocalZoom=i,this.minLocalZoom=0,this.tilePyramid=t,this.imageryId=r,this.copyrightProvider=u,this.needsElevation=n.getNeedsElevation()||t&&t.projectingCamera&&t.projectingCamera.getNeedsElevation()}function bt(){function kr(){var n=p.getOptions();return!(n.disablePanning||n.disableMouseInput||n.disableUserInput)}function dr(){n.invoke(s,"copyrightchanged")}function fr(n,i){var u;if(!i||!f.areEqual(e,n)){if(oi&&(n=st.adjustCameraElevation(n)),e=n,ht=n,u=!1,ur<1/t.maxFPS&&(i=!1),i&&(ht=f.snapSmallDifferences(st.adjustCameraElevation(a),e),f.areEqual(ht,e)&&(i=!1),i)){var r=new pt(o.width*1.2,o.height*1.2),h=lt.union(tt.getMercatorFootprint(ht,r)),c=lt.union(tt.getMercatorFootprint(e,r));lt.intersect(h,c)||(i=!1)}i?(at=new Date(new Date-(s.usingCssAnimation()?0:cu)),rt(),i!=!0&&(bt=i)):(at=new Date(0),g=null,yi())}}function li(t,i,u,o,h,l,a){var y,g,k,ut=p.getZoomRange(),tt=i,b=f.widthToMercatorZoom(o,t,i),ft,v,it,et,nt,w,ot,ht;for(b=Math.max(b,ut.min),b=Math.min(b,ut.max),ft=2,oi=!1;ft--;){for(g=t.toLocation(tt),v=null,it=yt.length;it--;)if(v=yt[it].getScene(d,g.latitude,g.longitude,b,h,di),v&&v.needsElevation&&(et=st.isElevationAvailableAtLatLon(g.latitude,g.longitude,b),oi=!0,et||(v=null)),v)break;if(v=v||sr,v=ti?d:v,k&&y===v)break;if(y=v,nt=y.nativeCamera,w=b-f.widthToMercatorZoom(nt.getWidth(),nt.getCrs(),nt.getLookAt()),pr&&(w=a?Math.floor(w):Math.round(w)),w=Math.min(w,y.maxLocalZoom),w=Math.max(w,y.minLocalZoom),k=y.nativeCamera.getAlignedCamera(w,i,u),r.areAlmostEqual(tt,k.getLookAt()))break;tt=k.getLookAt()}(or(oi),l&&f.areEqual(e,k)&&y===d)||(ot=y.imageryId!==d.imageryId,ht=y!==d,d=y,fr(k,l),rt(),ht&&(n.invoke(s,"scenechanged"),dr()),ot&&n.invoke(s,"imagerychanged"))}function ni(){var n=st.adjustCameraElevation(e);li(n.getCrs(),n.getLookAt(),null,n.getWidth(),vt!=null?vt:n.getHeading(),!0)}function yi(){var p,v,t,tt;if(b.cancelDispatch(yi),pi&&!vi){vi=!0;var h=!1,y=!0,c=!0,i,l;ft.processPendingUserInput(),pt.areEqual(cr,o)||(i=!0,l=!0),cr=o,tr&&(i=!0,l=!0,c=!1,tr=!1),at&&(p=a,v=gr(),e.getMercatorZoom()>ht.getMercatorZoom()?v<yu&&(y=!1):v<vu&&(y=!1),v<=1?(a=nu(v),h=!0):(t=e.getLookAt(),dt&&(t=e.getCrs().wrap(t)),t.y<0?t.y=0:t.y>1&&(t.y=1),r.areAlmostEqual(e.getLookAt(),t)||(c=!1,e=e.getAlignedCamera(0,t)),a=e,ht=e,at=null),f.areAligned(p,e)||(c=!1),i=!0),w.allowTileGridSwitch=y;var k=!nr&&i,u=nr&&!i,nt=new Date;u&&nt-wr<=br&&(u=!1,h=!0),nr=i||h,i&&(wr=nt,h=!0),f.areEqual(yr,e)||(l=!0),(l||u)&&((u||!w.canCssAnimate())&&(g=null),!s.usingCssAnimation()&&ri&&(er(),ri=!1),w.enableOrDisableCssAnimation(g,u),kt.enableOrDisableCssAnimation(g)),yr=e,w.render(o,a,d.tilePyramid,e),tt=k?0:u?2:1,kt.update(o,a,e,c,tt),l&&n.invoke(s,"targetviewchanged"),k&&n.invoke(s,"viewchangestart"),i&&n.invoke(s,"viewchange",{linear:c,userInitiated:ci}),u&&(n.invoke(s,"viewchangeend",{userInitiated:ci}),ci=!0,dr()),vi=!1,h&&rt()}}function gr(){var n=0,t;return s.usingCssAnimation()?n=g.getStartTime()<at?0:g.getElapsedTimeAsPercentage():(t=new Date,n=bt>0?Math.min(1,(t-at)/bt):(t-at)/1e3/ur),n}function nu(n){var i=a,t=0;return s.usingCssAnimation()?t=g.getProgress(n):bt>0?(n>=1&&(bt=0),t=1-Math.pow(1-n,4)):t=n<=.5?Math.pow(n*2,2)*.5:Math.pow((1-n)*2,2)*-.5+1,t>=0&&t<=1&&(i=f.lerp(ht,e,t)),i}function tu(){if(p){var n=p.getWidth(),t=p.getHeight();(o.width!==n||o.height!==t)&&(o=new pt(p.getWidth(),p.getHeight()),rt())}}function rt(){b.dispatch(yi)}function iu(n){n&&w.suspendGettingNewTiles(),ti=!0}function er(){w.allowGettingNewTiles(),ti&&(ti=!1,ni(),rt())}function ru(n){var t=n.getViewportToWorld(),r=n.getCrs(),u=uu(r.toLocation(t.transform(new i(-o.width/2,-o.height/2))),r.toLocation(t.transform(new i(o.width/2,-o.height/2))),r.toLocation(t.transform(new i(o.width/2,o.height/2))),r.toLocation(t.transform(new i(-o.width/2,o.height/2))));return u.center=new v(u.center.latitude,u.center.longitude),u}function uu(){for(var f=arguments,t,i,r,u,e,o,n,s=f.length;s--;)n=f[s],isFinite(n.latitude)&&isFinite(n.longitude)&&(t=t===h||isNaN(t)?n.latitude:Math.max(t,n.latitude),i=i===h||isNaN(i)?n.latitude:Math.min(i,n.latitude),u=u===h||isNaN(u)?n.longitude:Math.max(u,n.longitude),r=r===h||isNaN(r)?n.longitude:Math.min(r,n.longitude),isFinite(n.altitude)&&ct.isValid(n.altitudeReference)&&(o=n.altitude,e=n.altitudeReference));return ut.fromEdges(t,r,i,u,o,e)}function pu(n){return f.areEqual(n.nativeCamera,et.nativeMercatorCamera)}function fu(){var t,n;nt=p.getOptions(),ft.enableOrDisableUserInput(!0,nt),t=.9,nt.inertiaIntensity!==h&&nt.inertiaIntensity!==-1&&(t=nt.inertiaIntensity),ft.enableOrDisableInertialScrolling(nt.useInertia,t),n=nt.labelOverlay,n!==di&&it.isValid(n)&&(di=n,ni()),nt.showBackground!==h&&w.showBackground(nt.showBackground),w.setBufferSize(nt.tileBuffer)}function or(t){t?gt||(gt=n.addThrottledHandler(s,"targetviewchanged",eu,500),b.dispatch(eu)):(ou(),n.removeHandler(gt),gt=null)}function eu(){gt&&(ou(),ei=st.downloadElevationData(e,o),ei&&(ir=n.addHandler(ei,"downloaded",wu)))}function ou(){n.removeHandler(ir),ir=null,st.cancelDownload(ei)}function wu(n){tr=!n.cacheHit,ni(),rt()}var s=this,pi=!1,hu="cm"+ai.getNext(),p=null,wt=null,wi=null,bi=null,ft=null,sr=et.createMercatorScene(null,"Mercator",null),d=sr,a=d.nativeCamera,e=a,ht,vt,ti,ri,bu=k(null,u.safariRenderHack),yt=[],ui=[],di=it.visible,at,bt=0,gi=!1,g=null,o=new pt(800,600),cr,w=new su,vi;n.addHandler(w,"tiledownloadcomplete",function(){n.invoke(s,"tiledownloadcomplete")});var lr,kt=new hr,ar=!1,vr=!1,nr=!1,yr,tr=!1,fi,nt,dt=!0,pr=!0,gt,ei,ir,oi,hi,rr={Grab:"url("+t.cursorPath+"grab.cur)"+u.cursorHotspot+", move",Grabbing:"url("+t.cursorPath+"grabbing.cur)"+u.cursorHotspot+", move",SEResize:"se-resize"},cu=1e3/30,ur=.3,vu=.1,yu=.4,wr=new Date(0),br=200,ci=!0;this.activating=function(t){p=t,fi=n.addHandler(t,"resize",tu),tu()},this.activated=function(){wt=p.getModeLayer(),wi=p.getRootElement(),bi=y(wi),wt.appendChild(w.getRootElement()),lr=k("div","position:absolute;z-index:0;left:0;top:0;"+u.safariRenderHack,wt),kt.activate(p,s,w,lr,hu+"_er"),ft=new lu(s,p,new au(s,p),bi,kt,!0),fu(),n.removeHandler(hi),hi=n.addHandler(p,"optionschanged",fu),or(d.needsElevation),pi=!0,rt()},this.deactivating=function(){n.removeHandler(hi),hi=null,or(!1),n.removeHandler(fi),fi=null,ft.enableOrDisableUserInput(!1,nt),fr(e,!1),kt.deactivate(),wt.removeChild(w.getRootElement()),w.disposeTiles(),ft=null,bi=null,wi=null,wt=null,p=null,pi=!1},this.getInternalMaxZoom=function(){return t.maxMercatorZoom},this.getInternalMinZoom=function(){return t.minMercatorZoom},this.setView=function(n){var p=e.getCrs(),w,t,g=null,i=n.bounds,nt=!1,it;if(n.userInitiated===!1&&(ci=n.userInitiated),i instanceof ut){if(n.center){t=n.center;var r=i.getNorthwest(),ft=new v(t.latitude*2-r.latitude,t.longitude*2-r.longitude,r.altitude,r.altitudeReference),a=i.getSoutheast(),et=new v(t.latitude*2-a.latitude,t.longitude*2-a.longitude,a.altitude,a.altitudeReference);i=uu(r,a,ft,et)}else t=p===c?tt.getMercatorCenter(i):i.center.clone();it=si(n.padding)?new pt(Math.max(1,o.width-n.padding),Math.max(1,o.height-n.padding)):o,w=tt.locationRectToMercatorZoom(it,i),nt=!0}else n.center&&(t=n.center,g=n.centerOffset),si(n.zoom)&&(w=n.zoom);var y=!1,b=e.getLookAt(),rt=e.getWidth(),k=e.getHeading(),d=!0;t&&(b=p.fromLocation(st.toEllipsoid(t)),y=!0),si(w)&&(rt=f.mercatorZoomToWidth(w,p,b),y=!0),si(n.heading)?(k=l.normalizeDegrees(n.heading),vt=k,y=!0):vt=null,n.animate===!1&&(d=n.animate,y=!0),n.suspend!==h&&(n.suspend?iu(!0):er()),n.useCssAnimations!==h&&(gi=u.allowCssAnimations&&n.useCssAnimations),y&&(d&&s.requestCssAnimation(),li(p,b,g,rt,k,d,nt))},this.setWrapping=function(n){dt=n},this.getCenter=function(){var n=a.getCenter();return new v(n.latitude,n.longitude)},this.getZoom=function(){return a.getMercatorZoom()},this.getHeading=function(){return a.getHeading()},this.getRequestedHeading=function(){return vt},this.getBounds=function(){return ru(a)},this.getMetersPerPixel=function(){return a.getMetersPerPixel()},this.getTargetCenter=function(){var n=e.getCenter();return new v(n.latitude,n.longitude)},this.getTargetZoom=function(){return e.getMercatorZoom()},this.getTargetHeading=function(){return e.getHeading()},this.getTargetBounds=function(){return ru(e)},this.getTargetMetersPerPixel=function(){return e.getMetersPerPixel()},this.tryLocationToViewport=function(n,t){return this.internalTryLocationToViewport(a,n,t&&t.referenceLocation)},this.tryViewportToLocation=function(n,t){return this.internalTryViewportToLocation(a,n,!0,!t||t.normalizeLongitude!==!1)},this.internalTryLocationToViewport=function(n,t,i){var u,f,o=n.getCrs(),s=n.getWorldToViewport(),y=n.getDistanceInverse()<ot,a=!n.getNeedsElevation(),c=n.getLookAt();if(t.latitude!==h)return u=o.fromLocation(st.toEllipsoid(t,a)),dt&&(u=o.wrap(u,c)),f=s.transform(u),y||f.z>=-1&&f.z<=1?f:null;var e=t.length,l=new Array(e),p=null;if(!n.getPerspectiveOrigin().isZero()){var w=n.getViewportToWorld(),b=new r(0,n.getZoomOriginWidth()*6,0),v=w.transform(b),k=v.x*s.m14+v.y*s.m24+v.z*s.m34+s.m44;p=k}for(i&&(u=o.fromLocation(st.toEllipsoid(i,a)),dt&&(c=i=o.wrap(u,c)));e--;)u=o.fromLocation(st.toEllipsoid(t[e],a)),dt&&(u=o.wrap(u,c)),c=i||u,f=s.transform(u,p),l[e]=y||f.z>=-1&&f.z<=1?f.toPoint():null,l[e]&&(l[e].shouldUseMoveTo=t[e].shouldUseMoveTo);return l},this.internalTryViewportToLocation=function(n,t,i,u){var s=n.getCrs(),h=n.getViewportToWorld(),f,e,o,c;if(ki(t)){for(o=t.length,c=new Array(o);o--;)f=h.transform(t[o]),i&&(f=st.rayToGround(s,f,h.transform(new r(t[o].x,t[o].y,1)))),e=s.toLocation(f),e=new v(e.latitude,u!==!1?v.normalizeLongitude(e.longitude):e.longitude),c[o]=s.toLocation(f);return c}return f=h.transform(t),i&&(f=st.rayToGround(s,f,h.transform(new r(t.x,t.y,1)))),e=s.toLocation(f),new v(e.latitude,u!==!1?v.normalizeLongitude(e.longitude):e.longitude)},this.isDownloadingTiles=function(){return w.isDownloadingTiles()},this.getTileDownloadMetrics=function(){return w.getTileDownloadMetrics()},this.getImageryId=function(){return d.imageryId?d.imageryId:""},this.isRotationEnabled=function(){return d.imageryId==="EnhancedBirdseye"||d.imageryId==="NativeBirdseye"},this.isMercator=function(){return pu(d)},this.getCopyrights=function(n){return n&&d.copyrightProvider?d.copyrightProvider.getCopyrights(s.getBounds(),a.getMercatorZoom(),a.getHeading(),n):n&&n([]),[]},this.setSceneContributors=function(t){for(var i=ui.length;i--;)n.removeHandler(ui[i]);for(ui.length=0,i=t.length,yt.length=i;i--;)yt[i]=t[i],ui.push(n.addHandler(yt[i],"newsceneavailable",ni));yt.sort(function(n,t){return n.priority-t.priority}),rt(),ni()},vi=!1,this.ensureUpdateDispatched=function(n){n?yi():rt()},this.getTargetCamera=function(){return e},this.getCurrentCamera=function(){return a},this.getCameraAnimationDuration=function(){return ur},this.setAlignedCamera=function(n,t,i,r,u,f,e){vt=null,li(n,t,i,r,u,f,e)},this.setCamera=function(n,t){fr(n,t)},this.allowSceneChanges=function(){er()},this.suspendSceneChanges=function(n){iu(n)},this.requestCssAnimation=function(n){return gi&&(ri=n,g=n?ii.Flicker:ii.Transformer,g=g.duplicate(),g.isFlick=n),g},this.canUseCssAnimations=function(){return gi},this.usingCssAnimation=function(){return g!=null},this.haltCssAnimation=function(){if(s.usingCssAnimation()){var t=gr(),n=nu(t);ri=!1,li(n.getCrs(),n.getLookAt(),null,n.getWidth(),n.getHeading(),!1)}},this.getCursors=function(){var n="default";return{Grab:kr()?rr.Grab:n,Grabbing:kr()?rr.Grabbing:n,SEResize:rr.SEResize}},this.getPublicApi=function(){return{tryPixelToMercatorPoint:function(n){return s.getTargetCamera().getViewportToWorld().transform(n)},setViewChangeEndDelay:function(n){var n=parseInt(n);n>=0&&(br=n)},canReprojectTileLayers:function(){return u.animateOverlayLayers},enableOrDisableZoomLevelSnap:function(n){pr=n===!0,ft.setTouchZoomThreshold(n===!0?.1:0)},setPartialZoomBias:function(n){w&&w.setPartialZoomBias(Math.min(.5,Math.max(-.5,n)))},setOptions:function(t){var i=!1;t&&(typeof t.shouldClipPolygons=="boolean"&&(vr=t.shouldClipPolygons,i=!0),typeof t.drawShapesInSingleLayer=="boolean"&&(ar=t.drawShapesInSingleLayer,i=!0),i&&n.invoke(p,"modeoptionschanged"))},setDrawShapesInSingleLayer:function(n){this.setOptions({drawShapesInSingleLayer:n})},getDrawShapesInSingleLayer:function(){return ar},getShouldClipPolygons:function(){return vr}}}}function at(n,t,i,r){function c(n){return((s*n+e)*n+u)*n}function l(n){return((h*n+o)*n+f)*n}function a(n){return(3*s*n+2*e)*n+u}function v(n,t){for(var r,u,i=n,f=0;f<9;f++){if(r=c(i)-n,u=a(i),Math.abs(r)<t||Math.abs(u)<1e-6)break;i=i-r/u}return i}var y=this;this.cssText="cubic-bezier("+n+","+t+","+i+","+r+")";var u=3*n,f=3*t,e=3*(i-n)-u,o=3*(r-t)-f,s=1-u-e,h=1-f-o;this.getProgress=function(n,t){return l(v(n,t))}}function ku(n,t,i,r){this.animationSequence=n,this.node=t,this.isComplete=i,this.nodeHasPendingAnimations=r}function ou(n,t){this.url=n,this.timeout=t}function kt(n,t,i,r,u,f,e,o,s,h,c){var v=l.ceilLog2(Math.max(n,t)),a;this.getWidth=function(){return n},this.getHeight=function(){return t},this.getTileWidth=function(){return i},this.getTileHeight=function(){return r},this.getTileOverlap=function(){return u},this.getTileBorder=function(){return f},this.getOffsetX=function(){return e},this.getOffsetY=function(){return o},this.getMaxLevelOfDetail=function(){return v},this.getUrl=s,this.getReplacementTileId=h,a=c?c:7e3,this.getDownloadTimeout=function(){return a}}function sr(r,o,s){function or(){if(nt&&nt.length){for(var t=nt.length;t--;)n.removeHandler(nt[t]),bi.removeDownloadBasket(nt[t]);nt=null}}function sr(){var fr=Math.round((c.x+y.x)/2),sr=Math.round((c.y+y.y)/2),l=[],lt=k(),ai,i,pt,e,b,vi,wt,kt,yi,r,f,o,pi,s,tr,hi,ci,br,ur,kr;for(yt=0,ti=0,ut=[],dt=[],gt={},or(),nt=[],wt=0,kt=0,r=c.y;r<=y.y;r++){wt=0,yi=!1;var hr=ot&&ot.y<=r&&st&&st.y>=r,dr=r>=ct.y&&r<=at.y,vr=r>=ft.y&&r<=et.y;for(f=c.x;f<=y.x;f++){ai=new rt(c.levelOfDetail,f,r),i=null;var yr=ot&&ot.x<=f&&st&&st.x>=f,gr=f>=ct.x&&f<=at.x,pr=f>=ft.x&&f<=et.x,ui=!1,wr=!1;!si||yr&&hr||pr&&vr||(wr=!0),e=a.getUrl(ai,ii),e&&!wr&&(b=bi.getState(e),b!=vt.failed||ei?(o=gi,pi=0,f===0&&(o-=tt,o+=it,pi=-it),f===ir&&(o-=tt,o+=it),s=nr,tr=0,r===0&&(s-=tt,s+=it,tr=-it),r===rr&&(s-=tt,s+=it),i=k("img"),pt="width:"+o+"px;height:"+s+"px;border:0px;",ri.requireFlowLayout?(wt&&(pt+="margin-left:"+wt*d+"px;"),kt&&(pt+="margin-top:"+kt*g+"px;")):(hi=(f-c.x)*d+pi,ci=(r-c.y)*g+tr,i[p+"leftOffset"]=hi,i[p+"topOffset"]=ci,pt+="position:absolute;",pt+=u.useTransform3d?w.Attributes.transform+":translate3d("+hi+"px,"+ci+"px,0px);":"left:"+hi+"px;top:"+ci+"px"),i.style.cssText=pt,i[p+"tileId"]=ai,i[p+"tileUrl"]=e,i[p+"tileHeight"]=s,i[p+"tileWidth"]=o,i.width=o,i.height=s,i.border=0,ei&&b==vt.failed&&(i=lr(i),ui=i!=!1,i&&(e=i[p+"tileUrl"],b=bi.getState(e))),i&&(b===vt.ready||b===vt.cacheExpired&&(yr&&hr||ui)?(br=pr&&!gr&&vr&&!dr,!br||si||ui?i.src=e:(i.style.visibility="hidden",dt.push(i))):(i.style.visibility="hidden",ut.push(i)),b!=vt.ready&&(vi=new ou(e,er),vi.priority=(fr-f)*(fr-f)+(sr-r)*(sr-r),l.push(vi)),wi.push(i))):v.isOverlay||ti++,yt++),i||ui?(wt=0,yi=!0,i&&(ui?ar(i,lt):lt.appendChild(i))):wt++}yi?(kt=0,ri.requireFlowLayout&&k("br",null,lt)):kt++}if(u.useImageDisposer)for(ur=bt.length;ur--;)bt[ur].src=t.spacerImageUrl;bt.length=0,kr=bt,bt=wi,wi=kr,(u.useTransform3d||u.useTransform2d)&&(fi=this.hideWhileAnimating?ri.setExactTransformOrHide(ht,ni,v.opacity):ri.setTransformAndOpacity(ht,ni,v.opacity,{explicitOpacity:!0})),lt.style.cssText=fi,h.parentNode&&h.parentNode.replaceChild(lt,h),h=lt,oi(),li&&l.length&&(l.basketId=v,l.sort(yu),di+=l.length,nt.push(n.addHandler(l,"hasnewtiles",cr)),bi.setDownloadBasket(l,ii)),ki()}function ki(){dt.length&&b.dispatch(hr),n.invoke(v,"tilesrendered")}function hr(){var t,n;if(b.cancelDispatch(hr),v.allowTileRender)for(t=Math.min(dt.length,vr);t--;)n=dt.shift(),n.style.visibility="visible",n.src=n[p+"tileUrl"];ki()}function cr(){var f;if(li){for(var r=ut.length,u=!0,t=[];r--&&u;){var e=!0,i=ut[r],o=i[p+"tileUrl"],s=bi.getState(o);switch(s){case vt.ready:dt.push(i);break;case vt.failed:ri.requireFlowLayout?u=!1:(h.removeChild(i),yr(i,t));break;default:e=!1}e&&ut.splice(r,1)}u?(ki(),t.length&&(f=n.addHandler(t,"hasnewtiles",cr),nt.push(f),t.basketId=f,bi.setDownloadBasket(t,ii))):sr()}}function yr(n,t){if(!ei){ti++;return}var i=lr(n);i&&(i.style.visibility="hidden",ut.push(i),bt.push(i),t.push(new ou(i[p+"tileUrl"],er)),ar(i,h))}function lr(n){var r=n[p+"tileId"],h=r.toString(),c=gt[h]?gt[h]:1,i=a.getReplacementTileId(n[p+"tileId"]),l=a.getUrl(i,ii),t=!1,f;if(l){if(f=i.toString(),gt[f])t=null;else{var e=Math.pow(2,r.levelOfDetail-i.levelOfDetail),v=n[p+"tileWidth"],y=n[p+"tileHeight"],o=v*e,s=y*e,w=(i.x*e-r.x)*v+n[p+"leftOffset"],b=(i.y*e-r.y)*y+n[p+"topOffset"];t=k("img"),t[p+"leftOffset"]=w,t[p+"topOffset"]=b,t[p+"tileHeight"]=s,t[p+"tileWidth"]=o,t[p+"tileId"]=i,t[p+"tileUrl"]=l,t[p+"lod"]=i.levelOfDetail,t.style.cssText="position:absolute;left:"+w+"px;top:"+b+"px;width:"+o+"px;height:"+s+"px;border:0px;"+u.safariRenderHack,t.width=o,t.height=s,t.border=0,gt[f]=0}gt[f]+=c}else ti+=c;return t}function ar(n,t){for(var i=t.firstChild,u=n[p+"tileId"],r;i;){if(r=i[p+"lod"],!r||r>=u.levelOfDetail){t.insertBefore(n,i);break}i=i.nextSibling}i||t.appendChild(n)}var v=this,ui,oi;var h=k(),c,y,ft,et,ct,at,ot,st,si=!1,hi=0,ci,ni,fi="",di=0,yt=0,ti=0,ei=!1,li=!0,a=r,d,g,tt,it,gi,nr,wt,ai,vi,tr,ir,rr,yi,pi,ht=e.identity(),ur,fr,bt=[],wi=[],ut=[],dt=[],gt={},nt,vr=3,ii,er=a.getDownloadTimeout();this.levelOfDetail=o,this.opacity=1,this.isOverlay=!1,this.hideWhileAnimating=!1,this.allowTileRender=!0,d=a.getTileWidth(),g=a.getTileHeight(),tt=a.getTileOverlap(),it=a.getTileBorder(),gi=d+2*tt,nr=g+2*tt,ui=Math.pow(2,a.getMaxLevelOfDetail()-o),wt=Math.ceil(a.getWidth()/ui),ai=Math.ceil(a.getHeight()/ui),wt=Math.ceil(wt),ir=Math.ceil(wt/d)-1,rr=Math.ceil(ai/g)-1,vi=e.multiply(a.projectingCamera.getWorldToFrustum(),e.scaling(wt),e.translation(wt/2+a.getOffsetX()/ui,ai/2+a.getOffsetY()/ui,0)),tr=vi.invert(),s&&(ii=!0),this.populate=function(n,t,r,u){var s,h,w,b;if(!f.areEqual(n,ur)||!pt.areEqual(t,fr)||hi!=r){ur=n,fr=t;var l=e.multiply(n.getViewportToWorld(),vi),a=Math.ceil(t.width/2),v=Math.ceil(t.height/2),p=lt.union(l.transform(new i(-a,-v)),l.transform(new i(a,-v)),l.transform(new i(a,v)),l.transform(new i(-a,v)));s=new rt(o,Math.floor(p.x/d),Math.floor(p.y/g)),h=new rt(o,Math.floor(p.getRight()/d),Math.floor(p.getBottom()/g)),(!ct||!at||r>hi||ct.x>s.x||ct.y>s.y||at.x<h.x||at.y<h.y)&&(yi=null,si=u,hi=r,ct=s,at=h,ot=ft,st=et,ft=s.clone(),ft.x-=r,ft.y-=r,et=h.clone(),et.x+=r,et.y+=r,c=ft.clone(),y=et.clone(),u&&(c.x=Math.min(ot.x,c.x),c.y=Math.min(ot.y,c.y),y.x=Math.max(st.x,y.x),y.y=Math.max(st.y,y.y)),ci=e.multiply(e.translation(c.x*d,c.y*g,0),tr),w=y.x-c.x+1,b=y.y-c.y+1,ni=new pt(w*d,b*g),sr())}},this.render=function(n,t){var i,r,o;f.areEqual(n,yi)&&pi===v.opacity||(ht=e.multiply(ci.projectOnPlane(n.getGroundPlane()),n.getWorldToViewport()),t&&(ht.offsetX+=t,ht.offsetY+=t),i={explicitOpacity:!this.hideWhiteAnimating},r=this.hideWhileAnimating?ri.setExactTransformOrHide:ri.setTransformAndOpacity,u.useTransform3d||u.useTransform2d?(i.includeCommonCss=!1,i.returnStyleObject=!0,o=r(ht,ni,v.opacity,i),h.style[w.Properties.transform]=o[w.Properties.transform],v.opacity!=pi&&(h.style.opacity=v.opacity)):(fi=r(ht,ni,v.opacity,i),h.style.cssText=fi),oi()),pi=v.opacity,yi=n},this.getRootElement=function(){return h},this.getTilePyramid=function(){return a},this.getDownloadProgress=function(){return yt>0&&ut?1-ut.length/yt:1},this.getTileDownloadMetrics=function(){return di},this.getNoImageTileRatio=function(){return yt>0?ti/yt:0},this.enableOrDisableScaledTiles=function(n){ei=n&&!ri.requireFlowLayout&&!it&&!tt&&typeof a.getReplacementTileId=="function"},this.stopDownloading=function(){li=!1,bi.removeDownloadBasket(v)},this.dispose=function(){v.stopDownloading(),or(),h&&h.parentNode&&(u.isIE8OrEarlier&&(h.innerHTML=""),h.parentNode.removeChild(h))},oi=function(){},u.useFilterReflowWorkaround&&ri.usingIEFilters&&(oi=function(){h.offsetWidth})}function su(){function lt(n,t,i){return n&&n.getTilePyramid()===t&&n.levelOfDetail===i}function c(t){if(t){if(g!=null){var i=t.getRootElement();g.removeAnimations(i)}n.removeHandler(t.rendererHandler),t.dispose()}}function gt(){c(r),r=null,c(o),o=null,e=s.none}function tt(){var lt,t,f,dt,gt,k;b.cancelDispatch(tt);var l,pt=!1,bt=!1,ot=!1,ii=e>s.none,ni=!1,w=e===s.readyForTarget?a:it;for(d?ft&&(ht||(lt=si(),pt=lt.keepGoing,ot=lt.gridsAdded,ni=lt.shouldSwapTileGrids),kt&&hi()):(c(i),i=null,c(o),o=null,c(nt),nt=null,c(v),v=null,c(p),p=null),e<s.started&&(i&&(i.getDownloadProgress()<1&&(bt=!0),i.render(w)),o&&o.render(w),nt&&nt.render(w),r&&ii&&(r.render(w),ri(r)),v&&v.render(w,1),p&&p.render(w,1)),e===s.readyForTarget&&(r&&g.addToGroup(r.getRootElement()),i&&g.addToGroup(i.getRootElement()),v&&g.addToGroup(v.getRootElement()),p&&g.addToGroup(v.getRootElement()),i&&r&&rt.addToGroup(r.mercatorZoom>i.mercatorZoom?r.getRootElement():i.getRootElement())),ni&&(ui(r),ti(),i.mercatorZoom>o.mercatorZoom?(y(i.getRootElement()).set_style({opacity:1}),i.opacity=1):(y(o.getRootElement()).set_style({opacity:0}),o.opacity=0),rt.applyAllAnimations()),l=h.length;l--;)t=h[l],t.havePendingDownloads=!1,f=t.tileGrid,dt=sr.getBestLevelOfDetail(a,t.tilePyramid,ct),k=t.tilePyramid.projectingCamera,gt=a.getHeading()!==k.getHeading()||a.getPitch()!==k.getPitch()||a.getRoll()!==k.getRoll()||a.getDistanceInverse()!==k.getDistanceInverse(),f&&(f.levelOfDetail!==dt||gt&&!u.animateOverlayLayers)&&(!t.tempDisplayGrid&&u.animateOverlayLayers?(t.tempDisplayGrid=f,t.swapping=null):f.dispose(),f=null),ft&&(!gt||u.animateOverlayLayers)&&e<s.readyForTarget&&(f||(f=wt(t.tilePyramid,dt,t.lowPriority),f.isOverlay=!0,f.hideWhileAnimating=t.animation==="s"?!1:t.animation==="h"?!0:u.animateOverlayLayers?!1:!0,f.opacity=t.opacity,ot=!0),f.populate(a,ut,et)),(f||t.tempDisplayGrid)&&(t.tempDisplayGrid?t.swapping&&f?((t.swapping!=f||ot||st)&&at(f,l),t.tempDisplayGrid.dispose(),t.tempDisplayGrid=null,t.swapping=null):(f&&e===s.allowed&&at(f,l),ei(f,t.tempDisplayGrid,.85)&&(e===s.none&&at(f,l),t.swapping=f,pt=!0)):(ot||st)&&at(f,l)),f&&(e<s.started&&f.render(w),e===s.readyForTarget&&g.addToGroup(f.getRootElement()),e>s.allowed&&(t.tempDisplayGrid?ri(f):ui(f)),f.getDownloadProgress()<1&&(t.havePendingDownloads=!0)),t.tempDisplayGrid&&(e<s.started&&t.tempDisplayGrid.render(w),e===s.readyForTarget&&g.addToGroup(t.tempDisplayGrid.getRootElement())),t.tileGrid=f;for(st=!1,!bt&&yt&&n.invoke(vt,"tiledownloadcomplete"),yt=bt,l=h.length;l--;)t=h[l],!t.havePendingDownloads&&t.hadPendingDownloadsLastUpdate&&t.tileLayer&&n.invoke(t.tileLayer,"tiledownloadcomplete"),t.hadPendingDownloadsLastUpdate=t.havePendingDownloads;pt&&b.dispatch(tt,10),nt&&a.getWidth()/it.getWidth()>.95&&(c(nt),nt=null)}function si(){var n=!1,v=!1,y=!1,b=f.areAligned(a,it)&&a.getWidth()===it.getWidth(),h=sr.getBestLevelOfDetail(a,d,ct),u=e>s.none,p;return lt(i,d,h)?e<s.readyForTarget&&(c(r),r=null,p=b&&!u,i.populate(p?it:a,ut,et,u),o&&!u&&(v=ci())):(e<s.readyForTarget&&(lt(r,d,h)||(c(r),r=wt(d,h),r.enableOrDisableScaledTiles(!0),r.mercatorZoom=d.projectingCamera.getMercatorZoom()+l.log2(d.projectingCamera.getWidth()/a.getWidth())),r.populate(a,ut,et)),i==null?(i=r,r=null,w.appendChild(i.getRootElement()),n=!0):r!=null&&(c(o),o=null,i.opacity=1,c(nt),nt=null,e===s.allowed&&(ni(),n=!0),vt.allowTileGridSwitch&&(!ot||r.getDownloadProgress()>.7)&&(!u||e>s.allowed)&&(r.getNoImageTileRatio()>.5?(c(r),r=null,ht=!0):u?y=!0:ot&&bt>1/t.maxFPS?(ni(),ti(),n=!0):(w.insertBefore(r.getRootElement(),i.getRootElement()),c(i),i=r,r=null,n=!0),o&&o.stopDownloading(),_lastTileGridBlendOn=new Date))),{keepGoing:v,gridsAdded:n,shouldSwapTileGrids:y}}function hi(){var i=e>s.none,n=oi[sr.getBestLevelOfDetail(a,d,ct)],t=new pt(ut.width*dt,ut.height*dt);lt(v,d,n)?e<s.readyForTarget&&v.populate(a,t,0):(p||(p=wt(d,n,!0),p.populate(a,t,0),w.childNodes[0]?w.insertBefore(p.getRootElement(),w.childNodes[0]):w.appendChild(p.getRootElement())),v?ei(p,v,.9)&&(c(v),v=p,p=null,lt(v,d,n)||b.dispatch(tt)):(v=p,p=null))}function ci(){var t=!1,r=(_lastTileGridBlendOn?new Date-_lastTileGridBlendOn:0)/1e3,n=r/bt;return i.mercatorZoom>o.mercatorZoom?(i.opacity+=n,o.opacity=1,i.opacity>=1||n>=.5?(i.opacity=1,c(o),o=null):t=!0):(o.opacity-=n,i.opacity=1,o.opacity<=0||n>=.5?(c(o),o=null):t=!0),_lastTileGridBlendOn=new Date,t}function ni(){r&&i&&(r.mercatorZoom>i.mercatorZoom?(i.getRootElement().nextSibling==null?w.appendChild(r.getRootElement()):w.insertBefore(r.getRootElement(),i.getRootElement().nextSibling),r.opacity=0):(w.insertBefore(r.getRootElement(),i.getRootElement()),r.opacity=1))}function ti(){o=i,i=r,r=null}function wt(t,i,r){var u=new sr(t,i,r);return u.rendererHandler=n.addHandler(u,"tilesrendered",li),u}function li(){b.dispatch(tt,10)}function ri(n){if(n){var t=n.getRootElement();t.style.left="-10000px",t.style.top="-10000px"}}function ui(n){if(n){var t=n.getRootElement();t.style.left="0px",t.style.top="0px"}}function at(n,t){if(h[t].tempDisplayGrid){w.insertBefore(n.getRootElement(),h[t].tempDisplayGrid.getRootElement());return}for(var i=t+1;i<h.length;){if(h[i].tempDisplayGrid){w.insertBefore(n.getRootElement(),h[i].tempDisplayGrid.getRootElement());break}else if(h[i].tileGrid){w.insertBefore(n.getRootElement(),h[i].tileGrid.getRootElement());break}i++}i>=h.length&&w.appendChild(n.getRootElement())}function fi(){st=!0,h.sort(function(n,t){return n.zIndex-t.zIndex})}function ei(n,t,i){return n&&n.getDownloadProgress()>i&&(n.mercatorZoom<=t.mercatorZoom||a.getWidth()/it.getWidth()>.9)}var vt=this,bt=.5,ot=!0,i=null,o=null,r=null,v=null,p=null,oi=[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11,11,11,14,14,14,17,17,17,20,20,20,23,23,23,23],kt=u.animateOverlayLayers,dt=u.isIOSBrowser?2:4,w=k();w.style.cssText="position:absolute;z-index:0;left:0;top:0;"+u.safariRenderHack;var d,a,it,ut,h=[],st=!0,yt=!1,ft=!0,et=0,ht=!1,nt,ct=0,e=s.none,g=null,rt=null;this.allowTileGridSwitch=!0,this.render=function(n,t,i,r,u){r!=a&&(ht=!1),i!==d&&(yt=!0,ht=!1),ot=u!=null?u:ot,ut=n,d=i,it=t,a=r,tt(),e>s.none&&e<s.started&&(e==s.readyForTarget&&g.applyAllAnimations(),e++)},this.getBaseTilePyramid=function(){return d},this.enableOrDisableCssAnimation=function(t,i){var r=t!=null,u;(r||e!==s.none)&&(g||(g=new iu,rt=new iu,rt.manageAnimations([ii.TileFader.duplicate()]),u=function(n){n.hasPendingAnimations()?e=s.pendingCompletion:gt()},n.addHandler(g,"animationscomplete",function(){u(rt)}),n.addHandler(rt,"animationscomplete",function(){u(g)})),e>s.none&&(g.removeAllAnimations(),(!i||r)&&(rt.removeAllAnimations(),gt())),r&&vt.canCssAnimate()&&(g.manageAnimations([t]),e=t.isFlick?s.readyForTarget:s.allowed))},this.canCssAnimate=function(){return i&&d?!0:!1},this.addOverlay=function(n,t,i){var r=ai.getNext();return h.push({id:r,tilePyramid:n,zIndex:t.getZIndex(),opacity:t.getOpacity(),animation:t.getAnimation(),tileLayer:t,havePendingDownloads:!1,hadPendingDownloadsLastUpdate:!0,lowPriority:i}),fi(),b.dispatch(tt,10),r},this.removeOverlay=function(n){for(var i,t=h.length;t--;)if(h[t].id===n){i=h[t].tileGrid,i&&i.dispose(),h[t].tempDisplayGrid&&(h[t].tempDisplayGrid.dispose(),h[t].tempDisplayGrid=null),h.splice(t,1),b.dispatch(tt,10);break}},this.updateOverlay=function(n,t,i){var r,u;for(_overlaysUpdated=!0,r=h.length;r--;)if(h[r].id===n){u=h[r],u.opacity=i,u.zIndex!==t&&(u.zIndex=t,fi()),h[r].tempDisplayGrid&&(h[r].tempDisplayGrid.dispose(),h[r].tempDisplayGrid=null),b.dispatch(tt,10);break}},this.suspendGettingNewTiles=function(){ft=!1,c(r),r=null,c(o),o=null,c(nt),nt=null,i&&(i.opacity=1,i.allowTileRender=!1)},this.allowGettingNewTiles=function(){i&&(i.allowTileRender=!0),ft||(ft=!0,b.dispatch(tt,10))},this.disposeTiles=function(){b.cancelDispatch(tt),c(r),r=null,c(o),o=null,c(nt),nt=null,c(i),i=null,c(v),v=null,c(p),p=null;for(var n,t,u=h.length;u--;)n=h[u],t=n.tileGrid,t&&(t.dispose(),n.tileGrid=null)},this.showBackground=function(n){n!==null&&(kt=n,n||(c(v),v=null,c(p),p=null))},this.setBufferSize=function(n){n=Math.max(0,Math.min(4,n)),n!=et&&(et=n,b.dispatch(tt))},this.getRootElement=function(){return w},this.setPartialZoomBias=function(n){ct=n},this.isDownloadingTiles=function(){return r&&r.getDownloadProgress()<1||i&&i.getDownloadProgress()<1},this.getTileDownloadMetrics=function(){var n=0;return n+=i?i.getTileDownloadMetrics():0,n+(r?r.getTileDownloadMetrics():0)}}function hr(){function oi(n){et(n.collection,n.entity,!0,!1,p.last)}function si(n){it(n.entity,!0,!1),gt(n.entity)}function hi(n){et(n.collection,n.entity,!0,!1,p.last)}function ci(){et(null,h,!1,!0,p.last)}function o(t,u,f,e){var s,h,c;t||(t=ei.getEntityForTarget(f.target)),t&&(s=t.entity,s.trueEntity&&o({entity:s.trueEntity,type:t.type},u,f,e),n.hasHandler(s,u)&&(e&&f.touches&&f.touches[0]&&(h=new i(f.touches[0].pageX,f.touches[0].pageY)),h||(h=y.Screen.get_mouse_pos(f)),c=new vi(r,t.type,s,u,h.x,h.y,0,e,f),n.invoke(s,u,c)))}function ai(n,i){var r=i[t],u=r&&r.dom;if(u)try{u.focus()}catch(f){}}function et(n,i,o,l,y){var hi,ci,ki,gt,ti,li,ii,at,g,ei,ai,lt,bi,di,ni,tr,ir,d,rr,ot,rt,dt,ht;if(a)if(hi=!1,ci=r.getTheme(),ci&&(ki=i[nt]=i[nt]||{},gt=ci._preRenderEntity(i,ki,{updateEntity:o,themeReferenceKey:nt}),gt&&gt!==i&&(gt.trueEntity=i,i=gt)),ti=bt.getEntityRenderer(r,i),ti)li={entityCollection:n,rootDom:h[t].shape,rootOffsetLeft:h[t].offsetLeft,rootOffsetTop:h[t].offsetTop,parentDom:n[t].shape,parentOffsetLeft:n[t].offsetLeft,parentOffsetTop:n[t].offsetTop,parentVisible:wi(n),parentRemoved:!1,update:o,linear:l,animationStart:y===p.first,animationEnd:y===p.last,currentBounds:b,actualBounds:ui,viewportSize:a,customRenderer:c},ti.shouldDraw(i,li)?(ii=ti.update(i,li),ii&&fi(ii,{entity:i,type:ii.type})):it(i,!0,o);else if(i instanceof gi){d=i[t],d?(at=d.root,g=d.shape):(at=k(null,u.safariRenderHack),g=k(null,u.safariRenderHack+";position:absolute;"),at.appendChild(g),d={root:at,shape:g,offsetTop:0,offsetLeft:0},i[t]=d,hi=!0,o=!0),o&&(ei="position:absolute;pointer-events:none;",i.getVisible()||(ei+="display:none;"),pi(n,i),ai=i.getZIndex(),typeof ai=="number"&&(ei+="z-index:"+ai+";"),at.style.cssText=ei+u.safariRenderHack);var wt,oi=d.lookAt,vi=!1,si=!1;for(l&&oi?(lt=f==s.readyForTarget?vt.getWorldToViewport().transform(oi):st.getWorldToViewport().transform(oi),yt&&d.harmony||!(Math.abs(lt.x)>1e4||Math.abs(lt.y)>1e4)?f<s.started&&(bi=e.translation(lt.x,lt.y,0),u.useTransform3d&&!u.isIOS3?(di=ri.setTransformAndOpacity(bi,null,1,{excludeCommonCss:!0,returnStyleObject:!0}),g.style[w.Properties.transform]=di[w.Properties.transform]):(wt=ri.setTransformAndOpacity(bi,null,1,{excludeCommonCss:!u.isIOS3}),u.isIOS3||(wt="position:absolute;"+wt),g.style.cssText=wt),d.offsetLeft=lt.x,d.offsetTop=lt.y):(vi=!0,si=!0,l=!1)):vi=!0,vi&&f<s.started&&(wt="position:absolute;",d.lookAt=st.getLookAt(),d.offsetLeft=0,d.offsetTop=0,g.style.cssText=wt),l&&oi&&f==s.readyForTarget&&ut.addToGroup(g),g.harmony&&!pt.areEqual(d.previousSize,a)&&(ni=g.harmony,ni.style.width=a.width+"px",ni.style.height=a.height+"px",ni.style.left=-(a.width/2)+"px",ni.style.top=-(a.height/2)+"px",d.previousSize=a),hi&&n[t].root.appendChild(at),si&&g.harmony&&g.harmony.style&&(g.harmony.style.display="none"),tr=i.getLength(),ot=0;ot<tr;ot++)et(i,i.get(ot),o,l&&!si,y);si&&setTimeout(function(){g&&g.harmony&&g.harmony.style&&(g.harmony.style.display="block")},1)}else if(i instanceof nr)ir=i.getVisible()&&(c||b.contains(i.getLocation())||i[t]&&i[t].dragging),ir?yi(n,i,o,l):it(i,!0,o);else if(i instanceof ar)if(n.getVisible()){if(d=i[t],d||(d={},i[t]=d),o||!d.added||v.getBaseTilePyramid()!==ct){for(d.added=!1,ct=v.getBaseTilePyramid(),rr=ct?ct.projectingCamera:ft.mercator,ot=tt.length;ot--;)ht=tt[ot][0],d[ht]&&(v.removeOverlay(d[ht]),d[ht]=null),i.getVisible()&&ft[ht]===rr&&(rt=i.getTileSource(ht),rt&&(dt=kt.createQuadKeyTilePyramid(rt.getWidth(),rt.getHeight(),rt.getUriConstructor(),tt[ot][1],null,i.getDownloadTimeout()),dt.projectingCamera=ft[ht],d[ht]=v.addOverlay(dt,i,i.getTileDownloadPriority()===er.low),d.added=!0));!d.added&&i.getVisible()&&i.getReproject()&&(rt=i.getTileSource("mercator"),rt&&(dt=kt.createQuadKeyTilePyramid(rt.getWidth(),rt.getHeight(),rt.getUriConstructor(),tt[0][1],null,i.getDownloadTimeout()),dt.projectingCamera=ft.mercator,d[ht]=v.addOverlay(dt,i,i.getTileDownloadPriority()===er.low)),d.added=!0)}}else it(i,!0,o)}function dt(n,t,i){if(u.isIE9OrEarlier)switch(t){case"keydown":if(n.onkeydown)throw"onkeydown is already associated with a handler";else n.onkeydown=i;break;case"focus":if(n.onfocus)throw"onfocus is already associated with a handler";else n.onfocus=i;break;case"blur":if(n.onblur)throw"onblur is already associated with a handler";else n.onblur=i;break;default:throw"keydown,focus,blur are the only supported events.";}else y(n).add_event(t,i)}function yi(i,r,o,h){var a,v,d,g,nt,ht,b,tt,w,ft,ct,p,et,pt,ot,wt,bt,kt,it,rt,gt;if(i[t]){if(v=r[t],v?(o=v.updateEntity||o,v.updateEntity=!1):(a=k("a",u.safariRenderHack),a[l]={entity:r,type:ni.pushpin},v={dom:a,dragAttached:!1,offsetTop:0,offsetLeft:0},r[t]=v,d=r.trueEntity||r,g=n.getHandlers(r,"focus"),g&&g.length>0&&(a.trueEntity=d,dt(a,"focus",function(n){for(var t=0;t<g.length;t++)g[t].handler.call(null,n)})),nt=n.getHandlers(r,"blur"),nt&&nt.length>0&&(a.trueEntity=d,dt(a,"blur",function(n){for(var t=0;t<nt.length;t++)nt[t].handler.call(null,n)})),a.$hasKeyDown||(dt(a,"keydown",function(n){if(n&&n.keyCode&&n.keyCode===9){var t=d.getInfobox();t&&t.getVisible()&&t.receiveFocus({nativeEvent:n,forwardFocus:!n.shiftKey})}}),a.$hasKeyDown=!0),n.hasHandler(d,"focusreceived")||n.addHandler(d,"focusreceived",function(n){ai(n,r)}),o=!0),a=v.dom,a[l]||(a[l]={entity:r,type:ni.pushpin}),a.onclick==null&&(a.onclick=function(){return!1}),a.href||(a.href="#"),o&&(ht=r.getHtmlContent(),ht?(a.innerHTML=ht,v.isHtmlContent=!0,v.icon=v.text=null):(v.isHtmlContent&&(a.innerHTML="",v.isHtmlContent=!1),b=v.icon,tt=r.getIcon(),!b&&tt&&(b=k("img",u.safariRenderHack,a),v.icon=b,b[l]={entity:r,type:ni.pushpin},b.src=tt),b&&b.src!==tt&&(b.src=tt||""),w=v.text,ft=r.getText(),!w&&ft&&(w=k(null,u.safariRenderHack,a),w.appendChild(document.createTextNode("")),v.text=w,w[l]={entity:r,type:ni.pushpin}),w&&(ft?(w.style.cssText="position:absolute;text-align:center;width:100%;font:bold 10pt Arial,Helvetica,Sans-Serif;color:#fff;left:"+r.getTextOffset().x+"px;top:"+r.getTextOffset().y+"px;",w.replaceChild(document.createTextNode(ft),w.firstChild)):(a.removeChild(w),v.text=null)))),ct=r.getHtmlContent(),p="",!c&&f<s.started&&(p=ct?"position:absolute;cursor:inherit;":"position:absolute;cursor:inherit;overflow:hidden;pointer-events:all;"+u.safariRenderHack,!h||!v.isDrawn)){if(et=f===s.readyForTarget?lt.internalTryLocationToViewport(vt,r.getLocation()):lt.internalTryLocationToViewport(st,r.getLocation()),et){var ii=r.getAnchor(),at=et.x-ii.x-i[t].offsetLeft,yt=et.y-ii.y-i[t].offsetTop;u.useTransform3d&&r.getUseTransform3d()?(pt=e.translation(at,yt,0),ot={excludeCommonCss:!0},o?p+=ri.setTransformAndOpacity(pt,null,1,ot):(ot.returnStyleObject=!0,wt=ri.setTransformAndOpacity(pt,null,1,ot),v.displayHidden&&(wt.display=""),y(a).set_style(wt))):o?(p+="left:"+at+"px;",p+="top:"+yt+"px;"):(a.style.left=at+"px",a.style.top=yt+"px",v.displayHidden&&(a.style.display="")),v.displayHidden=!1}else o?p+="display:none;":a.style.display="none",v.displayHidden=!0;v.displayHidden=!0}o&&(a.id=r.getId(),bt=r.getTypeName()||"",v.className!=bt&&(v.className=a.className=bt,y(a).add_class("MapPushpinBase")),kt=r.getZIndex(),typeof kt=="number"&&(p+="z-index:"+kt+";"),it=r.getWidth(),rt=r.getHeight(),ct?(it&&(p+="width:"+it+"px;"),rt&&(p+="height:"+rt+"px;")):(p+="width:"+(it?it+"px;":"auto;"),p+="height:"+(rt?rt+"px;":"auto;"),p+="line-height:0px;"),a.style.cssText=p),h||f!==s.readyForTarget||ut.addToGroup(a),(o||!v.isDrawn)&&(gt=r.getDraggable(),gt!=v.dragAttached&&ti(r,gt)),c?v.isDrawn?o&&c.updateEntity(r):(c.addEntity(r,a),v.isDrawn=!0):v.isDrawn||(i[t].shape.appendChild(a),v.isDrawn=!0)}}function it(n,i,u){var h,s,e,a,f,o,y,p,w,b;if(n)if(h=r.getTheme(),h&&(s=n[nt]=n[nt]||{},s.proxyEntity&&(n=s.proxyEntity),h._unhookFromEntity(n,s)),n[t]){if(e=n[t],n instanceof gi)for(f=e.root,a=!1,i&&f&&f.parentNode&&(d?(d.push(f),a=!0):f.parentNode.removeChild(f)),o=n.getLength();o--;)it(n.get(o),a,u);else if(n instanceof nr)ti(n,!1),ii(n),f=e.dom,f&&(f[l]=null,f.onclick=null,f.onfocus=null,f.onblur=null,f.onkeydown=null,f.removeAttribute("href"),i&&f.parentNode&&f.parentNode.removeChild(f)),e.updateEntity=e.updateEntity||u,e.isDrawn=!1,c&&c.removeEntity(n);else if(n instanceof ar)for(e.added=!1,o=tt.length;o--;)y=tt[o][0],e[y]&&v.removeOverlay(e[y])}else p=bt.getEntityRenderer(r,n),p&&(w={parentRemoved:!i,update:u,customRenderer:c},b=p.remove(n,w),fi(b,null))}function fi(n,t){if(n&&n.doms)for(var i=n.doms,r=i.length;r--;)i[r][l]=t}function gt(n){var i,u;if(n instanceof gi)for(i=n.getLength();i--;)gt(n.get(i));else n instanceof nr?(ti(n,!1),ii(n)):(u=bt.getEntityRenderer(r,n),u&&u.dispose(n));delete n[t]}function pi(n,i){n&&n[t]&&i&&i[t]&&(i[t].parentVisible=n[t].parentVisible&&n.getVisible())}function wi(n){return n&&n[t]?n[t].parentVisible&&n.getVisible():null}function ti(i,r){var u=i[t];u&&(u.dragAttached=r,r?u.dragStartHandler=n.addHandler(i,"mousedown",bi):u.dragStartHandler&&(n.removeHandler(u.dragStartHandler),delete u.dragStartHandler))}function bi(u){var o=u.target,f=o.trueEntity||o,e=o[t],s,h,c;if(e&&(u.isTouchEvent||u.originalEvent.which===1)&&(e.dragging=!0,s=r.tryLocationToPixel(f.getLocation()),s)){h=s.x-u.getX(),c=s.y-u.getY(),n.invoke(f,"dragstart",{entity:f});function l(t){t.handled=!0,t.originalEvent.preventDefault();var u=r.tryPixelToLocation(new i(t.getX()+h,t.getY()+c));u&&f.setLocation(u),n.invoke(f,"drag",{entity:f})}function a(){ii(o),n.invoke(f,"dragend",{entity:f})}e.dragAttached&&!e.dragEndHandler&&(e.dragMoveHandler=n.addHandler(r,"mousemove",l),e.dragEndHandler=n.addHandler(r,"mouseup",a))}}function ii(i){var r=i[t];r&&(r.dragging=!1,r.dragMoveHandler&&(n.removeHandler(r.dragMoveHandler),delete r.dragMoveHandler),r.dragEndHandler&&(n.removeHandler(r.dragEndHandler),delete r.dragEndHandler))}hr.ensureVmlNamespace();var ei=this,r,lt,at,c,h,v,ot,l,t,nt,a,st,b,ui,vt,yt,rt,d,ct,f=s.none,ut=new iu,p={first:0,middle:1,last:2},g=[["entityadded",oi],["entityremoved",si],["entitychanged",hi]],wt,tt=[["mercator",ht.horizontal],["enhancedBirdseyeNorthUp",ht.horizontal],["enhancedBirdseyeEastUp",ht.vertical],["enhancedBirdseyeSouthUp",ht.horizontal],["enhancedBirdseyeWestUp",ht.vertical]];this.activate=function(i,f,e,o,s,a){r=i,lt=f,at=r.getRootElement(),h=r.entities,v=e,c=a,yt=li.isClipped(),ot=s,l=ot+"_der",t=ot+"_etr",nt=ot+"_thr",h[t]={root:o,shape:k(null,u.safariRenderHack+";position:absolute;",o),offsetTop:0,offsetLeft:0,parentVisible:!0};for(var y=g.length;y--;)g[y][2]=n.addHandler(h,g[y][0],g[y][1]);wt=n.addHandler(bt,"newEntityRenderer",ci)},this.deactivate=function(){a=null;for(var t=g.length;t--;)n.removeHandler(g[t][2]),g[t][2]=null;n.removeHandler(wt),wt=null,it(h,!0,!1),gt(h),r=null,at=null,h=null,v=null},this.enableOrDisableCssAnimation=function(n){if(u.allowCssAnimations){var t=n!=null;ut.removeAllAnimations(),f=s.none,t&&(ut.manageAnimations([n]),f=n.isFlick?s.readyForTarget:s.allowed)}},this.onMouseDown=function(n){o(null,"mousedown",n)},this.onTouchStart=function(n){d||(d=[]),o(null,"mousedown",n,!0)},this.onMouseUp=function(n){o(this.getEntityForTarget(n.captureTarget),"mouseup",n)},this.onTouchEnd=function(n){var i,r,t;if(o(this.getEntityForTarget(n.captureTarget),"mouseup",n,!0),d)for(i=d,d=null,r=i.length;r--;)t=i[r],t&&t.parentNode&&t.parentNode.removeChild(t)},this.onMouseOver=function(n){o(null,"mouseover",n)},this.onMouseOut=function(n){o(null,"mouseout",n)},this.onMouseClick=function(n){o(null,"click",n)},this.onMouseRightClick=function(n){o(null,"rightclick",n)},this.onMouseDoubleClick=function(n){o(null,"dblclick",n)},this.onTap=function(n){o(null,"click",n,!0)},this.onDoubleTap=function(n){o(null,"dblclick",n,!0)},this.onTapAndHold=function(n){o(null,"rightclick",n,!0)},this.getEntityForTarget=function(n){while(n&&!n[l]&&n!==at)n=n.parentNode;return n&&n[l]||null},this.update=function(n,t,i,u,e){a=n,st=t,vt=i,e!=p.last&&u&&b||(b=r.getBounds(),ui=b.clone(),b.width*=3,b.height*=3),rt=e==p.last&&yt?!1:rt&&u,et(null,h,!1,rt,e),e==p.last&&(rt=!0),f>s.none&&f<s.started&&(f==s.readyForTarget&&ut.applyAllAnimations(),f++)}}function du(t){function a(){l=f.getMode().getShouldClipPolygons(),r=f.getMode().getDrawShapesInSingleLayer()}function p(){o&&(n.removeHandler(o),o=null,n.removeHandler(s),s=null)}function w(n){return r?n.rootDom:n.parentDom}function b(n,t){var u=null,i=n[e],f,r;return i&&(f=i.harmony,f&&(r=i.path,r&&(u=r.nativeShape,f.removePath(r),i.path=null)),i.updateEntity=i.updateEntity||t.update,i.isDrawn=!1),li.isEventsSupported()&&u?{doms:[u]}:null}function v(n){var t=n[e];return t||(t={},n[e]=t),t}function d(n){return n instanceof tr||n instanceof ir&&l}function g(n,t){for(var o=n.x,s=n.x+n.width,h=n.y,c=n.y+n.height,f=[],i=[],a=t.length,e=null,r,l,u=0;u<a;u++)r=t[u],r?(l=r.x>=o&&r.y>=h&&r.x<=s&&r.y<=c,l?(!i.length&&u&&t[u-1]&&i.push(t[u-1]),i.push(r),e=null):(i.length&&(i.push(r),f.push(i),i=[]),e&&nt(o,s,h,c,e,r)&&(i.push(e),i.push(r),f.push(i),i=[]),e=r)):(f.push(i),i=[]);return i.length&&f.push(i),f}function nt(n,t,i,r,u,f){if(f.x-u.x==0)return u.x>=n&&u.x<=t;if(f.y-u.y==0)return u.y>=i&&u.y<=r;var o=(f.y-u.y)/(f.x-u.x),s=u.y-o*u.x,e=o*n+s;return e>=i&&e<=r?!0:(e=o*t+s,e>=i&&e<=r)?!0:(o=(f.x-u.x)/(f.y-u.y),s=u.x-o*u.y,e=o*i+s,e>=n&&e<=t)?!0:!1}function y(n,t,r){var u=n.x1,f=n.y1,e=n.x2,o=n.y2,s=t.x,h=t.y,c=r.x,l=r.y,a=((u*o-f*e)*(s-c)-(u-e)*(s*l-h*c))/((u-e)*(h-l)-(f-o)*(s-c)),v=((u*o-f*e)*(h-l)-(f-o)*(s*l-h*c))/((u-e)*(h-l)-(f-o)*(s-c));return new i(a,v)}function tt(n,t){for(var e=n.x,o=n.x+n.width,s=n.y,h=n.y+n.height,p=[{x1:e,y1:s,x2:o,y2:s,isInside:function(n,t){return t>this.y1}},{x1:o,y1:s,x2:o,y2:h,isInside:function(n){return n<this.x2}},{x1:o,y1:h,x2:e,y2:h,isInside:function(n,t){return t<this.y2}},{x1:e,y1:h,x2:e,y2:s,isInside:function(n){return n>this.x1}}],u=t,f,l,v,i,a,r,c=0;c<p.length;c++)for(f=p[c],l=u,u=[],v=l.length,i=l[v-1],a=0;a<v;a++)r=l[a],f.isInside(r.x,r.y)?(f.isInside(i.x,i.y)||u.push(y(f,i,r)),u.push(r)):f.isInside(i.x,i.y)&&u.push(y(f,i,r)),i=r;return[u]}var f=t,h="cm"+ai.getNext(),e=h+"_etr",c=!0,l,r,s,o;a(),s=n.addHandler(f,"modeoptionschanged",a),o=n.addHandler(f,"ondispose",p),this.shouldDraw=function(n,t){var f,e,i,o;return t.parentVisible!==null&&(c=t.parentVisible),f=n.getVisible()&&(t.linear||t.animationEnd||u.animateShapes)&&(!r||c),f&&(e=v(n),i=e.boundingRect,(t.update||!i)&&(o=n.getLocations(),e.boundingRect=i=o?ut.fromLocations(o):null),f=i&&t.currentBounds.intersects(i)),f},this.update=function(n,t){var o=t.viewportSize,at=t.currentBounds,i=v(n),y,s,c,e,it,ut,ft,p,l,et,b,ot,st,rt,bt,kt,a,nt,ht,ct;if(t.update=i.updateEntity||t.update,i.updateEntity=!1,y=i.harmony,s=w(t),!y&&s&&(c=s.harmony,c||(c=k("div","position:absolute;width:"+o.width+"px;height:"+o.height+"px;left:"+-(o.width/2)+"px;top:"+-(o.height/2)+"px;"+u.safariRenderHack),s.harmony=c,s.firstChild?s.insertBefore(c,s.firstChild):s.appendChild(c)),y=li.getContext(c),c.className="MicrosoftMapDrawing",i.harmony=y),e=i.path,it=!1,e&&pt.areEqual(i.previousSize,o)||(y.setSize(o.width,o.height),i.previousSize=o,it=!0),e||(e=y.createPath(),e.id=h+"path"+ai.getNext(),i.path=e,t.update=!0),t.update&&(ut=n.getStrokeColor(),e.strokeStyle=ut.toHex(),e.strokeOpacity=ut.getOpacity(),e.lineWidth=n.getStrokeThickness(),e.dashArray=n.getStrokeDashArray(),n instanceof ir?(ft=n.getFillColor(),e.fillStyle=ft.toHex(),e.fillOpacity=ft.getOpacity()):e.fillStyle="none"),(!t.linear||!i.points||it)&&(et=null,b=i.boundingRect,b&&b.width>180&&(et={referenceLocation:b.center}),i.points=f.tryLocationToPixel(n.getLocations(),null,et),i.offsetLeft=r?t.rootOffsetLeft:t.parentOffsetLeft,i.offsetTop=r?t.rootOffsetTop:t.parentOffsetTop,ot=d(n)&&(b.width>at.width||b.height>at.height),i.doClipping=ot,!ot)){for(l=i.points,st=l.length,p=l.length;p--;)l[p]||(st=!1,p=0);st||(i.points=[])}if(!t.linear||t.animationEnd||t.update||it){if(l=i.points,i.doClipping){var vt=o.width*3,yt=o.height*3,dt=r?t.rootOffsetLeft:t.parentOffsetLeft,gt=r?t.rootOffsetTop:t.parentOffsetTop,wt=new lt(-dt-vt/2,gt-yt/2,vt,yt);rt=n instanceof tr?g(wt,l):tt(wt,l)}else rt=[l];for(e.beginPath(),bt=i.offsetLeft-o.width/2,kt=i.offsetTop-o.height/2,p=rt.length;p--;)if(a=rt[p],a&&a.length)for(a[0].shouldUseMoveTo=!0,nt=0;nt<a.length;nt++)ht=a[nt].x-bt,ct=a[nt].y-kt,a[nt].shouldUseMoveTo?e.moveTo(ht,ct):e.lineTo(ht,ct);e.data||e.moveTo(0,0),e.stroke(),i.isDrawn||(y.renderPath(e),i.isDrawn=!0)}return li.isEventsSupported()&&n.getShouldFireEvents()?{doms:[e.nativeShape],type:n instanceof tr?ni.polyline:ni.polygon}:null},this.remove=b,this.dispose=function(n){delete n[e]}}function hu(n,t,i,r,u){function e(n){for(var i=[],r=n?n.split(";"):[],u=r.length,t;u--;)t=ut.fromString(r[u]),t&&i.push(t);return i}this.priority=u;var f=e(r);this.getScene=function(r,u,e,o){if(o>=t&&o<i){if(!f||!f.length)return n;for(var h=new v(u,e),s=f.length;s--;)if(f[s].contains(h))return n}return null}}function ui(n,t){var i=n;this.getCopyrights=function(n,r,u,f){t(function(t){t?cu.getCopyrights(i,n,r,u,t,f):f([gt.defaultCopyright.text])})}}function lu(r,e,o,s,h,c,l){function ot(n){n.stopPropagation(),n.preventDefault()}function oi(n,t){var r,i;if(r=n.length,t&&!n.isWired){while(r--)i=n[r],s.add_event(i[0],i[1],!1);n.isWired=!0}else if(!t&&n.isWired){while(r--)i=n[r],s.remove_event(i[0],i[1],!1);n.isWired=!1}}function ht(){return p!=null&&(p.x!=0||p.y!=0)}function nr(){bt&&ht()&&(p.x*=bt,p.y*=bt,Math.abs(p.x)<5&&Math.abs(p.y)<5&&(p.x=0,p.y=0))}function tr(n,t,i){if(n&&t&&i){var r=i.x-t.x,u=i.y-t.y;r!=0||u!=0?(st+=n,p?(p.x=.3*p.x+.7*r*1e3/st,p.y=.3*p.y+.7*u*1e3/st):p=new ti(r*1e3/st,u*1e3/st),st=0):st+=n}}function ir(n){var t=y.Screen.get_mouse_pos(n);return new i(t.x-e.getViewportX(),t.y-e.getViewportY())}function ct(){return new i(0,0)}function d(t,u,f,o){var p=!1,c,w,s,l,v;return n.hasHandler(r,u)&&(o||(f.touches&&f.touches[0]?c=new i(f.touches[0].pageX,f.touches[0].pageY):a&&a[0]&&(c=a[0])),c||(c=y.Screen.get_mouse_pos(f)),w=f.wheelDelta?f.wheelDelta:0,h&&(t&&(s=h.getEntityForTarget(t)),s||(s=h.getEntityForTarget(f.target)),s&&(l=s.type,s=s.entity)),l||(s=e,l=ni.map),v=new vi(e,l,s,u,c.x,c.y,w,!o,f),u==="click"&&(v.mouseMoved=ei&&g&&i.distance(ei,g)>5),n.invoke(r,u,v),p=v.handled),p}function sr(n){if(!n.handled){var t=!1;if(n.ctrlKey)switch(n.keyCode){case 37:o.rotate(90);break;case 39:o.rotate(-90)}else switch(n.keyCode){case 37:v.x>-1&&(v.x=-1),t=!0;break;case 39:v.x<1&&(v.x=1),t=!0;break;case 38:v.y>-1&&(v.y=-1),t=!0;break;case 40:v.y<1&&(v.y=1),t=!0;break;case 109:case 189:vt=-1;break;case 107:case 187:case 61:vt=1}r.ensureUpdateDispatched(),t&&(n.handled=!0,ot(n.originalEvent))}}function hr(n){if(!n.handled){switch(n.keyCode){case 37:case 39:v.x=0;break;case 38:case 40:v.y=0;break;case 109:case 189:case 107:case 187:case 61:vt=0}r.ensureUpdateDispatched()}}function si(){v.x=0,v.y=0,vt=0}function rr(n){if(!d(null,"dblclick",n,!0)&&!et){if(h)h.onMouseDoubleClick(n);var t=ft?ct():ir(n);o.zoomCenter(.5,t)}ot(n)}function cr(n){if(!d(null,"click",n,!0)&&h){h.onMouseClick(n);if(u.emulateDblClick){var t=y.Screen.get_mouse_pos(n);new Date-fi<yi&&t.x===dt.x&&t.y===dt.y?(dt={x:0,y:0},fi=new Date(0),rr(n)):(dt=t,fi=new Date)}}}function lr(n){if(!d(null,"rightclick",n,!0)&&h)h.onMouseRightClick(n)}function ar(n){if(!d(null,"mousewheel",n,!0)&&!et){if(nt.clearInertialScrolling(),n.wheelDelta){var t=ft?ct():ir(n);o.zoomPoint(n.wheelDelta,t)}ot(n)}}function vr(n){if(!d(null,"mousedown",n,!0)){if(si(),r.suspendSceneChanges(!1),r.haltCssAnimation(),o.startUserInput(),h)h.onMouseDown(n);ii=!et&&c&&(n.shiftKey===!0||n.which===2),g=y.Screen.get_mouse_pos(n),nt.clearInertialScrolling(),ei=it=g,y.Events.capture_mouse(this,!1),ui=!0,ii?s.set_style({cursor:r.getCursors().SEResize}):s.set_style({cursor:r.getCursors().Grabbing})}ot(n);try{document.focus()}catch(t){}}function yr(n){d(null,"mousemove",n,!0)||it&&(g=y.Screen.get_mouse_pos(n),r.ensureUpdateDispatched(),pi=new Date,ot(n))}function pr(n){ui&&ur(n)}function ur(n){var u,f;if(!d(n.captureTarget,"mouseup",n,!0)){if(r.canUseCssAnimations()&&ht()||r.allowSceneChanges(),at===!0&&(u=new Date,f=u-pi,f<bi?tt=g:nt.clearInertialScrolling()),r.ensureUpdateDispatched(),h)h.onMouseUp(n);if(ii&&it&&i.distance(it,g)>10){var l=e.getViewportX(),a=e.getViewportY(),t=lt.union(new i(it.x-l,it.y-a),new i(g.x-l,g.y-a)),v=Math.max(t.width/e.getWidth(),t.height/e.getHeight()),p=ft?ct():t.getCenter();o.zoomCenter(v,p)}}c&&(rt.style.display="none",rt.parentNode&&rt.parentNode.removeChild(rt)),s.set_style({cursor:r.getCursors().Grab}),it=null,ui=!1,y.Events.release_mouse()}function wr(n){if(!d(null,"mouseover",n,!0)&&h)h.onMouseOver(n)}function br(n){if(!d(null,"mouseout",n,!0)&&h)h.onMouseOut(n)}function hi(n){var t=e.getViewportX(),r=e.getViewportY();return n.length>1?new i((n[0].x+n[1].x)/2-t,(n[0].y+n[1].y)/2-r):n.length?new i(n[0].x-t,n[0].y-r):new i(0,0)}function kr(n){if(n.preventManipulation&&n.preventManipulation(),n.currentTarget&&n.currentTarget.msSetPointerCapture&&n.currentTarget.msSetPointerCapture(n.pointerId),n.preventMouseEvent&&n.preventMouseEvent(),si(),ci(),!d(null,"mousedown",n,!1)){if(r.suspendSceneChanges(!0),r.haltCssAnimation(),o.startUserInput(),h)h.onTouchStart(n);nt.clearInertialScrolling();var t=Math.min(2,n.touches.length);for(yt===0&&t===2&&(yt=r.getCurrentCamera().getMercatorZoom()),b.length===0&&t===1&&(w=new i(n.touches[0].pageX,n.touches[0].pageY),w.target=n.target,w.start=new Date,wt=setTimeout(tu,er));t--;)a[t]=new i(n.touches[t].pageX,n.touches[t].pageY),b[t]=a[t],ut[t]=a[t];gi=r.getCurrentCamera().getHeading()}ot(n)}function dr(n){if((n.touches.length>1||w&&(Math.abs(n.touches[0].pageX-w.x)>20||Math.abs(n.touches[0].pageY-w.y)>20))&&(li(),ci()),n.touches.length>1||!d(null,"mousemove",n,!1)){var t=b.length;if(t)for(t=n.touches.length;t--;)a[t]=new i(n.touches[t].pageX,n.touches[t].pageY)}r.ensureUpdateDispatched(),wi=new Date,ot(n)}function fr(n){var c,v,y,p,t,u,l,s,it,rt;if(n.currentTarget.msReleasePointerCapture&&n.currentTarget.msReleasePointerCapture(n.pointerId),ci(),!d(null,"mouseup",n,!1)){if(h)h.onTouchEnd(n);if(w&&(gr(),navigator.msPointerEnabled&&navigator.pointerEnabled||(pt&&new Date-pt.start<yi?(c=new i(w.x-e.getViewportX(),w.y-e.getViewportY()),nu(),li()):(pt=w,w=null))),b.length===1&&at===!0&&(v=new Date,y=v-wi,y<bi?tt=a[0]:nt.clearInertialScrolling()),b.length=0,n.touches.length&&(nt.clearInertialScrolling(),a[0]=b[0]=new i(n.touches[0].pageX,n.touches[0].pageY)),r.canUseCssAnimations()&&ht()?r.ensureUpdateDispatched():r.allowSceneChanges(),c&&!et)t=ft?ct():c,o.zoomCenter(.5,t,null,!0);else{if(ut.length>1&&r.isRotationEnabled()){var k=new ti(ut[1].x-ut[0].x,ut[1].y-ut[0].y),g=new ti(a[1].x-a[0].x,a[1].y-a[0].y),ot=Math.atan2(g.y,g.x)-Math.atan2(k.y,k.x);Math.abs(ot)>.7&&(yt=0),ut.length=0}yt!==0&&ri>0&&(t=ft?ct():hi(a),u=r.getCurrentCamera().getMercatorZoom(),l=u-yt,yt=0,s=Math.abs(l),s-=Math.floor(s),s>=ri&&s<.5&&(it=l>0?Math.ceil(u):Math.floor(u),rt=f.mercatorZoomToWidth(it,r.getCurrentCamera().getCrs(),p)/f.mercatorZoomToWidth(u,r.getCurrentCamera().getCrs(),p),o.zoomCenter(rt,t,t)))}ht()||o.endUserInput()}}function ci(){wt&&(clearInterval(wt),wt=null)}function li(){pt=null,w=null}function gr(){if(!d(null,"click",w,!1)&&h)h.onTap(w)}function nu(){if(!d(null,"dblclick",w,!1)&&h)h.onDoubleTap(w)}function tu(){if(w){if(!d(null,"rightclick",w,!1)&&h)h.onTapAndHold(w);li()}}var nt=this,rt;l=l||{},c&&(rt=k("div","display:none;z-index:0;position:absolute;border:1px dashed #000;background:#ccc"),y(rt).set_style({opacity:".5"}));var ai=.15,yi=500,er=1e3,pt,w,wt,ri=l.touchZoomThreshold!=null?l.touchZoomThreshold:.1,ui=!1,at=!0,bt=.9,p=null,kt=null,tt=null,dt={x:0,y:0},fi=new Date(0),pi=new Date(0),wi=new Date(0),bi=100,st=0,ft=!1,et=!1,or=[["dblclick",rr],["click",cr],["mousewheel",ar],["mousedown",vr],["mousemove",yr],["mouseup",ur],["losecapture",pr],["contextmenu",lr],["mouseover",wr],["mouseout",br]],ki=[["touchstart",kr],["touchmove",dr],["touchend",fr],["touchcancel",fr]],gt=[["keydown",sr,null],["keyup",hr,null],["blur",si,null]],iu=.003*u.scrollAdjustment,v=new i(0,0),vt=0,di=new Date(0),g,it,ei,ii,a=[],ut=[],gi,b=[],yt=0;nt.enableOrDisableInertialScrolling=function(n,t){n?(at=!0,typeof t=="number"&&(bt=Math.min(Math.max(t,.01),.99))):at=!1},nt.enableOrDisableUserInput=function(t,i){if(i){t=t&&!i.disableUserInput,oi(or,t&&!i.disableMouseInput),t&&!i.disableTouchInput?(navigator.pointerEnabled?s.set_style({"touch-action":"none"}):s.set_style({"-ms-touch-action":"none"}),oi(ki,!0)):(navigator.pointerEnabled?s.set_style({"touch-action":""}):s.set_style({"-ms-touch-action":""}),oi(ki,!1)),t=t&&!i.disableKeyboardInput;var u,f;if(u=gt.length,t)while(u--)f=gt[u],f[2]||(f[2]=n.addHandler(e,f[0],f[1]));else while(u--)n.removeHandler(gt[u][2]),gt[u][2]=null;ft=i.disablePanning?!0:!1,et=i.disableZooming?!0:!1,s.set_style({cursor:r.getCursors().Grab})}},nt.setTouchZoomThreshold=function(n){ri=Math.min(n,.49)},nt.clearInertialScrolling=function(){tt=null,p=null},nt.processPendingUserInput=function(){var c=new Date,l=kt?c-kt:null,y,ri,ui,f,h,u,k,d,ot,st,yt;if(kt=c,ri=r.getCurrentCamera().getWidth(),ui=r.getCurrentCamera().getLookAt(),vt&&!et&&(nt.clearInertialScrolling(),y=vt<0?2:.5),(v.x||v.y)&&!ft&&(nt.clearInertialScrolling(),f=v.x*ai*e.getWidth(),h=v.y*ai*e.getHeight(),Math.abs(v.x)>.9&&Math.abs(v.x)<3&&(v.x=v.x*1.01),Math.abs(v.y)>.9&&Math.abs(v.y)<3&&(v.y=v.y*1.01)),(y||f||h)&&(c=new Date,(kt-di)/1e3>r.getCameraAnimationDuration()/3&&(y&&o.zoom(y),(f||h)&&o.doDragXY(f,h),di=c)),it)if(ii&&!et){var wt=e.getPageX(),bt=e.getPageY(),w=lt.union(new i(it.x-wt,it.y-bt),new i(g.x-wt,g.y-bt));rt.style.left=w.x+"px",rt.style.top=w.y+"px",rt.style.width=w.width+"px",rt.style.height=w.height+"px",rt.style.display="block",s.element().appendChild(rt)}else ft||(o.doDrag(it,g),at===!0&&tr(l,it,g),it=g);else if(b.length>0){if(u=b.length,a.length>=u){switch(u){case 1:ft||(o.doDrag(b[0],a[0]),at===!0&&tr(l,b[0],a[0]));break;case 2:if(k=ft?ct():hi(b),d=ft?ct():hi(a),!a[0]||!a[1]||!b[0]||!b[1])return;if(ot=1,et||(ot=i.distance(b[0],b[1])/i.distance(a[0],a[1])),st=0,ut.length>1&&r.isRotationEnabled()){var dt=new ti(ut[1].x-ut[0].x,ut[1].y-ut[0].y),gt=new ti(a[1].x-a[0].x,a[1].y-a[0].y),fi=Math.atan2(gt.y,gt.x)-Math.atan2(dt.y,dt.x);st=gi-r.getCurrentCamera().getHeading()-fi*180/Math.PI}o.setCamera(ot,k,d,st)}while(u--)b[u]=a[u]}}else if(ht())if(yt=r.requestCssAnimation(!0),yt){for(var n=new i(tt.x,tt.y),pt=1/t.maxFPS,ni=0;ht();)n.x+=p.x*pt,n.y+=p.y*pt,ni+=pt,nr();yt.setDuration(ni),r.suspendSceneChanges(!0),o.doDrag(tt,n,!0),tt=n}else{if(tt){var n=new i(tt.x+p.x*l/1e3,tt.y+p.y*l/1e3),k=new i(Math.round(tt.x),Math.round(tt.y)),d=new i(Math.round(n.x),Math.round(n.y));o.doDrag(k,d),tt=n}nr(),ht()?r.ensureUpdateDispatched():o.endUserInput()}else o.endUserInput()}}function au(n,t){var e=null,o=.003*u.scrollAdjustment,r=0;this.doDrag=function(r,u,f){if(r&&u&&!i.areEqual(r,u)){var e=t.getViewportX(),o=t.getViewportY(),s=new i(r.x-e,r.y-o),h=new i(u.x-e,u.y-o),c=n.getCurrentCamera().getViewportToWorld().transform(s);n.setAlignedCamera(n.getCurrentCamera().getCrs(),c,h,n.getCurrentCamera().getWidth(),n.getCurrentCamera().getHeading(),f)}},this.doDragXY=function(t,r){var u=n.getCurrentCamera().getWidth(),f=n.getCurrentCamera().getViewportToWorld().transform(new i(t,r));n.setAlignedCamera(n.getCurrentCamera().getCrs(),f,null,u,n.getCurrentCamera().getHeading(),!0)},this.zoom=function(t){var i=n.getCurrentCamera().getWidth()*t,r=n.getCurrentCamera().getLookAt();i!==n.getTargetCamera().getWidth()&&n.setAlignedCamera(n.getCurrentCamera().getCrs(),r,null,i,n.getCurrentCamera().getHeading(),!0)},this.zoomCenter=function(t,i,r,u){var e=n.getTargetCamera(),s=e.getWidth()*t,c=e.getViewportToWorld().transform(i),o,h;u&&(o=f.widthToMercatorZoom(s,e.getCrs(),e.getLookAt()),o!=Math.floor(o)&&(h=o-e.getMercatorZoom()>0?Math.floor(o):Math.ceil(o),o=h+Math.round(o-h),s=f.mercatorZoomToWidth(o,e.getCrs(),e.getLookAt()))),n.requestCssAnimation(),n.setAlignedCamera(e.getCrs(),c,r,s,e.getHeading(),!0)},this.zoomPoint=function(t,i){var a=new Date,s=a-e,c,h,l,u,v,y;e=a,c=n.getCurrentCamera().getViewportToWorld().transform(i),h=o*t*(t>0?1:.75),s>200?(s=200,r=h/s):r=(r+h/s)/2,r=Math.min(.009,r),r=Math.max(-.006,r),l=n.getCurrentCamera().getMercatorZoom(),u=l+r*(r>0?400:250),u=h>0?Math.min(n.getInternalMaxZoom(),Math.ceil(u)):Math.max(n.getInternalMinZoom(),Math.floor(u)),v=f.mercatorZoomToWidth(u,n.getCurrentCamera().getCrs(),c),y=(u-l)/r*1.5,n.setAlignedCamera(n.getCurrentCamera().getCrs(),c,i,v,n.getCurrentCamera().getHeading(),y)},this.rotate=function(t){n.setAlignedCamera(n.getTargetCamera().getCrs(),n.getTargetCamera().getLookAt(),null,n.getTargetCamera().getWidth(),n.getTargetCamera().getHeading()+t,!0)},this.setCamera=function(t,i,r,u){var f=n.getCurrentCamera().getViewportToWorld().transform(i),e=l.log2(1/t);n.setCamera(n.getCurrentCamera().getAlignedCamera(e,f,r,u),!1)},this.startUserInput=function(){},this.endUserInput=function(){}}function nf(i){function ut(n,t,i,r,u,f){var g,s,b,d,et;if(r>=rt){if(g=st.toEllipsoid(new v(t,i)),s=c.wrap(c.fromLocation(g)),k(n,s,r,u,f))return n;for(var ot=1<<y,tt=nt.mercatorXYToTileId(s,y),p=nt.tileIdToCacheKey(tt),it=Math.round(l.normalizeDegrees(u)/h)*h%360,o=e.get(p)||[],ut=o.length,w;ut--;)if(w=o[ut],k(w,s,r,u,f))return w;b="h"+it.toFixed(),o[b]||(o[b]=!0,e.insert(p,o),d=nt.tileIdToLocation(tt),et=a.replace("{centerpoint}",d.latitude.toFixed(6)+","+d.longitude.toFixed(6)).replace("{heading}",it.toFixed(0)),fi.getObjectAsync(et,ft,p))}return null}function ft(t,i){var f=i.userData,r,u;i.success&&t&&t.statusCode===200&&t.resourceSets&&t.resourceSets.length&&(r=t.resourceSets[0],r.resources&&r.resources.length&&(u=e.get(f)||[],ot(r.resources[0],u),e.insert(f,u),n.invoke(o,"newsceneavailable")))}function ot(n,i){var ht;if(n.bes&&n.bes.bec&&n.bes.bei){var o=n.bes,at=o.s.toString(),h=o.bei,e=o.bec,y=p.get(at);if(!y){y=[];var rt=2*Math.ceil(h.piw/(2*u)),vt=2*Math.ceil(h.pih/(2*u)),ut=rt*u,k=new r(e.qcx,e.qcy,e.qcz),yt=new r(e.qdx,e.qdy,e.qdz),ti=new r(e.qex,e.qey,e.qez),nt=or.toLocation(k),ii=st.getAltitudeAtLatLon(nt.latitude,nt.longitude),pt=or.fromLocation(new v(nt.latitude,nt.longitude,ii,ct.ellipsoid)),ri=ei.fromNormal(pt,or.getUpVector(pt)),wt=ri.intersectWithLine(k,r.add(k,yt)),bt=r.subtract(wt,k).getLength(),kt=ut/h.piw*(e.ox/(2*e.ol)),si=2*Math.atan(kt),fi=2*bt*kt,oi=f.fromDirectionVector(or,wt,fi,yt,ti,1/bt),ft=oi.convertCoordinateReferenceSystem(c),dt=(h.piw-w)/ut,gt=(h.pih-w)/ut,ni=new lt(-dt/2-e.opx,-gt/2-e.opy,dt,gt),a,b,ot;b=d(g.replace("{quadkey}",o.q).replace("{runtimeindex}",o.ri),rt,vt,o.l,e.opx*h.piw,e.opy*h.pih),b.projectingCamera=ft,ot=ft.getAlignedCamera(l.log2(b.getWidth()/t.zoomOriginWidth)-1),a=new et(ot,b,1,"NativeBirdseye",new ui("Birdseye",s)),a.nativeBirdseyeFrustumRect=ni,a.labelOverlay=it.hidden,y.push(a),b=d(tt.replace("{quadkey}",o.q).replace("{runtimeindex}",o.ri),rt,vt,o.l,e.opx*h.piw,e.opy*h.pih),b.projectingCamera=ft,a=new et(ot,b,1,"NativeBirdseye",new ui("BirdseyeWithLabels",s)),a.nativeBirdseyeFrustumRect=ni,a.labelOverlay=it.visible,y.push(a)}for(p.insert(at,y),ht=y.length;ht--;)i.push(y[ht])}}function k(n,t,i,r,u){if(n&&n.nativeBirdseyeFrustumRect&&n.labelOverlay===u&&l.distanceDegrees(r,n.nativeCamera.getHeading())<h&&i>=n.nativeCamera.getMercatorZoom()-.5){var f=n.tilePyramid.projectingCamera.getWorldToFrustum().transform(t);if(n.nativeBirdseyeFrustumRect.contains(f))return!0}return!1}function d(n,t,i,r,f,e){var s=Math.ceil(t/2),h=Math.ceil(i/2),o=new kt(t*u,i*u,u,u,0,0,f,e,function(u){var f,e,c;switch(u.levelOfDetail){case o.getMaxLevelOfDetail()-1:e=s,c=h,f=r-1;break;case o.getMaxLevelOfDetail():e=t,c=i,f=r}return f&&u.x>=0&&u.x<e&&u.y>=0&&u.y<c?n.replace("{subdomain}",(u.y&1)*2+(u.x&1)).replace("{level}",f).replace("{index}",e*u.y+u.x):null});return o}var o=this,s=i.credentialsProvider,g=i.urlFormat,tt=i.urlWithLabelsFormat,rt=17.1,e=new yi(100),y=19,p=new yi(100),h=45,w=400,u=256,a=t.nativeBirdseyeMetadataUrl.replace("{zoom}","20"),b;this.priority=40,this.getScene=function(){return b||(b=!0,s(function(t){a=a.replace("{credentials}",t),o.getScene=ut,n.invoke(o,"newsceneavailable")})),null}}var o=window[$MapsNamespace].Maps,y=o.Gimme,t=o.Globals,rr,h,a,p,ai,u,b,hi,ct,dt,it,ci,n,cr,di,pi,fi,ni,fr,lr,pr,wr,er,eu,g,wi,tu,l,tt,c,or,ft,nt,st,w,s,ii,ht,li,gu,cu,vu,vr;window[$MapsNamespace].Maps.Resources=new function(n){n=n||{},n.strings={},this.init=function(t){var i;for(i in t)n.strings[i]={value:t[i]}},this.getString=function(){function f(n){i.languages=[t.locale],ConfigCache&&ConfigCache.culture&&(i.languages=[ConfigCache.culture]);var r="";try{r=u.getValue(n,i).valueAsString}catch(f){}return r}function e(t){return n.strings[t]&&n.strings[t].value||""}if(window.Windows&&Windows.ApplicationModel){var r=Windows.ApplicationModel.Resources.Core,u=r.ResourceManager.current.mainResourceMap.getSubtree("/Bing.Maps.Javascript/Resources"),i=new r.ResourceContext;return f}return e}()}(this),rr=o.Resources,rr.init(
{"L_microsoftcopyright_text":"© {year} Microsoft Corporation","L_VersionMismatchMessage_Text":"A new version of Bing Maps SDK is available","L_VersionNotSupportedMessage_Text":"This version of Bing Maps SDK is not supported"}
),a={},p="mm$",typeof PRF=="undefined"&&(PRF={add:function(){},start:function(){},end:function(){}}),a.PRF=PRF,PRF.start("mapcore"),ai=new function(){var n=1e3;this.getNext=function(){return n++}},a.IdGenerator=ai;var gt=new function(){this.isValidNumber=function(n){return typeof n=="number"&&isFinite(n)},this.cloneObject=function(n){var i={},t;for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i},this.createElement=function(n,t,i){var r=document.createElement(n||"div");return t&&(r.style.cssText=t),i&&i.appendChild(r),r},this.ignoreEvent=function(n){n.stopPropagation(),n.preventDefault()},this.stopPropagation=function(n){n.stopPropagation()},this.prioritySort=function(n,t){return n.priority-t.priority},this.isArray=function(n){return typeof Array.isArray=="function"?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"},this.extend=function(n,t){function i(){}i.prototype=t.prototype,n.prototype=new i,n.prototype.constructor=n,n.baseConstructor=t,n.superClass=t.prototype},this.restrictLongitude=function(n,t){while(t-n>180&&t>n)t-=360;while(n-t>180&&t<n)t+=360;return t};var n=function(){function n(n,t,i){return Object.defineProperty(n,t,i)}function t(n,t,i){return n[t]=i.get(),n}try{return Object.defineProperty({},"test",{}),n}catch(i){return t}}();this.defineGetter=n,this.defaultCopyright=n({},"text",{get:function(){return rr.getString("L_microsoftcopyright_text").replace(/{year}/,(new Date).getFullYear())}})},ot=1e-11,si=gt.isValidNumber,ru=gt.cloneObject,k=gt.createElement,tf=gt.ignoreEvent,rf=gt.stopPropagation,yu=gt.prioritySort,ki=gt.isArray,pu=gt.extend,wu=gt.restrictLongitude;if(a.Common=gt,u=new function(){var n=navigator.userAgent,e=n.indexOf("MSIE"),o=n.indexOf("Firefox"),s=n.indexOf("Chrome"),p=o!==-1,w=s!==-1,r=e!==-1||typeof MSPointerEvent!="undefined"||n.toLowerCase().indexOf("trident")!==-1,t=parseInt(n.substring(e+5)),b=r&&t===6,k=r&&t===9,d=r&&t===8,g=r&&t===10,nt=w&&parseInt(n.substring(s+7))>=11,tt=p&&parseInt(n.substring(o+8))>=4,ft=document.documentMode,it=n.indexOf("Gecko"),h=it!==-1,c=n.indexOf("Trident/"),l=parseInt(n.substring(c+8)),a=c>0,v=n.indexOf("BlackBerry")!==-1,f=n.indexOf("AppleWebKit")!==-1,i=navigator.vendor==="Apple Computer, Inc."&&!v,y=i&&n.indexOf("iPhone OS 3_")!==-1,rt=f&&n.indexOf("Android")!==-1,ut=typeof WinJS!="undefined",u;this.isWebkit=f,this.cursorHotspot=f?" 10 9":"",this.allowCssAnimations=i,this.useTransform2d=a&&l>=6&&typeof document.createElement("div").style.msTransform!="undefined",this.useTransform3d=i,this.useTransform3dForTranslate=i,this.useImageDisposer=i,this.isIOSBrowser=n.indexOf("iPhone")!==-1,this.safariRenderHack=i?"-webkit-transform:translate3d(0px,0px,0px);":"",this.isIE6=b,this.isIE8=d,this.isIE9=k,this.isIE10=g,r&&(this.isIE7OrEarlier=t<8,this.isIE8OrEarlier=t<9,this.isIE9OrEarlier=t<10),this.useXHR=ut,this.isIOS3=y,u=a&&l>=5,this.useFilterReflowWorkaround=u,this.cssZoomAffectsTopLeft=function(){var n=function(){var n=document.createElement("div"),t,i;return n.style.cssText="position:absolute;top:-1000px;left:-1000px;width:100px;zoom:2;",t=document.createElement("div"),t.style.cssText="position:relative;width:10px;left:50%;",n.appendChild(t),document.body.appendChild(n),i=t.offsetLeft,n.parentNode.removeChild(n),i!==50}();return this.cssZoomAffectsTopLeft=function(){return n},n},this.animateOverlayLayers=u&&document.documentMode>8||nt||tt||i,this.animateShapes=this.animateOverlayLayers&&!y,this.canRenderOpacityAndRotationOnSemiTransparentPngs=!(r&&!u),this.scrollAdjustment=1,this.useOnResize=u,this.autoSizesElementsTooSmall=h||f,this.opacityGlitchAtBrowserEdges=h,this.emulateDblClick=v,this.isShapeEventsSupported=function(){return typeof li!="undefined"&&li.isEventsSupported?li.isEventsSupported():!0},this.allowFocus=!rt},a.Quirks=u,b=new function(){function e(){i=null,n.length&&u();var r=n;for(n=t,t=r,t.sort(o);t.length;)t.shift()()}function o(n,t){return n[r]-t[r]}function u(){i||(i=f(e))}var f=y.Effects.Animation.requestAnimationFrame,i,n=[],t=[],r=p+"dispatchOrder";this.dispatch=function(t,i){t[r]=i||0;for(var f=n.length;f--;)if(n[f]===t)return;n.push(t),u()},this.cancelDispatch=function(i){for(var r=n.length;r--;)n[r]===i&&n.splice(r,1);for(r=t.length;r--;)t[r]===i&&t.splice(r,1)}},a.Dispatcher=b,i.prototype={clone:function(){return new i(this.x,this.y)},toString:function(){return"[Point "+this.x+","+this.y+"]"}},i.clone=function(n){return new i(n.x,n.y)},i.add=function(n,t){return new i(n.x+t.x,n.y+t.y)},i.distance=function(n,t){var i=n.x-t.x,r=n.y-t.y;return Math.sqrt(i*i+r*r)},i.subtract=function(n,t){return new i(n.x-t.x,n.y-t.y)},i.multiply=function(n,t){return new i(n.x*t,n.y*t)},i.areEqual=function(n,t){return n&&t&&n.x===t.x&&n.y===t.y},o.Point=i,hi={fromTileId:function(n,t){var e=1,r;t&&(e=0);var i="",u=n.x,f=n.y;for(r=0;r<n.levelOfDetail;r++)i=((u&1)+2*(f&1)).toString()+i,u>>=1,f>>=1;return i},toTileId:function(n){var t=0,i=0,u=0,r;if(n!=null&&n.length>0)for(u=n.length,r=0;r<n.length;r++)switch(n.charAt(r)){case"0":t=t*2+0,i=i*2+0;break;case"1":t=t*2+1,i=i*2+0;break;case"2":t=t*2+0,i=i*2+1;break;case"3":t=t*2+1,i=i*2+1}return new rt(u,t,i)},wrapX:function(n){var t=1<<n.levelOfDetail;return new rt(n.levelOfDetail,(n.x%t+t)%t,n.y)},wrapY:function(n){var t=1<<n.levelOfDetail;return new rt(n.levelOfDetail,n.x,(n.y%t+t)%t)},isInBounds:function(n){if(n.x<0||n.y<0)return!1;var t=1<<n.levelOfDetail;return n.x>=t||n.y>=t?!1:!0}},o.QuadKey=hi,ct={ground:0,ellipsoid:1,isValid:function(n){return n===ct.ground||n===ct.ellipsoid}},o.AltitudeReference=ct,v.prototype={clone:function(){return new v(this.latitude,this.longitude,this.altitude,this.altitudeReference)},toString:function(){return"[Location "+this.latitude+","+this.longitude+(this.altitude!==h&&this.altitudeReference!==h?","+this.altitude+","+this.altitudeReference:"")+"]"}},v.normalizeLongitude=function(n){return n<-180||n>180?n-Math.floor((n+180)/360)*360:n},v.areEqual=function(n,t){return n&&t&&n.latitude===t.latitude&&n.longitude===t.longitude&&n.altitude===t.altitude&&n.altitudeReference===t.altitudeReference},o.Location=v,ut.prototype={getNorthwest:function(){return new v(this.getNorth(),this.getWest(),this.center.altitude,this.center.altitudeReference)},getSoutheast:function(){return new v(this.getSouth(),this.getEast(),this.center.altitude,this.center.altitudeReference)},getNorth:function(){return this.center.latitude+this.height/2},getSouth:function(){return this.center.latitude-this.height/2},getWest:function(){return this.width>=360?-180:v.normalizeLongitude(this.center.longitude-this.width/2)},getEast:function(){return this.width>=360?180:v.normalizeLongitude(this.center.longitude+this.width/2)},toString:function(){return"[LocationRect "+this.center.toString()+" "+this.width+","+this.height+"]"},clone:function(){return new ut(this.center.clone(),this.width,this.height)},contains:function(n){var i=Math.abs(this.center.latitude-n.latitude),t=Math.abs(this.center.longitude-n.longitude);return t>180&&(t=360-t),i<=this.height/2&&t<=this.width/2},intersects:function(n){var i=Math.abs(this.center.latitude-n.center.latitude),t=Math.abs(this.center.longitude-n.center.longitude);return t>180&&(t=360-t),i<=this.height/2+n.height/2&&t<=this.width/2+n.width/2}},ut.areEqual=function(n,t){return n&&t&&v.areEqual(n.center,t.center)&&n.height===t.height&&n.width===t.width},ut.fromEdges=function(n,t,i,r,u,f){return Math.abs(r-t)>360&&(t=-180,r=180),t=v.normalizeLongitude(t),r=v.normalizeLongitude(r),t>r&&(r+=360),new ut(new v((i+n)/2,(t+r)/2,u,f),r-t,n-i)},ut.fromCorners=function(n,t){return ut.fromEdges(n.latitude,n.longitude,t.latitude,t.longitude,n.altitude,n.altitudeReference)},ut.fromLocations=function(){for(var t=ki(arguments[0])?arguments[0]:arguments,r,u,f,e,o,s,i,l=t&&t.length?t[0].longitude:0,n,c=t.length;c--;)n=t[c],isFinite(n.latitude)&&isFinite(n.longitude)&&(r=r===h?n.latitude:Math.max(r,n.latitude),u=u===h?n.latitude:Math.min(u,n.latitude),i=wu(l,n.longitude),e=e===h?i:Math.max(e,i),f=f===h?i:Math.min(f,i),isFinite(n.altitude)&&ct.isValid(n.altitudeReference)&&(s=n.altitude,o=n.altitudeReference));return ut.fromEdges(r,f,u,e,s,o)},ut.fromString=function(n){var i=null,t=n.split(","),r,u,f,e;return t&&t.length==4&&(r=parseFloat(t[0]),u=parseFloat(t[1]),f=parseFloat(t[2]),e=parseFloat(t[3]),i=ut.fromEdges(r,u,f,e)),i},o.LocationRect=ut,dt={road:"r",aerial:"a",birdseye:"be"},o.MapTypeId=dt,it={visible:0,hidden:1,isValid:function(n){return n===it.hidden||n===it.visible}},o.LabelOverlay=it,ci={viewport:0,page:1,control:2,isValid:function(n){return n===ci.viewport||n===ci.page||n===ci.control}},o.PixelReference=ci,n=new function(){var t=this,n=p+"events";this.addHandler=function(t,i,r){var u=null,f;return t&&typeof i=="string"&&typeof r=="function"&&(t[n]=t[n]||{},f=t[n][i]||[],t[n][i]=f,u={target:t,eventName:i,handler:r},f.push(u)),u},this.addThrottledHandler=function(n,i,r,u){var f=t.addHandler(n,i,r);return f.throttleInterval=u,f},this.removeHandler=function(i){var f,e,r,u;if(i&&(f=i.target,e=i.eventName,t.hasHandler(f,e)))for(r=f[n][e],u=r.length;u--;)i===r[u]&&(i.willBeInvokedBy&&window.clearInterval(i.willBeInvokedBy),r.splice(u,1))},this.hasHandler=function(n,t){return this.getHandlers(n,t)!==null},this.getHandlers=function(t,i){var r=t&&t[n]&&t[n][i]&&t[n][i];return r&&r.length>0?r:null},this.invoke=function(i,r,u){var e;if(t.hasHandler(i,r)){var o=new Date,s=i[n][r],c=s.length,f;for(u=u||{},u.eventName===h&&(u.eventName=r);c--;)f=s[c],f.handler&&(f.throttleInterval?f.willBeInvokedBy?f.willBeInvokedWithArgs=u:(e=f.throttleInterval-(o-(f.lastInvokedAt||new Date(0))),e<=0?(f.lastInvokedAt=o,f.handler(u)):(f.willBeInvokedWithArgs=u,f.willBeInvokedBy=window.setTimeout(function(){var n=f;return function(){var t=n.willBeInvokedWithArgs;delete n.willBeInvokedBy,delete n.willBeInvokedWithArgs,n.lastInvokedAt=new Date,n.handler&&n.handler(t)}}(),e))):f.handler(u))}}},o.Events=n,a.ElementSizeHelper=uu,cr={singleByteHex:function(n){var t,i;if(!n)return"";for(t=n.toString(16),i=t.length;i<2;i++)t="0"+t;return t},twoByteHex:function(n){var t,i;if(!n)return"";for(t=n.toString(16),i=t.length;i<4;i++)t="0"+t;return t},encodeHtml:function(n){var t,u,i,r;if(n==null)return"";for(u=n.length,i=new Array(u),r=0;r<u;r++)t=n.charCodeAt(r),t>96&&t<123||t>64&&t<91||t==32||t>47&&t<58||t==46||t==44||t==45||t==95?i.push(String.fromCharCode(t)):i.push("&#"+t+";");return i.join("")},encodeUrl:function(n){var t,u,i,r;if(!n)return"";for(u=n.length,i=new Array(u),r=0;r<u;++r)t=n.charCodeAt(r),t>96&&t<123||t>64&&t<91||t>47&&t<58||t==46||t==45||t==95?i.push(String.fromCharCode(t)):t>127?(i.push("%u"),i.push(cr.twoByteHex(t))):(i.push("%"),i.push(cr.singleByteHex(t)));return i.join("")}},a.IOSec=cr,di=[],ur.getAllInstances=function(){return di},ur.getVersion=function(){return t.version},o.Map=ur,a.MapType=oi,fi=new function(){function l(i,r){b.dispatch(function(){if(i&&!r&&(r=t),r){var u=n[r];u&&(delete n[r],u.timeoutId&&window.clearTimeout(u.timeoutId),u.callback(i,{requestId:r,success:!0,userData:u.userData}),f(u.elScript))}})}function o(t){if(t){var i=n[t];i&&(delete n[t],i.callback(null,{requestId:t,success:!1,userData:i.userData}),f(i.elScript))}}function r(n){var i,t;return i=u(),i?(t=document.createElement("script"),t.type="text/javascript",t.language="javascript",t.src=n,i.appendChild(t),t):void 0}function a(n,t,i){var f,r;return f=u(),f?(r=document.createElement("link"),r.rel=t?"alternate stylesheet":"stylesheet",i&&(r.media=i),r.type="text/css",r.rev="stylesheet",r.href=n,f.appendChild(r),r):void 0}function u(){if(!i){var n=document.getElementsByTagName("head");n.length>0&&(i=n[0])}return i}function s(n,t,i){f(i),n&&n(t)}function f(n){n&&(n.src&&(n.src=""),n.parentNode&&n.parentNode.removeChild(n))}var v=this,e=5e3,i,c=1,t,n={};window.microsoftMapsNetworkCallback=l,this.downloadScript=function(n){return r(n)},this.downloadStyles=function(n,t,i){a(n,t,i)},this.getObjectAsync=function(t,i,u,f,s){var h=s;return h||(h="r"+ ++c,t=t.replace("{jsono}",h)),(typeof f!="number"||f<=0)&&(f=e),n[h]={callback:i,userData:u,elScript:r(t,h),timeoutId:window.setTimeout(function(){o(h)},f)},h},this.getObjectAsyncWithNoJsonso=function(i,u,f,s){if(t="_logCallbackRequest",(typeof s!="number"||s<=0)&&(s=e),n[t]){var h=n[t].callback;n[t].callback=function(){h(),fi.getObjectAsyncWithNoJsonso(i,u,f,s)}}else n[t]={callback:u,userData:f,elScript:r(i,t),timeoutId:window.setTimeout(function(){o(t)},s)}},this.isRequestCompleted=function(t){return n[t]?!1:!0},this.abortRequest=function(t){n[t]&&delete n[t]},this.getObjectAsyncCacheFriendly=function(n,t,i){var r=document.createElement("script");return r.type="text/javascript",r.language="javascript",r.src=n,navigator.userAgent.indexOf("IE")>=0?r.onreadystatechange=function(){r&&("loaded"==r.readyState||"complete"==r.readyState)&&(r.onreadystatechange=null,s(t,i,r))}:r.onload=function(){r.onload=null,s(t,i,r)},u().appendChild(r),r}},a.Network=fi,ni={map:"map",pushpin:"pushpin",polyline:"polyline",polygon:"polygon",infobox:"infobox"},vi.prototype={handled:!1,toString:function(){return"[MouseEventArgs]"}},a.MouseEventArgs=vi,a.EventTargetType=ni,yr.prototype={handled:!1,toString:function(){return"[KeyEventArgs]"}},a.KeyEventArgs=yr,yt.prototype={clone:function(){return new yt(this.a,this.r,this.g,this.b)},getOpacity:function(){return isFinite(this.a)?this.a/255:1},toHex:function(){var n=this.r,t=this.g,i=this.b;return"#"+(n<16?"0":"")+Number(n).toString(16)+(t<16?"0":"")+Number(t).toString(16)+(i<16?"0":"")+Number(i).toString(16)},toString:function(){return"[Color "+this.toHex()+"]"}},yt.clone=function(n){return new yt(n.a,n.r,n.g,n.b)},yt.fromHex=function(n){var i=null,t=/^#(\w{2})(\w{2})(\w{2})$/.exec(n);return t&&t.length==4&&(i=new yt(255,parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16))),i},o.Color=yt,gi.prototype={_visible:!0,_zIndex:null,setOptions:function(t,i){var r=!1;return t&&(typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.zIndex!="undefined"&&(this._zIndex=t.zIndex,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},toString:function(){return"[EntityCollection]"}},o.EntityCollection=gi,fr={standard:"Infobox",mini:"MiniInfobox2",expanded:"Infobox2"},o.InfoboxType=fr,fu.prototype={_width:256,_height:126,_showCloseButton:!0,_offset:new i(0,0),_htmlContent:null,_id:null,_typeName:fr.standard,_visible:!0,_zIndex:null,_options:null,_calculatedSize:null,_clip:!0,_shouldFireEvents:!0,setLocation:function(t){this._location=t,n.invoke(this,"entitychanged",{entity:this})},getLocation:function(){return this._location},setCalculatedSize:function(n){this._calculatedSize=n},measure:function(){return this._calculatedSize||{width:0,height:0}},setOptions:function(t,r){if(t){var u=!1;this._options=t,(t.width>0||t.width===null||t.width==="auto")&&(this._width=t.width===null?"auto":t.width,u=!0),(t.height>0||t.height===null)&&(this._height=t.height,u=!0),typeof t.showCloseButton=="boolean"&&(this._showCloseButton=t.showCloseButton,u=!0),t.offset&&(this._offset=i.clone(t.offset),u=!0),typeof t.htmlContent=="string"&&(this._htmlContent=t.htmlContent,u=!0),typeof t.id=="string"&&(this._id=t.id,u=!0),typeof t.typeName=="string"&&(this._typeName=t.typeName,u=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,u=!0),isFinite(t.zIndex)&&(this._zIndex=t.zIndex,u=!0),typeof t.clip=="boolean"&&(this._clip=t.clip,u=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,u=!0)}return u&&(r===null||!r)&&n.invoke(this,"entitychanged",{entity:this}),u},getWidth:function(){return this._width},getHeight:function(){return this._height},getShowCloseButton:function(){return this._showCloseButton},getOffset:function(){return this._offset},getOptions:function(){return this._options},getShouldFireEvents:function(){return this._shouldFireEvents},setHtmlContent:function(t){var i=this._htmlContent!=t;this._htmlContent=t,this._showPointer=!1,i&&n.invoke(this,"entitychanged",{entity:this})},getHtmlContent:function(){return this._htmlContent},getId:function(){return this._id},getTypeName:function(){return this._typeName},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},getClip:function(){return this._clip},receiveFocus:function(t){n.invoke(this,"focusreceived",{entity:this,nativeEvent:t.nativeEvent,forwardFocus:t.forwardFocus})},toString:function(){return"[InfoboxBase]"}},pu(d,fu),o.Infobox=d,d.prototype._title=null,d.prototype._titleAction=null,d.prototype._description=null,d.prototype._titleClickHandler=null,d.prototype._showPointer=!0,d.prototype._actions=[],d.prototype._pushpin=null,d.prototype._polygon=null,d.prototype.setOptions=function(t,i){if(t){var r=d.superClass.setOptions.call(this,t,!1);(typeof t.title=="string"||t.title===null)&&(this._title=t.title,r=!0),typeof t.titleIsPlaintext=="boolean"&&(this._titleIsPlaintext=t.titleIsPlaintext,r=!0),(typeof t.description=="string"||t.description&&t.description.innerHTML)&&(this._description=t.description,r=!0),typeof t.showPointer=="boolean"&&(this._showPointer=t.showPointer,r=!0),(typeof t.actions=="object"||t.actions===null)&&(this._actions=t.actions||[],r=!0),(typeof t.titleAction=="object"||t.titleAction===null)&&(this._titleAction=t.titleAction,r=!0),(typeof t.titleClickHandler=="function"||t.titleClickHandler===null)&&(this._titleClickHandler=t.titleClickHandler,r=!0),t.pushpin&&t.pushpin instanceof o.Pushpin&&(this._pushpin=t.pushpin,this._pushpin.getInfobox()!=this&&this._pushpin.setOptions({infobox:this}),r=!0),t.polygon&&t.polygon instanceof o.Polygon&&(this._polygon=t.polygon,this._polygon.getInfobox()!=this&&this._polygon.setOptions({infobox:this}),r=!0),(this._typeName===fr.mini||typeof this._htmlContent=="string")&&(this._showPointer=!1),r&&(i===null||!i)&&n.invoke(this,"entitychanged",{entity:this})}},d.prototype.getActions=function(){return this._actions},d.prototype.getTitle=function(){return this._title},d.prototype.getTitleIsPlaintext=function(){return this._titleIsPlaintext},d.prototype.getTitleAction=function(){return this._titleAction},d.prototype.getTitleClickHandler=function(){return this._titleClickHandler},d.prototype.getDescription=function(){return this._description},d.prototype.getShowPointer=function(){return this._showPointer},d.prototype.getPushpin=function(){return this._pushpin},d.prototype.getPolygon=function(){return this._polygon},d.prototype.getAnchor=function(){var n,t=this._calculatedSize&&this._calculatedSize.height||0,r;return this._showPointer?this._typeName!==fr.standard?(n=10,new i(20+n/2,t)):(n=28,r=38,new i(20+n/2,this.getHeight()+r)):t!==0?new i(0,t):new i(0,this.getHeight()||0)},d.prototype.getOptions=function(){return d.superClass.getOptions.call(this)},d.prototype.toString=function(){return"[Infobox]"},lr={highlighted:2,selected:1,none:0},pr={none:0,highlight:1,zoom:2},nr.getDefaultIcon=function(){return{width:25,height:39,anchor:new i(13,39),textOffset:new i(0,5),url:t.pushpinImageUrl}},nr.prototype={_width:25,_height:39,_draggable:!1,_anchor:null,_calculatedAnchor:new i(13,39),_htmlContent:null,_text:null,_textOffset:new i(0,5),_id:null,_typeName:null,_visible:!0,_zIndex:null,_useTransform3d:!0,_infobox:null,_state:lr.none,setLocation:function(t){this._location=t,n.invoke(this,"entitychanged",{entity:this})},getLocation:function(){return this._location},setOptions:function(t,r){var u=!1;return t&&(typeof t.icon=="string"&&(this._icon=t.icon,u=!0),t.width!==h&&(this._width=t.width>0?t.width:0,u=!0),t.height!==h&&(this._height=t.height>0?t.height:0,u=!0),typeof t.draggable=="boolean"&&(this._draggable=t.draggable,u=!0),t.anchor&&(this._anchor=i.clone(t.anchor),u=!0),typeof t.htmlContent=="string"&&(this._htmlContent=t.htmlContent,u=!0),typeof t.text=="string"&&(this._text=t.text,u=!0),t.textOffset&&(this._textOffset=i.clone(t.textOffset),u=!0),typeof t.id=="string"&&(this._id=t.id,u=!0),typeof t.typeName=="string"&&(this._typeName=t.typeName,u=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,u=!0),isFinite(t.zIndex)&&(this._zIndex=t.zIndex,u=!0),t.infobox&&t.infobox instanceof d&&(this._infobox=t.infobox,this._infobox.getPushpin()!=this&&this._infobox.setOptions({pushpin:this}),u=!0),typeof t.state=="number"&&(this._state=t.state,u=!0),u&&!r&&(this._calculatedAnchor=this._anchor?this._anchor:new i(Math.ceil(this._width/2),this._height),n.invoke(this,"entitychanged",{entity:this}))),u},getIcon:function(){return this._icon},getWidth:function(){return this._width},getHeight:function(){return this._height},getDraggable:function(){return this._draggable},getAnchor:function(){return this._calculatedAnchor},getHtmlContent:function(){return this._htmlContent},getText:function(){return this._text},getTextOffset:function(){return this._textOffset},getId:function(){return this._id},getTypeName:function(){return this._typeName},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},getUseTransform3d:function(){return this._useTransform3d},getInfobox:function(){return this._infobox},getState:function(){return this._state},receiveFocus:function(){n.invoke(this,"focusreceived",{entity:this})},toString:function(){return"[Pushpin]"}},o.EntityState=lr,o.PinFocusBehavior=pr,o.Pushpin=nr,tr.prototype={_strokeColor:new yt(255,255,0,0),_strokeThickness:3,_strokeDashArray:"none",_visible:!0,_id:null,_shouldFireEvents:!0,setLocations:function(t){this._locations=t,n.invoke(this,"entitychanged",{entity:this})},getLocations:function(){return this._locations},setOptions:function(t,i){var r=!1;return t&&(t.strokeColor&&(this._strokeColor=yt.clone(t.strokeColor),r=!0),isFinite(t.strokeThickness)&&(this._strokeThickness=t.strokeThickness,r=!0),typeof t.strokeDashArray=="string"&&(this._strokeDashArray=t.strokeDashArray,r=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.id=="string"&&(this._id=t.id,r=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getStrokeColor:function(){return this._strokeColor},getStrokeThickness:function(){return this._strokeThickness},getStrokeDashArray:function(){return this._strokeDashArray},getVisible:function(){return this._visible},getId:function(){return this._id},getShouldFireEvents:function(){return this._shouldFireEvents},toString:function(){return"[Polyline]"}},o.Polyline=tr,ir.prototype={_strokeColor:new yt(255,255,0,0),_strokeThickness:3,_strokeDashArray:"none",_fillColor:new yt(255,0,0,255),_visible:!0,_infobox:null,_shouldFireEvents:!0,_state:lr.none,_id:null,setLocations:function(t){this._locations=t,n.invoke(this,"entitychanged",{entity:this})},getLocations:function(){return this._locations},setOptions:function(t,i){var r=!1;return t&&(t.strokeColor&&(this._strokeColor=yt.clone(t.strokeColor),r=!0),isFinite(t.strokeThickness)&&(this._strokeThickness=t.strokeThickness,r=!0),typeof t.strokeDashArray=="string"&&(this._strokeDashArray=t.strokeDashArray,r=!0),t.fillColor&&(this._fillColor=yt.clone(t.fillColor),r=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.id=="string"&&(this._id=t.id,r=!0),t.infobox&&t.infobox instanceof o.Infobox&&(this._infobox=t.infobox,this._infobox.getPolygon()!=this&&this._infobox.setOptions({polygon:this}),r=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,r=!0),typeof t.state=="number"&&(this._state=t.state,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getStrokeColor:function(){return this._strokeColor},getStrokeThickness:function(){return this._strokeThickness},getStrokeDashArray:function(){return this._strokeDashArray},getFillColor:function(){return this._fillColor},getVisible:function(){return this._visible},getInfobox:function(){return this._infobox},getShouldFireEvents:function(){return this._shouldFireEvents},getState:function(){return this._state},toString:function(){return"[Polygon]"}},o.Polygon=ir,wr={show:"s",hide:"h",auto:"a"},er={low:0,high:1},ar.prototype={toString:function(){return"[TileLayer]"}},o.AnimationVisibility=wr,o.TileLayer=ar,o.TileDownloadPriority=er,br.prototype={toString:function(){return"[TileSource]"}},o.TileSource=br,o.Globals.disableGeoLocation||(eu=function(n){function y(n,i,r){if(t&&r===t&&n&&n.coords){var u=new v(n.coords.latitude,n.coords.longitude,n.coords.altitude);(!i||i&&i.showAccuracyCircle!=!1)&&f.addAccuracyCircle(u,n.coords.accuracy,h,{displayOnMap:!0}),(!i||i&&i.updateMapView!=!1)&&w(n),i&&i.successCallback&&i.successCallback({center:u,position:n})}t=0}function p(n,i,r){t&&r===t&&i.errorCallback&&i.errorCallback({internalError:n,errorCode:n.code}),t=0}function w(t){if(t)if(t.coords.accuracy<300)n.setView({center:new v(t.coords.latitude,t.coords.longitude,t.coords.altitude),zoom:16});else{var f=e(t.coords.latitude,t.coords.longitude,0,t.coords.accuracy),i=(f.latitude-t.coords.latitude)*2,r=n.getHeight(),u=n.getWidth(),o=r>u?r:u;n.setView({bounds:new ut(new v(t.coords.latitude,t.coords.longitude,t.coords.altitude),i,i),padding:o/3})}}function e(n,t,r,f){for(var a=l,b=a.degreesToRadians(r),p=(1-u)*Math.tan(a.degreesToRadians(n)),k=Math.cos(b),et=Math.sin(b),y=1/Math.sqrt(1+p*p),d=y*et,ot=d*d,g=1-ot,nt=Math.atan2(p,Math.cos(b)),c=g*((s*s-i*i)/(i*i)),st=1+c/16384*(4096+c*(-768+c*(320-175*c))),tt=c/1024*(256+c*(-128+c*(74-47*c))),e=f/(i*st),ht=2*Math.PI,o=Math.sin(e),it=2*nt+e,h=Math.cos(it),rt;Math.abs(e-ht)>1e-12;){it=2*nt+e,h=Math.cos(it),rt=h*h,o=Math.sin(e);var lt=Math.cos(e)*(-1+2*rt),at=tt/6*h*(-3+4*o*o)*(-3+4*rt),vt=tt*o*(h+tt/4*(lt-at));ht=e,e=f/(i*st)+vt}h=Math.cos(2*nt+e),o=Math.sin(e);var w=Math.cos(e),ut=p*y,ct=ut*o-y*w*k,yt=Math.atan2(ut*w+y*o*k,(1-u)*Math.sqrt(ot+ct*ct)),pt=Math.atan2(o*et,y*w-ut*o*k),ft=u/16*g*(4+u*(4-3*g)),wt=e+ft*o*(h+ft*w*(-1+2*h*h)),bt=pt-(1-ft)*u*d*wt,kt=(a.degreesToRadians(t)+bt+3*Math.PI)%(2*Math.PI)-Math.PI;return new v(a.radiansToDegrees(yt),a.radiansToDegrees(kt))}var r=null,h=128,c=new yt(150,0,163,239),a=new yt(25,0,163,239),t=0,o=navigator&&navigator.geolocation,f=this,s=tt.earthRadiusInMeters,i=tt.earthMinorAxisRadiusInMeters,u=tt.flatteningOfEllipsoidWGS84;this.getCurrentPosition=function(n){if(f.removeAccuracyCircle(),o&&t===0)t=Math.random(),navigator.geolocation.getCurrentPosition(function(i){y(i,n,t)},function(i){p(i,n,t)},n);else if(n&&n.errorCallback){var i=o?4:5;n.errorCallback({internalError:null,errorCode:i})}},this.cancelCurrentRequest=function(){t=0},this.addAccuracyCircle=function(t,i,u,o){var h=null,s,w,b,k,d;if(t&&u&&i&&t instanceof v&&si(u)&&si(i)){var l=[],y=t.latitude,p=t.longitude;for(s=0;s<u;s++)w=s/u*360,b=e(y,p,w,i),l.push(b);k=e(y,p,0,i),l.push(k),d=o.polygonOptions||{fillColor:a,strokeColor:c},h=new ir(l,d),o&&o.displayOnMap!=!1&&(f.removeAccuracyCircle(),r=h,n.entities.push(r))}return h},this.removeAccuracyCircle=function(){r&&(n.entities.remove(r),r=null)}},o.GeoLocationProvider=eu),a.DelayMap=kr,g=new function(){function i(t,r,u){var f,o,s,e;if(f=t[r],f)for(o=f.length;o--;)s=f[o],e=n[s],e&&(e[u]=[],i(e,r,u))}function r(t,r){var u=n[t],v,s,y,l,e,h,c;if(u)if(v=u.downloadScript,u.downloadScript=!1,i(u,"suppliesCssFor","styleUrls"),i(u,"suppliesJsFor","scriptUrls"),u.loaded)f(t,r);else{if(r)for(u.queue.push(r),e=0;e<u.scriptUrls.length;e++)for(s in r)typeof r[s]=="string"&&(y=new RegExp(s+"=[^&]+"),u.scriptUrls[e]=u.scriptUrls[e].replace(y,s+"="+r[s]));if(v&&u.loadOverrideCallback(t,r)!==!0){for(o.InternalNamespaceForDelay=a,l=u.scriptUrls,e=0;e<l.length;e++)h=l[e],h&&(u.jsonDownloadCallback?fi.getObjectAsync(h,u.jsonDownloadCallback):fi.downloadScript(h));for(c=u.styleUrls,e=0;e<c.length;e++)c[e]&&fi.downloadStyles(c[e])}}}function u(n,t){for(var i=n.length;i--;)n[i].indexOf("/")==-1&&(n[i]=t+n[i])}function f(n,t){typeof t.callback=="function"?t.callback(n):t.obj&&t.obj[t.name].apply(t.obj,t.args)}var n={};this.register=function(i,r,f,e){var o=f?f:{},s=n[i]={key:i,downloadScript:!0,loaded:!1,queue:[],scriptUrls:(o.extraScripts||[]).concat(r),styleUrls:o.styleUrls?o.styleUrls:[],jsonDownloadCallback:typeof o.jsonDownloadCallback=="function"?o.jsonDownloadCallback:null,loadOverrideCallback:typeof o.loadOverrideCallback=="function"?o.loadOverrideCallback:function(){return!1},suppliesCssFor:o.suppliesCssFor,suppliesJsFor:o.suppliesJsFor};e!==!1&&(u(s.scriptUrls,t.jsPath),u(s.styleUrls,t.cssPath))},this.add=function(n,t,i,u){r(n,t?{obj:t,name:i,args:u}:null)},this.load=function(n,t){PRF.start(n),r(n,t||{})},this.getRegistration=function(t){return n[t]},this.reset=function(t){var i=n[t];i.downloadScript=!0,i.queue=[],i.loaded=!1},this.done=function(t){var r=n[t],u,i,s,e,h;if(r){for(r.loaded=!0,u=r.queue,i=0;i<u.length;i++)s=u[i],f(t,s);e=0;for(h in n)n.hasOwnProperty(h)&&++e;e===0&&delete o.InternalNamespaceForDelay}}},o.loadModule=g.load,o.registerModule=function(n,t,i){g.register(n,t,i,!1)},o.moduleLoaded=g.done,a.Dynamic=g,o.Globals.disableDirections===!1&&g.register("Microsoft.Maps.Directions","veapiDirections.js",{styleUrls:["mapDirections.css"]}),o.Globals.disableStreetside===!1&&g.register("Microsoft.Maps.Streetside","veapistreetside.js",{styleUrls:["mapstreetside.css"]}),o.Globals.disableVenueMaps===!1&&g.register("Microsoft.Maps.VenueMaps","veapiVenueMaps.js",{styleUrls:["venuemaps.css"]}),o.Globals.disableMicroPOI===!1&&g.register("Microsoft.Maps.MicroPOI","veapiMicroPOI.js",{styleUrls:["veapiMicroPOI.css"]}),o.Globals.disableAnalytics===!1&&g.register("Microsoft.Maps.Analytics","veapiAnalytics.js"),o.Globals.disableSearch===!1&&g.register("Microsoft.Maps.Search","veapiSearch.js",{styleUrls:["search.css"]}),o.Globals.disableTasks===!1&&(g.register("Microsoft.Maps.Tasks","veapiTasks.js"),g.register("Microsoft.Maps.LocalScout","veapiLocalScout.js",{styleUrls:["search.css"]})),o.Globals.disableMyPlaces===!1&&g.register("Microsoft.Maps.MyPlaces","veapiMyPlaces.js"),o.Globals.jsonTimeStamp){var dr="en-us",gr="US",nu="__domainname__/mapconfiguration.ashx?name=wwa&v=7.0.2wwa&culture={culture}&homeRegion={homeRegion}";u.useXHR&&(dr=Windows.ApplicationModel.Resources.Core.ResourceManager.current.defaultContext.languages[0],gr=Windows.System.UserProfile.GlobalizationPreferences.homeGeographicRegion),ConfigCache.UpdateCulture(dr,gr),nu=nu.replace("{culture}",dr).replace("{homeRegion}",gr),g.register("Microsoft.Maps.Map",nu,{jsonDownloadCallback:JsonGlobalsWrapper.parse,loadOverrideCallback:JsonGlobalsWrapper.tryCachedGlobals})}wi="Microsoft.Maps.Overlays",tu=["mapdelay.css"],u.isIE6&&tu.push("iev6.css"),g.register(wi,"veapidelay.js",{styleUrls:tu}),kr.prototype={showOverlays:function(){g.add(wi,this,"showOverlays",arguments)},showHotRegions:function(){g.add(wi,this,"showHotRegions",arguments)},showVenueMapsExplorer:function(){g.add(wi,this,"showVenueMapsExplorer",arguments)},authenticate:function(){g.add(wi,this,"authenticate",arguments)},getCredentials:function(){g.add(wi,this,"getCredentials",arguments)}},g.register("Microsoft.Maps.Traffic","veapiTraffic.js",{styleUrls:["traffic.css"]}),g.register("Microsoft.Maps.Overlays.Style","veapiOverlayStyleV2.js",{styleUrls:["veapiOverlayStyleV2.css"],version:"v2"}),g.register("Microsoft.Maps.Themes.BingTheme","veapiBingTheme.js",{styleUrls:["veapiBingTheme.css"],suppliesCssFor:["Microsoft.Maps.Overlays"]}),g.register("Microsoft.Maps.AdvancedShapes","veapiAdvancedShapes.js"),l={LOGE2:Math.log(2),ILOGE2:1/Math.log(2),degreesPerRadian:180/Math.PI,radiansPerDegree:Math.PI/180,log2:function(n){return Math.log(n)/l.LOGE2},ceilLog2:function(n){return Math.ceil(Math.log(n)*l.ILOGE2)},lerpDouble:function(n,t,i){return n+i*(t-n)},normalizeDegrees:function(n){return(n%360+360)%360},distanceDegrees:function(n,t){var i=l.normalizeDegrees(n-t);return Math.min(i,360-i)},lerpAngle:function(n,t,i){var r=l.normalizeDegrees(n-t);return r>180&&(r=r-360),t+(1-i)*r},degreesToRadians:function(n){return n*l.radiansPerDegree},radiansToDegrees:function(n){return n*l.degreesPerRadian}},a.VectorMath=l,r.prototype={normalize:function(){var t=this.getLength(),n;return t===0?point:(n=1/t,new r(this.x*n,this.y*n,this.z*n))},isZero:function(){return this.x===0&&this.y===0&&this.z===0},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},toPoint:function(){return new i(this.x,this.y)},clone:function(){return new r(this.x,this.y,this.z)},toString:function(){return"[Point3D "+this.x+","+this.y+","+this.z+"]"}},r.add=function(n,t){return new r(n.x+t.x,n.y+t.y,n.z+t.z)},r.subtract=function(n,t){return new r(n.x-t.x,n.y-t.y,n.z-t.z)},r.multiply=function(n,t){return new r(t*n.x,t*n.y,t*n.z)},r.dot=function(n,t){return n.x*t.x+n.y*t.y+n.z*t.z},r.cross=function(n,t){return new r(n.y*t.z-n.z*t.y,n.z*t.x-n.x*t.z,n.x*t.y-n.y*t.x)},r.distanceSquared=function(n,t){var i=n.x-t.x,r=n.y-t.y,u=n.z-t.z;return i*i+r*r+u*u},r.lerp=function(n,t,i){return new r(n.x+(t.x-n.x)*i,n.y+(t.y-n.y)*i,n.z+(t.z-n.z)*i)},r.areEqual=function(n,t){return n&&t&&n.x===t.x&&n.y===t.y&&n.z===t.z},r.areAlmostEqual=function(n,t){return n&&t&&Math.abs(n.x-t.x)<ot&&Math.abs(n.y-t.y)<ot&&Math.abs(n.z-t.z)<ot},a.Point3D=r,pt.prototype={clone:function(){return new pt(this.width,this.height)},toString:function(){return"[Size "+this.width+","+this.height+"]"}},pt.clone=function(n){return new pt(n.width,n.height)},pt.areEqual=function(n,t){return n&&t&&n.width===t.width&&n.height===t.height},a.Size=pt,lt.prototype={getRight:function(){return this.x+this.width},getBottom:function(){return this.y+this.height},getCenter:function(){return new i(this.x+this.width/2,this.y+this.height/2)},contains:function(n){return n.x>=this.x&&n.y>=this.y&&n.x<=this.getRight()&&n.y<=this.getBottom()},clone:function(){return new lt(this.x,this.y,this.width,this.height)},toString:function(){return"[Rect "+this.x+","+this.y+" "+this.width+","+this.height+"]"}},lt.union=function(){for(var u=ki(arguments[0])?arguments[0]:arguments,t=u[0],i=t.x,r=t.y,f=t.x+(t.width?t.width:0),e=t.y+(t.height?t.height:0),o=u.length,n;o--;)n=u[o],i=Math.min(i,n.x),r=Math.min(r,n.y),f=Math.max(f,n.x+(n.width?n.width:0)),e=Math.max(e,n.y+(n.height?n.height:0));return new lt(i,r,f-i,e-r)},lt.intersect=function(n,t){return!(n.getRight()<t.x||t.getRight()<n.x||n.getBottom()<t.y||t.getBottom()<n.y)},lt.areEqual=function(){return},a.Rect=lt,wt.prototype={transform:function(n){return new i(n.x*this.m11+n.y*this.m21+this.offsetX,n.x*this.m12+n.y*this.m22+this.offsetY)},invert:function(){var n=this.m11*this.m22-this.m12*this.m21;if(n===0)throw"matrix cannot be inverted";return new wt(this.m22/n,-1*this.m12/n,-1*this.m21/n,this.m11/n,(this.offsetY*this.m21-this.offsetX*this.m22)/n,(this.offsetX*this.m12-this.offsetY*this.m11)/n)},clone:function(){return new wt(this.m11,this.m12,this.m21,this.m22,this.offsetX,this.offsetY)},toString:function(){return"[Matrix "+this.m11+", "+this.m12+", "+this.m21+", "+this.m22+", "+this.offsetX+", "+this.offsetY+"]"}},wt.multiply=function(n,t){return new wt(n.m11*t.m11+n.m12*t.m21,n.m11*t.m12+n.m12*t.m22,n.m21*t.m11+n.m22*t.m21,n.m21*t.m12+n.m22*t.m22,n.offsetX*t.m11+n.offsetY*t.m21+t.offsetX,n.offsetX*t.m12+n.offsetY*t.m22+t.offsetY)},wt.unitToPoints=function(n,t,i){return new wt(t.x-n.x,t.y-n.y,i.x-n.x,i.y-n.y,n.x,n.y)},wt.conversion=function(n,t,i,r,u,f){var e=wt.unitToPoints(n,t,i).invert(),o=wt.unitToPoints(r,u,f);return wt.multiply(e,o)},a.Matrix=wt,e.prototype={multiplyBy:function(n){var t=this.m11,i=this.m12,r=this.m13,u=this.m14,f=this.m21,e=this.m22,o=this.m23,s=this.m24,h=this.m31,c=this.m32,l=this.m33,a=this.m34,v=this.offsetX,y=this.offsetY,p=this.offsetZ,w=this.m44;this.m11=t*n.m11+i*n.m21+r*n.m31+u*n.offsetX,this.m12=t*n.m12+i*n.m22+r*n.m32+u*n.offsetY,this.m13=t*n.m13+i*n.m23+r*n.m33+u*n.offsetZ,this.m14=t*n.m14+i*n.m24+r*n.m34+u*n.m44,this.m21=f*n.m11+e*n.m21+o*n.m31+s*n.offsetX,this.m22=f*n.m12+e*n.m22+o*n.m32+s*n.offsetY,this.m23=f*n.m13+e*n.m23+o*n.m33+s*n.offsetZ,this.m24=f*n.m14+e*n.m24+o*n.m34+s*n.m44,this.m31=h*n.m11+c*n.m21+l*n.m31+a*n.offsetX,this.m32=h*n.m12+c*n.m22+l*n.m32+a*n.offsetY,this.m33=h*n.m13+c*n.m23+l*n.m33+a*n.offsetZ,this.m34=h*n.m14+c*n.m24+l*n.m34+a*n.m44,this.offsetX=v*n.m11+y*n.m21+p*n.m31+w*n.offsetX,this.offsetY=v*n.m12+y*n.m22+p*n.m32+w*n.offsetY,this.offsetZ=v*n.m13+y*n.m23+p*n.m33+w*n.offsetZ,this.m44=v*n.m14+y*n.m24+p*n.m34+w*n.m44},transform:function(n,t){var u=n.x*this.m11+n.y*this.m21+this.offsetX,f=n.x*this.m12+n.y*this.m22+this.offsetY,e=n.x*this.m13+n.y*this.m23+this.offsetZ,i;return n.z&&(u+=n.z*this.m31,f+=n.z*this.m32,e+=n.z*this.m33),(this.m14!==0||this.m24!==0||this.m34!==0||this.m44!==1)&&(i=n.x*this.m14+n.y*this.m24+(n.z?n.z:0)*this.m34+this.m44,t&&(i=Math.max(t,i)),u/=i,f/=i,e/=i),new r(u,f,e)},invert:function(){var s=this.m11,a=this.m12,v=this.m13,y=this.m14,h=this.m21,p=this.m22,w=this.m23,b=this.m24,c=this.m31,k=this.m32,d=this.m33,g=this.m34,l=this.offsetX,nt=this.offsetY,tt=this.offsetZ,it=this.m44,t=v*b-w*y,i=v*g-d*y,r=v*it-tt*y,u=w*g-d*b,f=w*it-tt*b,o=d*it-tt*g,ut=p*i-k*t-a*u,ft=a*f-p*r+nt*t,et=k*r-nt*i-a*o,ot=p*o-k*f+nt*u,rt=l*ut+c*ft+h*et+s*ot;if(rt===0||!isFinite(rt))throw"InvalidOperation: Matrix3D.invert";var st=s*u-h*i+c*t,ht=h*r-l*t-s*f,ct=s*o-c*r+l*i,lt=c*f-l*u-h*o;t=s*p-h*a,i=s*k-c*a,r=s*nt-l*a,u=h*k-c*p,f=h*nt-l*p,o=c*nt-l*k;var at=v*u-w*i+d*t,vt=w*r-tt*t-v*f,yt=v*o-d*r+tt*i,pt=d*f-tt*u-w*o,wt=b*i-g*t-y*u,bt=y*f-b*r+it*t,kt=g*r-it*i-y*o,dt=b*o-g*f+it*u,n=1/rt;return new e(ot*n,et*n,ft*n,ut*n,lt*n,ct*n,ht*n,st*n,dt*n,kt*n,bt*n,wt*n,pt*n,yt*n,vt*n,at*n)},projectOnPlane:function(n){var t=this,f=n.a*t.m11+n.b*t.m12+n.c*t.m13-n.d*t.m14,o=n.a*t.m21+n.b*t.m22+n.c*t.m23-n.d*t.m24,r=n.a*t.m31+n.b*t.m32+n.c*t.m33-n.d*t.m34,s=n.a*t.offsetX+n.b*t.offsetY+n.c*t.offsetZ-n.d*t.m44,i,u;if(r===0)throw"InvalidOperation: Matrix3D.projectOnPlane";return i=-1/r,u=new e(1,0,f*i,0,0,1,o*i,0,0,0,1,0,0,0,s*i,1),e.multiply(u,this)},clone:function(){return new e(this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.offsetX,this.offsetY,this.offsetZ,this.m44)},toString:function(){return"[Matrix3D "+this.m11+","+this.m12+","+this.m13+","+this.m14+", "+this.m21+","+this.m22+","+this.m23+","+this.m24+", "+this.m31+","+this.m32+","+this.m33+","+this.m34+", "+this.offsetX+","+this.offsetY+","+this.offsetZ+","+this.m44+"]"}},e.multiply=function(){for(var i=arguments.length,t=arguments[0].clone(),n=1;n<i;n++)t.multiplyBy(arguments[n]);return t},e.identity=function(){return new e(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},e.translation=function(n){var t=arguments.length==3;return new e(1,0,0,0,0,1,0,0,0,0,1,0,t?arguments[0]:n.x,t?arguments[1]:n.y,t?arguments[2]:n.z,1)},e.scaling=function(n,t,i){var r=new e(n,0,0,0,0,n,0,0,0,0,n,0,0,0,0,1);return arguments.length==3&&(r.m22=t,r.m33=i),r},e.rotationX=function(n){var t=n*l.radiansPerDegree,i=Math.sin(t),r=Math.cos(t);return new e(1,0,0,0,0,r,i,0,0,-i,r,0,0,0,0,1)},e.rotationY=function(n){var t=n*l.radiansPerDegree,i=Math.sin(t),r=Math.cos(t);return new e(r,0,-i,0,0,1,0,0,i,0,r,0,0,0,0,1)},e.rotationZ=function(n){var t=n*l.radiansPerDegree,i=Math.sin(t),r=Math.cos(t);return new e(r,i,0,0,-i,r,0,0,0,0,1,0,0,0,0,1)},a.Matrix3D=e,ei.prototype={intersectWithLine:function(n,t){var i=r.subtract(t,n),f=this.d-this.a*n.x-this.b*n.y-this.c*n.z,u=this.a*i.x+this.b*i.y+this.c*i.z;if(u===0)throw"InvalidOperation: Plane3D.intersectWithLine";return r.add(n,r.multiply(i,f/u))},clone:function(){return new ei(this.a,this.b,this.c,this.d)},toString:function(){return"[Plane3D]"}},ei.fromPoints=function(n,t,i){var f=r.subtract(i,t),e=r.subtract(t,n),u=r.cross(f,e);return u=u.normalize(),ei.fromNormal(n,u)},ei.fromNormal=function(n,t){return new ei(t.x,t.y,t.z,r.dot(t,n))},ei.areEqual=function(n,t){return n.a===t.a&&n.b===t.b&&n.c===t.c&&n.d===t.d},a.Plane3D=ei,ti.prototype={dot:function(n){return this.x*n.x+this.y*n.y},perp:function(){return new ti(this.y,-this.x)},normalize:function(){var n,t;return(n=this.length(),n<MathHelper.zeroTolerance)?new ti(0,0):(t=1/n,new ti(this.x*t,this.y*t))},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSquared:function(){return this.x*this.x+this.y*this.y},add:function(n){return new ti(this.x+n.x,this.y+n.y)},subtract:function(n){return new ti(this.x-n.x,this.y-n.y)},multiplyScalar:function(n){return new ti(this.x*n,this.y*n)},equals:function(n){return this.x===n.x&&this.y===n.y},toString:function(){return"["+this.x+", "+this.y+"]"}},a.Vector2=ti,tt={earthRadiusInMeters:6378137,earthCircumferenceInMeters:12756274*Math.PI,northUpHeading:0,eastUpHeading:90,southUpHeading:180,westUpHeading:270,enhancedBirdseyePitch:-l.degreesPerRadian*Math.asin(180/256),earthMinorAxisRadiusInMeters:6356752.3142,flatteningOfEllipsoidWGS84:1/298.2572235631,snapToCardinalHeading:function(n){var t=Math.round(n/90);return t=(t%4+4)%4,t*90},locationRectToMercatorZoom:function(n,i){var r=i.width/360,u=Math.abs(c.latitudeToY(i.getNorth())-c.latitudeToY(i.getSouth())),f=Math.min(n.width/(t.zoomOriginWidth*r),n.height/(t.zoomOriginWidth*u));return l.log2(f)},getMercatorCenter:function(n){var t=n.center;return new v(c.yToLatitude((c.latitudeToY(n.getNorth())+c.latitudeToY(n.getSouth()))/2),t.longitude,t.altitude,t.altitudeReference)},getMercatorFootprint:function(n,t){for(var r=t.width/2,u=t.height/2,f=[new i(-r,-u),new i(r,-u),new i(r,u),new i(-r,u)],h=n.getViewportToWorld(),s=n.getCrs(),e,o=f.length;o--;)e=h.transform(f[o]),f[o]=s===c?e:c.fromLocation(s.toLocation(e));return f}},a.MapMath=tt,c={latitudeLimit:85.051128,invFourPi:1/(4*Math.PI),unitsPerMeterAtEquator:1/tt.earthCircumferenceInMeters,toLocation:function(n){var t=c.yToLatitude(n.y);return new v(t,(n.x-.5)*360,n.z?c.unitsToMetersAtLatitude(t,n.z):0,ct.ellipsoid)},fromLocation:function(n){return new r(n.longitude/360+.5,c.latitudeToY(n.latitude),c.metersToUnitsAtLatitude(n.latitude,n.altitude))},wrap:function(n,t){var i=n.x,u=t?t.x:.5;return new r(i<u-.5||i>u+.5?i-Math.floor(i-u+.5):i,n.y,n.z)},getUpVector:function(){return new r(0,0,1)},getNadirMatrix:function(n){return new e(1,0,0,0,0,1,0,0,0,0,-1,0,-n.x,-n.y,n.z,1)},unitsToMeters:function(n,t){var i=c.yToLatitude(n.y);return c.unitsToMetersAtLatitude(i,t)},metersToUnits:function(n,t){var i=c.yToLatitude(n.y);return c.metersToUnitsAtLatitude(i,t)},changeAltitude:function(n,t){var i=c.yToLatitude(n.y),u=c.metersToUnitsAtLatitude(i,t);return new r(n.x,n.y,u)},unitsToMetersAtLatitude:function(n,t){return t===0?0:t*Math.cos(n*l.radiansPerDegree)/c.unitsPerMeterAtEquator},metersToUnitsAtLatitude:function(n,t){return t===0?0:t*c.unitsPerMeterAtEquator/Math.cos(n*l.radiansPerDegree)},yToLatitude:function(n){return 90-2*Math.atan(Math.exp((n*2-1)*Math.PI))*l.degreesPerRadian},latitudeToY:function(n){if(n>=c.latitudeLimit)return 0;if(n<=-c.latitudeLimit)return 1;var t=Math.sin(n*l.radiansPerDegree);return.5-Math.log((1+t)/(1-t))*this.invFourPi}},a.MercatorCube=c,or=new function(){var t=1/298.257222101,i=t*(2-t),u=1/(1-i),n=tt.earthRadiusInMeters,f=new r(0,0,-n);this.toLocation=function(r){var p=r.x,w=r.y,e=r.z,b,k,c,a,y,o,s=Math.sqrt(p*p+w*w),f=e,u,h,d;for(k=Math.atan2(w,p),u=s*(1-t),h=1/Math.sqrt(f*f+u*u),b=Math.atan2(f,u),a=f*h,y=u*h,o=n,c=s>1?s/y-o:e>0?e-n*(1-t):-e-n*(1-t),d=3;d--;)u=s*(1-i*o/(o+c)),h=1/Math.sqrt(f*f+u*u),b=Math.atan2(f,u),a=f*h,y=u*h,o=n/Math.sqrt(1-i*a*a),c=s>1?s/y-o:e>0?e-n*(1-t):-e-n*(1-t);return new v(b*l.degreesPerRadian,k*l.degreesPerRadian,c,ct.ellipsoid)},this.fromLocation=function(t){var o=t.latitude*l.radiansPerDegree,s=t.longitude*l.radiansPerDegree,u=t.altitude,f=Math.sin(o),h=Math.cos(o),c=Math.sin(s),a=Math.cos(s),e=n/Math.sqrt(1-i*f*f);return new r((e+u)*h*a,(e+u)*h*c,(e*(1-i)+u)*f)},this.wrap=function(){return wrap.clone()},this.getUpVector=function(n){return new r(n.x,n.y,n.z*u).normalize()},this.getNadirMatrix=function(n){var t,i=this.getUpVector(n),o=r.multiply(i,-1),s=r.cross(i,r.subtract(f,n)),u;return t=s.isZero()?new r(1,0,0):r.cross(s,i).normalize(),u=r.cross(i,t),e.multiply(e.translation(-n.x,-n.y,-n.z),new e(u.x,t.x,o.x,0,u.y,t.y,o.y,0,u.z,t.z,o.z,0,0,0,0,1))},this.unitsToMeters=function(n,t){return t},this.metersToUnits=function(n,t){return t},this.changeAltitude=function(n,t){var i=self.toLocation(n);return i.altitude=t,self.fromLocation(i)}},rt.prototype={getParent:function(){return new rt(this.levelOfDetail-1,Math.floor(this.x/2),Math.floor(this.y/2))},clone:function(){return new rt(this.levelOfDetail,this.x,this.y)},getSibling:function(n,t){var r=1<<this.levelOfDetail,u=this.x+n,i;return u<0?u+=r:u>=r&&(u-=r),i=this.y+t,i<0?i=0:i>=r&&(i=r-1),new rt(this.levelOfDetail,u,i)},toString:function(){return"[TileId "+this.levelOfDetail+" "+this.x+","+this.y+"]"}},rt.areEqual=function(n,t){return n&&t&&n.levelOfDetail===t.levelOfDetail&&n.x===t.x&&n.y===t.y},a.TileId=rt,f.prototype={convertCoordinateReferenceSystem:function(n){if(n!==this.getCrs()){var t=n.fromLocation(this.getCrs().toLocation(this.getLookAt()));return new f(n,t,n.metersToUnits(t,this.getCrs().unitsToMeters(this.getLookAt(),this.getWidth())),this.getHeading(),this.getPitch(),this.getRoll(),this.getDistanceInverse()<ot?0:1/n.metersToUnits(t,this.getCrs().unitsToMeters(this.getLookAt(),1/this.getDistanceInverse())),h,h,this.getZoomOriginWidth())}return this.clone()},clone:function(){return new f(this.getCrs(),this.getLookAt().clone(),this.getWidth(),this.getHeading(),this.getPitch(),this.getRoll(),this.getDistanceInverse(),this.getZoomDelta(),this.getPerspectiveOrigin().clone(),this.getZoomOriginWidth())},toString:function(){return"[MapCamera]"}},f.smallWidthRatioDiff=.1,f.smallAngle=1,f.smallPixelDistance=2,f.simpleGround=new ei(0,0,1,0),f.simpleWorldToFrustumNoZ=e.identity(),f.fromDirectionVector=function(n,t,i,u,o,s){var y,a;var p=n.getNadirMatrix(t),h=p.transform(r.add(t,u)).normalize(),c=0;(h.x!==0||h.y!==0)&&(directionXY=new r(h.x,h.y,0).normalize(),c=Math.acos(r.dot(directionXY,new r(0,-1,0)))*l.degreesPerRadian,directionXY.x<0&&(c=360-c));var w=(Math.PI/2-Math.acos(r.dot(h,new r(0,0,-1))))*l.degreesPerRadian,a=0,b=e.multiply(p,e.rotationZ(-c),e.rotationX(-(w+90))),v=b.transform(r.add(t,o));return(v.x!=0||v.y!=0)&&(y=new r(v.x,v.y,0).normalize(),a=Math.acos(r.dot(y,new r(0,-1,0)))*l.degreesPerRadian,y.x<0&&(a=360-a)),new f(n,t,i,c,w,a,s)},f.mercatorZoomToWidth=function(n,t,i){var r=1/Math.pow(2,n);return t===c?r:t.metersToUnits(i,c.unitsToMeters(c.fromLocation(t.toLocation(i)),r))},f.widthToMercatorZoom=function(n,t,i){var r=t===c?n:c.metersToUnits(c.fromLocation(t.ToLocation(i)),t.unitsToMeters(i,n));return l.log2(1/r)},f.snapSmallDifferences=function(n,i){n.getCrs()!==i.getCrs()&&(n=i.convertCoordinateReferenceSystem(i.getCrs()));var s=Math.max(n.getWidth(),i.getWidth())/t.zoomOriginWidth,u=s*f.smallPixelDistance,e=u*u,o=new f(n.getCrs(),r.distanceSquared(i.getLookAt(),n.getLookAt())>e?n.getLookAt():i.getLookAt(),Math.abs(i.getWidth()/n.getWidth()-1)>f.smallWidthRatioDiff?n.getWidth():i.getWidth(),Math.abs(n.getHeading()-i.getHeading())>f.smallAngle?n.getHeading():i.getHeading(),Math.abs(n.getPitch()-i.getPitch())>f.smallAngle?n.getPitch():i.getPitch(),Math.abs(n.getRoll()-i.getRoll())>f.smallAngle?n.getRoll():i.getRoll(),Math.abs(n.getDistanceInverse()-i.getDistanceInverse())>ot?n.getDistanceInverse():i.getDistanceInverse(),Math.abs(n.getZoomDelta()-i.getZoomDelta())>f.smallWidthRatioDiff?n.getZoomDelta():i.getZoomDelta(),r.distanceSquared(i.getPerspectiveOrigin(),n.getPerspectiveOrigin())>e?n.getPerspectiveOrigin():i.getPerspectiveOrigin(),n.getZoomOriginWidth());return f.areEqual(o,n)?n:o},f.lerp=function(n,t,i){var u=i,e=t.getWidth()/n.getWidth();return Math.abs(e-1)>f.smallWidthRatioDiff&&(u=(Math.pow(e,i)-1)/(e-1)),new f(t.getCrs(),r.lerp(n.getLookAt(),t.getLookAt(),u),l.lerpDouble(n.getWidth(),t.getWidth(),u),l.lerpAngle(n.getHeading(),t.getHeading(),i),l.lerpAngle(n.getPitch(),t.getPitch(),i),l.lerpAngle(n.getRoll(),t.getRoll(),i),l.lerpDouble(n.getDistanceInverse(),t.getDistanceInverse(),i),l.lerpDouble(n.getZoomDelta(),t.getZoomDelta(),i),r.lerp(n.getPerspectiveOrigin(),t.getPerspectiveOrigin(),u),n.getZoomOriginWidth())},f.areAligned=function(n,t){return n&&t&&n.getWidth()===t.getWidth()&&n.getHeading()===t.getHeading()&&n.getPitch()===t.getPitch()&&n.getRoll()===t.getRoll()&&n.getDistanceInverse()===t.getDistanceInverse()},f.areEqual=function(n,t){return n&&t&&(n===t||r.areAlmostEqual(n.getLookAt(),t.getLookAt())&&n.getWidth()===t.getWidth()&&n.getHeading()===t.getHeading()&&n.getPitch()===t.getPitch()&&n.getRoll()===t.getRoll()&&n.getDistanceInverse()===t.getDistanceInverse()&&n.getZoomDelta()===t.getZoomDelta()&&r.areEqual(n.getPerspectiveOrigin(),t.getPerspectiveOrigin()))},a.MapCamera=f,ft={mercator:new f(c,new r(.5,.5,0),1),enhancedBirdseyeNorthUp:new f(c,new r(.5,.5,0),1,tt.northUpHeading,tt.enhancedBirdseyePitch),enhancedBirdseyeEastUp:new f(c,new r(.5,.5,0),1,tt.eastUpHeading,tt.enhancedBirdseyePitch),enhancedBirdseyeSouthUp:new f(c,new r(.5,.5,0),1,tt.southUpHeading,tt.enhancedBirdseyePitch),enhancedBirdseyeWestUp:new f(c,new r(.5,.5,0),1,tt.westUpHeading,tt.enhancedBirdseyePitch)},a.StandardMapCameras=ft,a.MemoryCache=yi,nt={tileIdToCacheKey:function(n){return n.levelOfDetail+"~"+n.x+"~"+n.y},latLonToMercatorXY:function(n,t){var r=t/360+.5;return r-=Math.floor(r),new i(r,c.latitudeToY(n))},mercatorXYToTileId:function(n,t){var i=1<<t;return new rt(t,Math.floor(n.x*i),Math.floor(n.y*i))},mercatorXYToCacheKey:function(n,t){return nt.tileIdToCacheKey(nt.mercatorXYToTileId(n,t))},latLonToTileId:function(n,t,i){var r=nt.latLonToMercatorXY(n,t);return nt.mercatorXYToTileId(r,i)},latLonToCacheKey:function(n,t,i){return nt.tileIdToCacheKey(nt.latLonToTileId(n,t,i))},tileIdToMercatorXY:function(n){var t=1<<n.levelOfDetail;return new i((n.x+.5)/t,(n.y+.5)/t)},tileIdToLocation:function(n){var t=nt.tileIdToMercatorXY(n);return c.toLocation(t)},normalizeMercatorBounds:function(n){n.width<1?n.x-=Math.floor(n.x):(n.x=0,n.width=1);var t=Math.min(n.getBottom(),1);n.y=Math.max(n.y,0),n.height=t-n.y}},a.SpatialCache=nt,st=new function(){function s(){var s,c,v;if(f.length&&k<1&&a){var u=f.shift(),t=u.topLeft,i=u.bottomRight,l=!0,w=t.x,b=i.x,d=t.y,g=i.y,r=new rt(t.levelOfDetail,0,0);for(s=d;s<=g;s++){for(c=w;c<=b;c++)if(r.x=c,r.y=s,r=hi.wrapX(r),e.get(nt.tileIdToCacheKey(r))===h){l=!1;break}if(!l)break}if(l)n.invoke(u.requestHandle,"downloaded",{cacheHit:!0});else{v=1<<t.levelOfDetail,t.x-=o,t.y=Math.max(0,t.y-o),i.x+=o,i.y=Math.min(v-1,i.y+o);var y=nt.tileIdToLocation(t),p=nt.tileIdToLocation(i),tt=a.replace("{north}",y.latitude.toFixed(6)).replace("{west}",y.longitude.toFixed(6)).replace("{south}",p.latitude.toFixed(6)).replace("{east}",p.longitude.toFixed(6)).replace("{cols}",i.x-t.x+1).replace("{rows}",i.y-t.y+1);k++,fi.getObjectAsync(tt,at,{topLeft:t,bottomRight:i,requestHandle:u.requestHandle})}}}function at(t,i){var o,h;if(i.success){var f=i.userData.topLeft,l=i.userData.bottomRight,a=f.x,v=l.x,y=f.y,p=l.y,c=t.alt;if(c&&c.length===(p-y+1)*(v-a+1)){var r=new rt(f.levelOfDetail,0,0),u,b=0,w=0;for(o=y;o<=p;o++)for(h=a;h<=v;h++)for(w+=c[b++],r.x=h,r.y=o,r=hi.wrapX(r),u=r;u.levelOfDetail>=f.levelOfDetail-it;){if(e.insert(nt.tileIdToCacheKey(u),w))break;u=u.getParent()}d++,n.invoke(i.userData.requestHandle,"downloaded",{cacheHit:!1})}}k--,s()}function et(n){return Math.floor(Math.min(n+y,g))}var u=this,a,y=l.log2(t.zoomOriginWidth/64),w=10+y,g=20+y,it=6,e=new yi(5e3),f=[],k=0,d=0,o=4,st=3,ht=new r(0,0,1),ut=p+"ellipsoid",ft;this.authenticate=function(n){ft||(ft=!0,n(function(n){n&&(a=t.elevationServiceUrl.replace("{credentials}",n),s())}))},this.getAltitudeAtLatLon=function(n,t){return u.getAltitudeAtMercatorXY(nt.latLonToMercatorXY(n,t))},this.getAltitudeForTile=function(n){return e.get(nt.tileIdToCacheKey(n))},this.getApproximateAltitudeForTile=function(n){var t=e.get(nt.tileIdToCacheKey(n)),i,r;if(t!==h)return t;for(i=-1;i<2;i++)for(r=-1;r<2;r++)if(t=e.get(nt.tileIdToCacheKey(n.getSibling(i,r)),!1),t!==h)return t},this.getAltitudeAtMercatorXY=function(n){for(var r=nt.mercatorXYToTileId(n,g),f,i;r.levelOfDetail>=1;){if(f=u.getApproximateAltitudeForTile(r),f!==h){var e=r.levelOfDetail,k=1<<e,t=n.x*k-.5,s=n.y*k-.5,c=Math.floor(t),l=Math.ceil(t),y=Math.floor(s),p=Math.ceil(s),w=u.getAltitudeForTile(new rt(e,c,y)),a=u.getAltitudeForTile(new rt(e,l,y)),b=u.getAltitudeForTile(new rt(e,c,p)),v=u.getAltitudeForTile(new rt(e,l,p)),o;return w!==h?o=a!==h?w*(l-t)+a*(t-c):w:a!==h&&(o=a),b!==h?i=v!==h?b*(l-t)+v*(t-c):b:v!==h&&(i=v),o!==h?f=i!==h?o*(p-s)+i*(s-y):o:i!==h&&(f=i),f}r=r.getParent()}return 0},this.rayToGround=function(n,t,i){if(Math.abs(t.x-i.x)<=ot&&Math.abs(t.y-i.y)<=ot)return n.changeAltitude(t,u.getAltitudeAtMercatorXY(t));for(var e,r,o,f=t,s=st;s--;){if(r=u.getAltitudeAtMercatorXY(f),Math.abs(e-r)<1)break;e=r,o=ei.fromNormal(n.changeAltitude(f,r),ht),f=o.intersectWithLine(t,i)}return f},this.toEllipsoid=function(n,t){var i,r,f;return n.altitudeReference===ct.ellipsoid?n:t?new v(n.latitude,n.longitude,0,ct.ellipsoid):(i=n[ut],i&&i.latitude===n.latitude&&i.longitude===n.longitude&&i.forAltitude===n.altitude&&i.forAltitudeReference===n.altitudeReference&&i.forGeneration===d)?i:(r=u.getAltitudeAtLatLon(n.latitude,n.longitude),f=n.altitudeReference===ct.ground?n.altitude+r:r,i=new v(n.latitude,n.longitude,f,ct.ellipsoid),i.forAltitude=n.altitude,i.forAltitudeReference=n.altitudeReference,i.forGeneration=d,n[ut]=i,i)},this.isElevationAvailableAtLatLon=function(n,t,i){var f=et(i),r,e;if(f<w)return!0;for(r=nt.latLonToTileId(n,t,f),e=it;e--;){if(u.getApproximateAltitudeForTile(r)!==h)return!0;r=r.getParent()}return!1},this.adjustCameraElevation=function(n){var t=n.getLookAt(),i=u.rayToGround(n.getCrs(),t,n.getViewportToWorld().transform(new r(0,0,1)));return r.areAlmostEqual(t,i)?n:n.getAlignedCamera(0,i)},this.downloadElevationData=function(n,t){var u,r;if(u=et(n.getMercatorZoom()),u>=w){r=lt.union(tt.getMercatorFootprint(n,t)),nt.normalizeMercatorBounds(r);var o=nt.mercatorXYToTileId(r,u),h=nt.mercatorXYToTileId(new i(r.getRight(),r.getBottom()),u),e={};return f.push({topLeft:o,bottomRight:h,requestHandle:e}),b.dispatch(s),e}},this.downloadElevationDataForLocationRect=function(n,t){if(t=t||19,t>=w){var r=n.getNorth(),u=n.getWest(),e=n.getSouth(),o=n.getEast(),h=nt.latLonToTileId(r,u,t),c=nt.latLonToTileId(e,o,t),i={};return f.push({topLeft:h,bottomRight:c,requestHandle:i}),b.dispatch(s),i}},this.cancelDownload=function(n){if(n)for(var t=f.length;t--;)f[t].requestHandle===n&&f.splice(t,1)}},a.ElevationService=st,et.nativeMercatorCamera=ft.mercator.getAlignedCamera(t.minMercatorZoom),et.createMercatorScene=function(n,i,r,u){var f=null;return n&&(f=kt.createQuadKeyTilePyramid(t.defaultTileSize,t.defaultTileSize,n,ht.horizontal,u),f.projectingCamera=ft.mercator),new et(et.nativeMercatorCamera,f,t.maxMercatorZoom-t.minMercatorZoom,i,r)},a.CompositeModeScene=et,bt.entityRenderers=[],bt.registerEntityRenderer=function(t,i){var r={getRenderer:t,priority:i?i.priority:null};bt.entityRenderers.push(r),bt.entityRenderers._key="k"+ai.getNext(),i&&i.priority!==null&&bt.entityRenderers.sort(function(n,t){var u=0,i=n.priority,r=t.priority;return(i!==null||r!==null)&&(u=i!==null&&r!==null?i-r:i!==null?-1:1),u}),n.invoke(bt,"newEntityRenderer")},bt.getEntityRenderer=function(n,t){var f=bt.entityRenderers._key,i=t._cmRd,u,r;if(t._cmRdk!==f){for(i=null,u=bt.entityRenderers,r=0;r<u.length&&!i;r++)i=u[r].getRenderer(n,t);t._cmRd=i,t._cmRdk=f}return i},a.CompositeMode=bt,w=new function(){function r(){for(var u=k(),r=t.length,f,e,s;r--;){var o=t[r],c=y.Style.camelize(o),l=y.Style.get_camelized_style_name(o,u);u.style[l]!==h&&(n.Properties[c]=l,n.Attributes[c]=y.Style.get_css_style_name(o,u))}for(r=0;r<i.length;r++){f=i[r];for(e in f)if(e in u.style)for(s in f[e])n.Events[s]=f[e][s]}}var n=this,t,i;this.Properties={},this.Attributes={},this.Events={},t=["transform","transform-origin","transition","transition-delay","transition-property","transition-duration"],i=[{webkitTransition:{transitionEnd:"webkitTransitionEnd"}},{MozTransition:{transitionEnd:"MozTransitionEnd"}}],r()},s={none:0,allowed:1,readyForTarget:2,started:3,pendingCompletion:4},at.Default=new at(.25,.1,.25,1),at.Linear=new at(0,0,1,1),at.EaseIn=new at(.42,0,1,1),at.EaseOut=new at(0,0,.58,1),at.EaseInOut=new at(.42,0,.58,1),at.EaseOutIn=new at(0,.42,1,.58),at.Flick=new at(.2,.5,.35,1),ii=function(){function i(n){var i;if(!n[t]){for(newKey=(new Date).getTime();newKey in r;)newKey++;n[t]=newKey}return i=r[n[t]]||[],r[n[t]]=i,i}function u(n,t,r){for(var e=i(n),u=!1,o=e.length;o--&&!u;)u=e[o]===t,u&&r&&(e.splice(o,1),f(n));return u}function f(n){for(var f=i(n),e=f.length,h=new Date,r="",u="",o=!0,t,s;e--;)t=f[e],s=h-t.getStartTime(),o||(r+=", ",u+=" "),r+=t.getProperty()+" "+t.getDuration()+"s "+t.getTimingFunction().cssText,u+="-"+s+"ms",o=!1;n.style[w.Properties.transition]=r,n.style[w.Properties.transitionDelay]=u}function e(t,r,e){function p(){var n=t&&r&&e;!n}var o=this,c=t,v=e,l=r,a=new Date(0),s=0,h=null;this.getStartTime=function(){return a},this.getProperty=function(){return c},this.getTimingFunction=function(){return v},this.getDuration=function(){return l},this.setDuration=function(n){s==0&&(l=n)},this.applyAnimation=function(n){n&&!u(n,o)&&(i(n).push(o),s==0&&(a=new Date),s++,y(n).add_event(w.Events.transitionEnd,function(n){n.propertyName==c&&(y(this).remove_event(w.Events.transitionEnd,arguments.callee,!1),o.removeAnimation(this))},!1),f(n))},this.removeAnimation=function(t){t&&t!=h&&u(t,o,!0)&&(s--,h=t,n.invoke(t,"animationsequenceprogress",new ku(o,t,s>0,i(t).length>0)),h=null)},p()}var r={},t=p+"CssAnimationSequenceId";return e}(),ii.prototype={getElapsedTimeAsPercentage:function(){return(new Date-this.getStartTime())/(this.getDuration()*1e3)},getProgress:function(n){n==null&&(n=this.getElapsedTimeAsPercentage());var t=1/(400*this.getDuration());return this.getTimingFunction().getProgress(n,t)},duplicate:function(n,t,i){return new ii(n?n:this.getProperty(),t?t:this.getDuration(),i?i:this.getTimingFunction())}},ii.Transformer=u.allowCssAnimations&&new ii(w.Attributes.transform,.3,at.EaseInOut),ii.Flicker=u.allowCssAnimations&&ii.Transformer.duplicate(null,null,at.Flick),ii.TileFader=u.allowCssAnimations&&new ii("opacity",.3,at.Linear);var iu=function(){function i(){function f(n){if(r&&r.length)for(var t=r.length,i=!1;!i&&t--;)i=n(r[t])}function c(n){return n?n[u]:null}function l(n){n&&n.animationSequence&&!o&&f(function(t){if(t===n.animationSequence)return s(c(n.node),t),!0})}function s(t,r){t&&r&&i[t]&&i[t].remaining&&(o=!0,r.removeAnimation(i[t].node),o=!1,i[t].remaining--,i[t].remaining||(n.removeHandler(i[t].handler),i[t].node=null,i[t].handler=null,delete i[t],--e==0&&n.invoke(h,"animationscomplete",!1)))}var h=this,u=p+"CssAnimationGroupId"+ ++t,r=null,i={},e=0,o=!1;this.manageAnimations=function(n){var t,i;if(r&&h.removeAllAnimations(),r=n,t=r instanceof Array&&r.length>0,t)for(i=r.length;i--&&t;)t=r[i]instanceof ii;if(!t)throw"Must pass in a non-empty array of CssAnimationSequence objects";},this.addToGroup=function(t){var f,o;if(t){if(!t[u]){for(f=(new Date).getTime();f in i;)f++;t[u]=f}o=t[u],i[o]||(e++,i[o]={node:t,handler:n.addHandler(t,"animationsequenceprogress",l),remaining:r.length})}},this.applyAllAnimations=function(){f(function(n){for(var t in i)n.applyAnimation(i[t].node)})},this.removeAllAnimations=function(){f(function(n){for(var t in i)s(t,n)})},this.removeAnimations=function(n){f(function(t){s(c(n),t)})},this.hasPendingAnimations=function(){return e>0}}var t=0;return i}(),ri=new function(){function p(){var n=null,i=k(),t=w.Properties.transform,r;if(t&&t in a){r=a[t];try{i.style[t]="matrix(1,0,0,1,0,0)",l=r.p,n=r.f}catch(u){}}"opacity"in i.style&&(v=!0),n==null&&"filter"in i.style&&(n=b,c.requireFlowLayout=!0,y=!0,c.usingIEFilters=!0),n==null&&(n=g),c.setTransformAndOpacity=n}function h(n){if(n.offsetZ){for(var i=n.invert(),t=3;t--;)s[t]=i.transform(o[t]);return wt.conversion(s[0],s[1],s[2],o[0],o[1],o[2])}return n.m44==1?n:new wt(n.m11/n.m44,n.m12/n.m44,n.m21/n.m44,n.m22/n.m44,n.offsetX/n.m44,n.offsetY/n.m44)}function r(n){var t={};return t.position="absolute",t["white-space"]="nowrap",t["line-height"]="0",n&&(t.width=n.width.toFixed(0)+"px",t.height=n.height.toFixed(0)+"px"),t}function f(n){var t=[];for(styleKey in n)t.push(styleKey,":",n[styleKey],";");return t.join("")}function b(i,e,o,s){var k,d,a;s=s||{};var c=h(i),y=Math.round(c.m11*n)/n,g=Math.round(c.m22*n)/n,nt=Math.round(c.m12*n)/n,tt=Math.round(c.m21*n)/n,l=s.excludeCommonCss?{}:r(e),v=null,p,w;if(y==1&&nt==0&&tt==0&&g==1)p=c.offsetX.toFixed(0),w=c.offsetY.toFixed(0);else if(u.cssZoomAffectsTopLeft()||y!=g||nt!=0||tt!=0)k=Math.round(e.width/2),d=Math.round(e.height/2),p=-k,w=-d,a=wt.multiply(c,new wt(1,0,0,1,k,d)),v="progid:DXImageTransform.Microsoft.Matrix(FilterType=nearest,  M11="+a.m11.toFixed(t)+", M21="+a.m12.toFixed(t)+", M12="+a.m21.toFixed(t)+", M22="+a.m22.toFixed(t)+", dX="+a.offsetX.toFixed(0)+", dY="+a.offsetY.toFixed(0)+")";else{var b=Math.abs(y-1)>.02?Math.round(y*1e4)/1e4:1,it=c.invert(),rt=it.offsetX,ut=it.offsetY,p=-rt*b,w=-ut*b;b!=1&&(l.zoom=b)}return l.left=p+"px",l.top=w+"px",o<.01?l.display="none":(l.display="block",o<.99&&(v=(v==null?"":v+", ")+"alpha(opacity = "+(o*100).toFixed(0)+")")),v&&(l.filter=v),s.returnStyleObject?l:f(l)}function e(t,i,e,o){var s,y;o=o||{};var k=h(t),a=Math.round(k.m11*n)/n,v=Math.round(k.m22*n)/n,g=Math.round(k.m12*n)/n,d=Math.round(k.m21*n)/n,p=Math.round(k.offsetX*n)/n,b=Math.round(k.offsetY*n)/n,c=o.excludeCommonCss?{}:r(i);return a===1&&g===0&&d===0&&v===1?u.useTransform2d?(c[o.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",c[o.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate("+p+"px,"+b+"px)"):(c.left=p+"px",c.top=b+"px"):(i&&u.isIE9&&a&&v&&d===0&&Math.abs(a-v)<.01&&(s=a-1,y=v-1,s<=.0102&&s>=-.009998&&(s<=.0079&&s>=-.0075?(p+=i.width*s*.5,b+=i.height*y*.5,a+=s*.2,v+=y*.2):s<=.009175&&s>=-.009086?(a+=s*.17,v+=y*.17,s>0&&a<1.0100995||s<0&&a>.99?(p+=i.width*s*.5,b+=i.height*y*.5):(p+=i.width*s*-.09,b+=i.height*y*-.09)):(p+=i.width*s*-.05,b+=i.height*y*-.05,a+=s*.1,v+=y*.1))),c[o.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",c[o.returnStyleObject?w.Properties.transform:w.Attributes.transform]="matrix("+Math.min(a,100)+","+g+","+d+","+Math.min(v,100)+","+p+l+","+b+l+")"),e>=.01?(e<=.99&&(c.opacity=e.toFixed(2)),c.display="block"):c.display="none",o.returnStyleObject?c:f(c)}function d(t,i,u,e){e=e||{};var s=e.excludeCommonCss?{}:r(i),o=t.m44,h=Math.round(t.m11*n/o)/n,c=Math.round(t.m12*n/o)/n,l=Math.round(t.m14*n/o)/n,a=Math.round(t.m21*n/o)/n,v=Math.round(t.m22*n/o)/n,y=Math.round(t.m24*n/o)/n,p=Math.round(t.m31*n/o)/n,b=Math.round(t.m32*n/o)/n,k=Math.round(t.m34*n/o)/n,d=Math.round(t.offsetX/o),g=Math.round(t.offsetY/o);return h===1&&c===0&&l===0&&a===0&&v===1&&y===0&&p===0&&b===0&&k===0?(s[e.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",s[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate3d("+d+"px,"+g+"px,0px)"):(s[e.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",s[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="matrix3d("+h+","+c+",0,"+l+","+a+","+v+",0,"+y+","+p+","+b+",1,"+k+","+d+","+g+",0,1)"),u>=.01||e.explicitOpacity?((u<=.99||e.explicitOpacity)&&(s.opacity=u.toFixed(2)),s.display="block"):s.display="none",e.returnStyleObject?s:f(s)}function g(n,t,i,u){u=u||{};var o=h(n).invert(),e=u.excludeCommonCss?{}:r(t);return e.left=(-o.offsetX).toFixed(0)+"px",e.top=(-o.offsetY).toFixed(0)+"px",e.display=i>.1?"block":"none",u.returnStyleObject?e:f(e)}var c=this,a={transform:{p:"",f:e},msTransform:{p:"",f:e},webkitTransform:{p:"",f:u.useTransform3d?d:e},MozTransform:{p:"px",f:e},OTransform:{p:"",f:e}},l,t=6,n=Math.pow(10,t),o=[new i(0,0),new i(128,128),new i(-128,128)],s=[],v=!1,y=!1;this.setExactTransformOrHide=function(n,t,i,e){var o,s,c,l;return e=e||{},o=e.excludeCommonCss?{}:r(t),s=h(n).invert(),Math.abs(s.m11-1)<ot&&Math.abs(s.m12-0)<ot&&Math.abs(s.m21-0)<ot&&Math.abs(s.m22-1)<ot&&i>=.01?(c=-Math.round(s.offsetX)+"px",l=-Math.round(s.offsetY)+"px",o.display="block",u.useTransform3dForTranslate?o[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate3d("+c+","+l+",0px)":u.useTransform2d?o[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate("+c+","+l+")":(o.left=c,o.top=l),i<=.99&&(v?o.opacity=i.toFixed(2):y&&(o.filter="alpha(opacity = "+(i*100).toFixed(0)+")"))):o.display="none",e.returnStyleObject?o:f(o)},p()},bi=new function(){function w(){for(var e,h,u,s=0;s<i.length;s++){for(e=i[s],h=0;h<e.length;h++){var c=e[h],l=c.url,v=a.getState(l);switch(v){case vt.none:case vt.timedout:case vt.cacheExpired:o<t.maxConcurrentTileDownloads&&(c.basket=e,r[l]||(o++,u=k("img"),r[l]=u,u[f]=c,u.onload=g,u.onerror=d,u.onabort=d,u[y]=window.setTimeout(function(){var n=u;return function(){nt.call(n)}}(),c.timeout),u.src=l));break;case vt.downloading:break;default:e.hasNewTiles=!0}}e.hasNewTiles&&(n.invoke(e,"hasnewtiles"),e.hasNewTiles=!1)}}function g(){if(!this[e]){var n=this[f].url;l(this,n),v.insert(n,!0),s.insert(n,this)}}function d(){if(!this[e]){var n=this[f].url;l(this,n),u.useImageDisposer&&(this.src=t.spacerImageUrl),c.insert(n,vt.failed)}}function nt(){if(!this[e]){var n=this[f].url;l(this,n),u.useImageDisposer&&(this.src=t.spacerImageUrl),c.insert(n,vt.timedout)}}function l(n,t){var s,i,u;for(n[e]=!0,n.onload=null,n.onerror=null,n.onabort=null,window.clearTimeout(n[y]),s=n[f],i=s.basket,i.hasNewTiles=!0,u=i.length;u--;)i[u]===s&&i.splice(u,1);o--,delete r[t],b.dispatch(w,-10)}var a=this,i=[],o=0,r={},s=new yi(50),c=new yi(30),v=new yi(200);u.useImageDisposer&&s.useDisposer(function(n){n&&n.src&&(n.src=t.spacerImageUrl)});var f=p+"downloadRequest",y=p+"timeoutid",e=p+"processed";this.getState=function(n){if(s.get(n))return vt.ready;if(v.get(n))return vt.cacheExpired;var t=c.get(n);return t!==h?t:r[n]?vt.downloading:vt.none},this.setDownloadBasket=function(n,t){a.removeDownloadBasket(n.basketId),n.length>0&&(t?i.push(n):i.unshift(n),b.dispatch(w,-10))},this.removeDownloadBasket=function(n){for(var t=0;t<i.length;)i[t].basketId===n?i.splice(t,1):t++}},vt={none:0,downloading:1,ready:2,failed:3,timedout:4,cacheExpired:5};kt.createQuadKeyTilePyramid=function(n,i,r,u,f,e){var o=Math.pow(2,t.maxMercatorZoom);return new kt(n*o,i*o,n,i,0,0,0,0,kt.createMercatorQuadKeyUrlRetriever(r,n,u,f),kt.createQuadkeyTileReplacementHandler(),e)},kt.createMercatorQuadKeyUrlRetriever=function(n,i,r,u){return kt.createQuadKeyUrlRetriever(n,u,i,r,t.minMercatorZoom,t.maxMercatorZoom)},kt.createQuadKeyUrlRetriever=function(n,i,r,u,f,e,o){var a=l.ceilLog2(r),s,h,c;return typeof n=="string"?(s=n,h=i?i:s):c=n,function(n,i){function p(n){return(n.indexOf("key="+t.credentials)>-1||n.indexOf("key={key}")>-1)&&n.indexOf("stl=fb")===-1&&(n=n.replace(/(key=)[^\&]+/,"$1"+t.sessionId)),n}var y=n.levelOfDetail-a,r,l,v;if(y>=f&&y<=e&&(r=new rt(y,n.x,n.y),u&ht.horizontal&&(r=hi.wrapX(r)),u&ht.vertical&&(r=hi.wrapY(r)),hi.isInBounds(r))){if(c)return c(r);if(r.levelOfDetail===0)if(o)l=hi.fromTileId(r,!0),v=o;else return null;else l=hi.fromTileId(r,!1),v=l.charAt(l.length-1);return(t.sessionId&&t.credentials&&(s=p(s),h=p(h)),i)?h.replace("{quadkey}",l).replace("{subdomain}",v):s.replace("{quadkey}",l).replace("{subdomain}",v)}return null}},kt.createQuadkeyTileReplacementHandler=function(){var n=new yi(200);return function(t){var e=t.toString(),i=n[e],u,f,r;if(i){for(u=i.toString();n[u];)i=n[u],u=i.toString();for(f=n[e],r=f.toString();n[r];)f=n[r],n[r]=i,r=f.toString()}else i=t.getParent(),n[e]=i;return i}},ht={none:0,horizontal:1,vertical:2},a.TilePyramid=kt,a.TilePyramidWrapMethod=ht,sr.getBestLevelOfDetail=function(n,t,i){var r,u,f;return r=t.getMaxLevelOfDetail()-l.log2(t.getWidth()/t.projectingCamera.getWidth()/(n.getZoomOriginWidth()/n.getWidth())),u=Math.ceil(r),f=Math.floor(r),u!=f&&(i&&(r=r+i),r=Math.round(r),r=Math.min(u,Math.max(f,r))),Math.min(r,t.getMaxLevelOfDetail())},a.TileRenderer=su,li=new function(){function r(){o()?(i=1,n=!0,t=!0):s()?(i=2,n=!1,t=!0):h()&&(i=3,n=!0,t=!1),r=function(){}}function o(){var n=!1,t;return document.implementation&&document.implementation.hasFeature?n=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"):document.createElementNS&&(t=document.createElementNS(ns,"svg"),n=typeof t.createSVGRect!="undefined"),o=function(){return n},n}function s(){var t=document.createElement("v:shape"),n;return t.style.behavior="url(#default#VML)",n=typeof t.strokecolor!="undefined",s=function(){return n},n}function h(){var n=document.createElement("canvas"),t=n.getContext&&n.getContext("2d")!==null;return h=function(){return t},t}function e(n){function t(n){this._surface=n,this._paths=[]}return t.prototype={setSize:function(n,t){this._width=n,this._height=t},createPath:function(){},renderPath:function(){},removePath:function(n){for(var t=this._paths.length;t--;)if(this._paths[t]===n){this._surface.removeChild(n.nativeShape),this._paths.splice(t,1);break}},clear:function(){for(var n=this._paths.length;n--;)this._surface.removeChild(this._paths[n].nativeShape);this._paths=[]}},new t(n)}function c(n){function t(){}function i(){function n(){var r=this,n=document.createElement("v:shape"),t,i;n.style.position="absolute",t=document.createElement("v:stroke"),n.appendChild(t),i=document.createElement("v:fill"),n.appendChild(i),this._stroke=t,this._fill=i,this._initialize(n)}return n.prototype=f,n.prototype.stroke=function(){this.data==null||this.data.length&&this.data.charAt(this.data.length-1)==="E"||(this.data+="E");var n=this.nativeShape;n.strokecolor=this.strokeStyle,n.strokeweight=this.lineWidth+"pt",this.lineCap&&(this._stroke.endcap=this.lineCap.toLowerCase()==="butt"?"flat":path.lineCap,this._stroke.dashstyle=this.dashArray,this._stroke.opacity=this.strokeOpacity),this.fillStyle&&this.fillStyle!=="none"?(this._fill.color=this.fillStyle,this._fill.opacity=this.fillOpacity*100+"%"):n.filled=!1,n.path=this.data},new n}return t.prototype=new e(n),t.prototype.createPath=function(){return new i},t.prototype.renderPath=function(n){var i="url(#default#VML)",r=this._height!=null?this._height:this._surface.offsetHeight,u=this._width!=null?this._width:this._surface.offsetWidth,t=n.nativeShape;this._surface.appendChild(t),t.style.height=r+"px",t.style.width=u+"px",t.style.behavior=i,t.coordsize=u+","+r,n._stroke.style.behavior=i,n._fill.style.behavior=i,this._paths.push(n)},new t}function l(n){function i(){}function o(){function n(){var t=this,n=document.createElementNS(r,"path");n.style.pointerEvents="visiblePainted",this._initialize(n)}return n.prototype=f,n.prototype.stroke=function(){var n=this.nativeShape;n.setAttribute("stroke",this.strokeStyle),n.setAttribute("stroke-width",this.lineWidth),n.setAttribute("stroke-linecap",this.lineCap),n.setAttribute("stroke-dasharray",this.dashArray),n.setAttribute("fill",this.fillStyle),n.setAttribute("fill-opacity",this.fillOpacity),n.setAttribute("fill-rule","evenodd"),n.setAttribute("stroke-opacity",this.strokeOpacity),n.setAttribute("d",this.data)},new n}var r="http://www.w3.org/2000/svg",t=document.createElementNS(r,"svg");return u.safariRenderHack&&(t.style.cssText=u.safariRenderHack),t.setAttribute("width","100%"),t.setAttribute("height","100%"),n.appendChild(t),i.prototype=new e(t),i.prototype.createPath=function(){return new o},i.prototype.renderPath=function(n){var t=n.nativeShape;this._surface.appendChild(t),this._paths.push(n)},new i(n)}function a(n){function t(){}function i(t,i){function r(){var f=this,r=document.createElement("canvas"),u;r.style.cssText="position:absolute;",n.appendChild(r),u=r.getContext("2d"),u.beginPath(),this.context=u,this._initialize(r),this.setSize(t,i)}function o(n,t){if(n.length==7){var i=/^#(\w{2})(\w{2})(\w{2})$/.exec(n);return"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+","+t+")"}return""}var u,e;return r.prototype=f,r.prototype.setSize=function(n,t){u=n,e=t,this.nativeShape.setAttribute("width",u),this.nativeShape.setAttribute("height",e)},r.prototype.beginPath=function(){this.context.beginPath()},r.prototype.moveTo=function(n,t){this.context.moveTo(n,t)},r.prototype.lineTo=function(n,t){this.context.lineTo(n,t)},r.prototype.curveTo=function(n,t,i,r,u,f){this.context.bezierCurveTo(n,t,i,r,u,f)},r.prototype.stroke=function(){var n=this.context;n.clearRect(0,0,u,e),this.fillStyle&&this.fillStyle!=="none"&&(n.fillStyle=o(this.fillStyle,this.fillOpacity),n.fill()),n.strokeStyle=o(this.strokeStyle,this.strokeOpacity),n.lineWidth=this.lineWidth,n.stroke(),this.drawn=!0},new r}return t.prototype=new e(n),t.prototype.setSize=function(n,t){if(this._width!==n||this._height!==t){this._width=n,this._height=t;for(var i=this._paths.length;i--;)this._paths[i].setSize(n,t)}},t.prototype.createPath=function(){var n=this._height?this._height:this._surface.offsetHeight,t=this._width?this._width:this._surface.offsetWidth;return new i(t,n)},t.prototype.renderPath=function(n){var t=n.nativeShape;this._surface.appendChild(t),this._paths.push(n)},new t(n)}var n,t,i,f;this.isClipped=function(){return r(),n},this.isEventsSupported=function(){return r(),t},this.getContext=function(n){if(!n.harmonyContext){r();var t;switch(i){case 1:t=new l(n);break;case 2:t=new c(n);break;case 3:t=new a(n)}n.harmonyContext=t}return n.harmonyContext},this.destroyContext=function(n){n.harmonyContext&&(n.harmonyContext.clear(),n.harmonyContext=null)},f={nativeShape:null,_events:null,id:null,data:"",strokeStyle:"#000",strokeOpacity:"1",dashArray:"solid",fillStyle:"#000",fillOpacity:"1",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"#000000ff",beginPath:function(){this.data=""},moveTo:function(n,t){this.data+="M"+Math.round(n)+","+Math.round(t)+" "},lineTo:function(n,t){this.data+="L"+Math.round(n)+","+Math.round(t)+" "},curveTo:function(n,t,i,r,u,f){this.data+="C"+Math.round(n)+","+Math.round(t)+" "+Math.round(i)+","+Math.round(r)+" "+Math.round(u)+","+Math.round(f)+" "},stroke:function(){},onMouseDown:function(n){this._events.mousedown.push(n)},onMouseUp:function(n){this._events.mouseup.push(n)},onClick:function(n){this._events.click.push(n)},onMouseMove:function(n){this._events.mousemove.push(n)},onMouseOver:function(n){this._events.mouseover.push(n)},onMouseOut:function(n){this._events.mouseout.push(n)},_dispatchEvent:function(n,t){for(var i=this._events[n].length;i--;)this._events[n][i].call(this,t)},_initialize:function(n){function i(n){n=n||window.event,t._dispatchEvent(n.type,n)}var t=this;t._events={mousedown:[],mouseup:[],mousemove:[],mouseover:[],mouseout:[],click:[]},n.onmousedown=n.onmouseup=n.onclick=n.onmousemove=n.onmouseover=n.onmouseout=i,this.nativeShape=n}}},a.Harmony=li,hr.ensureVmlNamespace=function(){hr.ensureVmlNamespace=function(){};try{document.namespaces&&document.namespaces.add&&document.namespaces.add("v","urn:schemas-microsoft-com:vml")}catch(n){}},a.CompositeModeEntityRenderer=hr,new function(){var n=[],t=[],i=function(i,r){var u=null,f;if(r instanceof tr||r instanceof ir){for(f=n.length;f--;)n[f]===i&&(u=t[f]);u||(u=new du(i),n.push(i),t.push(u))}return u};bt.registerEntityRenderer(i)},gu=new function(){function r(t,r){var s=r.userData,e=null,h,o,f,l,u,a;if(r&&r.success&&t&&t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&t.resourceSets[0].resources[0].imageryProviders){for(e=[],h=t.resourceSets[0].resources[0].imageryProviders,u=h.length;u--;){for(var v=h[u],c=v.coverageAreas,y={attribution:v.attribution,coverageAreas:[]},p=c?c.length:0;p--;)o=c[p],f=o.bbox,y.coverageAreas.push({zoomMax:o.zoomMax,zoomMin:o.zoomMin,boundingBox:ut.fromEdges(f[2],f[1],f[0],f[3])});e.push(y)}i[s]=e}for(l=n[s],delete n[s],u=l.length;u--;)a=l[u],a.callback(e,a.userData)}var i={},n={};this.getCachedImageryProviders=function(n){return i[n]},this.getImageryProviders=function(u,f,e,o){if(i[u])e(i[u],o);else if(n[u])n[u].push({callback:e,userData:o});else if(t.imageryMetadataUrl){n[u]=[],n[u].push({callback:e,userData:o});var s=t.imageryMetadataUrl.replace(/{imagerySet}/,u).replace(/{credentials}/,f);fi.getObjectAsync(s,r,u)}else e(null,o)}},cu=new function(){function u(t,i){var u,f,o,e;i&&i.success&&t&&t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&t.resourceSets[0].resources[0].imageryProviders&&(u=i.userData,f=t.resourceSets[0].resources[0],r=f.displayCombinedLogo,o=[gt.defaultCopyright.text].concat(f.imageryProviders),n[u]&&(e=n[u].callback,delete n[u],n[u]=null,e&&e(o,r)))}var i=0,n=[],r=!1;this.getCopyrights=function(f,e,o,s,h,c){if(f&&e&&o&&h&&c){var l=t.imageryCopyrightUrl.replace(/{imagerySet}/,f).replace(/{zoom}/,parseInt(o)).replace(/{minLat}/,e.getSouth()).replace(/{minLon}/,e.getWest()).replace(/{maxLat}/,e.getNorth()).replace(/{maxLon}/,e.getEast()).replace(/{heading}/,parseInt(s)).replace(/{credentials}/,h);n[i]={callback:c},fi.getObjectAsync(l,u,i),i=++i%10}else c([gt.defaultCopyright.text],r)}},a.ModeEventHandler=lu,a.ModeEventHandlerComposite=au,vu=new function(){function n(n,u,f,e,o,s){var h=kt.createQuadKeyTilePyramid(i,r,u,f,s);return h.projectingCamera=n,new et(n.getAlignedCamera(t.minMercatorZoom),h,t.maxMercatorZoom-t.minMercatorZoom,"EnhancedBirdseye",e)}var u=this,i=256,r=180;this.createContributor=function(t){var s=t.credentialsProvider,r=t.urlFormat,f=t.urlWithLabelsFormat,e=new ui("Synth",s),o=new ui("SynthWithLabels",s),u={},i;return i={},u[tt.northUpHeading]=i,i[it.hidden]=n(ft.enhancedBirdseyeNorthUp,r.replace("{dir}","dir_n"),ht.horizontal,e),i[it.visible]=n(ft.enhancedBirdseyeNorthUp,f.replace("{dir}","dir_n"),ht.horizontal,o,r.replace("{dir}","dir_n")),i={},u[tt.westUpHeading]=i,i[it.hidden]=n(ft.enhancedBirdseyeWestUp,r.replace("{dir}","dir_w"),ht.vertical,e),i[it.visible]=n(ft.enhancedBirdseyeWestUp,f.replace("{dir}","dir_w"),ht.vertical,o,r.replace("{dir}","dir_w")),i={},u[tt.southUpHeading]=i,i[it.hidden]=n(ft.enhancedBirdseyeSouthUp,r.replace("{dir}","dir_s"),ht.horizontal,e),i[it.visible]=n(ft.enhancedBirdseyeSouthUp,f.replace("{dir}","dir_s"),ht.horizontal,o,r.replace("{dir}","dir_s")),i={},u[tt.eastUpHeading]=i,i[it.hidden]=n(ft.enhancedBirdseyeEastUp,r.replace("{dir}","dir_e"),ht.vertical,e),i[it.visible]=n(ft.enhancedBirdseyeEastUp,f.replace("{dir}","dir_e"),ht.vertical,o,r.replace("{dir}","dir_e")),{priority:30,minZoomLevel:0,getScene:function(n,t,i,r,f,e){return r>this.minZoomLevel?u[tt.snapToCardinalHeading(f)][e]:null}}}},dt.mercator="m",t.allowAerialMap&&(dt.auto="auto"),t.allowOrdnanceSurvey&&(dt.ordnanceSurvey="os"),t.allowCollinsBart&&(dt.collinsBart="cb"),n.addHandler(ur,"mapcreationstart",function(n){var u=n.map,o=n.options,r=o&&o.credentials?function(n){return n.replace(/{key}/,o.credentials)}:function(n){return n.replace(/&key={key}/,"")},f=u.getCredentials,i=new bt,lt=et.createMercatorScene(r(t.roadUriFormat),"Road",new ui("Road",f),r(t.roadUnlabeledUriFormat)),s={priority:10,getScene:function(){return lt}},g=new oi(dt.mercator,i),a,nt,v,tt,y,h,p,w,l,ft,b,ot,st,ht,k,ct,d;if(g.activated=function(){i.setSceneContributors([])},a=new oi(dt.road,i),a.activated=function(){i.setSceneContributors([s])},t.allowCollinsBart&&(nt=new hu(et.createMercatorScene(r(t.collinsBartUriFormat),"CollinsBart",new ui("CollinsBart",f)),t.collinsBartMinZoom-.5,t.collinsBartMaxZoom+.5,t.collinsBartBounds,15),v=new oi(dt.collinsBart,i),v.activated=function(){i.setSceneContributors([s,nt])},u.registerMapType(v)),t.allowOrdnanceSurvey&&(tt=new hu(et.createMercatorScene(r(t.ordnanceSurveyUriFormat),"OrdnanceSurvey",new ui("OrdnanceSurvey",f)),t.ordnanceSurveyMinZoom-.5,t.ordnanceSurveyMaxZoom+.5,t.ordnanceSurveyBounds,15),y=new oi(dt.ordnanceSurvey,i),y.activated=function(){i.setSceneContributors([s,tt])},u.registerMapType(y)),t.allowAerialMap){h={},h[it.hidden]=et.createMercatorScene(r(t.aerialUriFormat),"Aerial",new ui("Aerial",f)),h[it.visible]=et.createMercatorScene(r(t.aerialWithLabelsUriFormat),"Aerial",new ui("AerialWithLabels",f),r(t.aerialUriFormat));var e={priority:20,maxZoomLevel:4.5,getScene:function(n,t,i,r,u,f){return r<this.maxZoomLevel?h[f]:null}},c=vu.createContributor({credentialsProvider:f,urlFormat:r(t.enhancedBirdseyeUriFormat),urlWithLabelsFormat:r(t.enhancedBirdseyeWithLabelsUriFormat)}),rt=new nf({credentialsProvider:f,urlFormat:r(t.nativeBirdseyeUriFormat),urlWithLabelsFormat:r(t.nativeBirdseyeWithLabelsUriFormat)}),ut=new oi(dt.aerial,i);ut.activated=function(){e.maxZoomLevel=1e3,i.setSceneContributors([e])},p=new oi(dt.auto,i),p.activated=o.disableBirdseye!==!0&&t.defaultAerialTiltOn===!0?function(){e.maxZoomLevel=4.5,c.minZoomLevel=16.5,i.setSceneContributors([s,e,c,rt])}:function(){var n={priority:20,maxZoomLevelBand1:4.5,minZoomLevelBand2:16.5,getScene:function(n,t,i,r,u,f){return r<this.maxZoomLevelBand1||r>this.minZoomLevelBand2?h[f]:null}};i.setSceneContributors([n,s])},w=new oi(dt.birdseye,i),w.activated=function(){o.disableBirdseye!==!0?(e.maxZoomLevel=1e3,c.minZoomLevel=12.5,i.setSceneContributors([e,c,rt])):(e.maxZoomLevel=1e3,i.setSceneContributors([e]))},u.registerMapType(p),u.registerMapType(ut),u.registerMapType(w)}u.registerMapType(g),u.registerMapType(a),l={},l[it.hidden]=et.createMercatorScene(r(t.fbUnlabeledUriFormat),"Road",new ui("Road",f)),l[it.visible]=et.createMercatorScene(r(t.fbUriFormat),"Road",new ui("Road",f),r(t.fbUnlabeledUriFormat)),ft={priority:10,getScene:function(n,t,i,r,u,f){return l[f]}},b=new oi("fb",i),b.activated=function(){i.setSceneContributors([ft])},u.registerMapType(b),t.weatherLightUriFormat&&(ot=et.createMercatorScene(r(t.weatherLightUriFormat),"Road",new ui("Road",f)),ht={priority:10,getScene:function(){return ot}},k=new oi("wl",i),k.activated=function(){i.setSceneContributors([ht])},u.registerMapType(k)),t.weatherDarkUriFormat&&(st=et.createMercatorScene(r(t.weatherDarkUriFormat),"Aerial",new ui("Aerial",f)),ct={priority:10,getScene:function(){return st}},d=new oi("wd",i),d.activated=function(){i.setSceneContributors([ct])},u.registerMapType(d))}),delete window[$MapsNamespace].Maps.initMapCode,PRF.end("Map core initialized","mapcore"),vr=t.onloadcallback,vr&&typeof window[vr]=="function"&&window[vr].apply()},window[$MapsNamespace].Maps.Globals&&window[$MapsNamespace].Maps.initMapCode&&window[$MapsNamespace].Maps.initMapCode()
